/*! For license information please see vendors-7a8d64d6-c65a115db8f53912.bundle.js.LICENSE.txt */
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="68d3cd76-4f0c-480c-9f94-369090ac93b0",e._sentryDebugIdIdentifier="sentry-dbid-68d3cd76-4f0c-480c-9f94-369090ac93b0")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"03c050f83997f8f858284f712ef0b0ca3dc661b2"},(self.webpackChunkdisco=self.webpackChunkdisco||[]).push([[3063],{33079:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,s=void 0,s=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===n(s)?s:String(s)),i)}var o,s}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function c(e){var t=d();return function(){var r,i=f(e);if(t){var o=f(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,r)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){var t="function"==typeof Map?new Map:void 0;return l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return h(e,arguments,f(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),p(n,e)},l(e)}function h(e,t,r){return h=d()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&p(i,r.prototype),i},h.apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var v,m,_,y,b,g;!function(e){e.emailMagicLinks="emailMagicLinks",e.oauth="oauth",e.otp="otp",e.crypto="crypto",e.passwords="passwords"}(v||(v={})),function(e){e.Google="google",e.Microsoft="microsoft",e.Apple="apple",e.Github="github",e.GitLab="gitlab",e.Facebook="facebook",e.Discord="discord",e.Slack="slack",e.Amazon="amazon",e.Bitbucket="bitbucket",e.LinkedIn="linkedin",e.Coinbase="coinbase",e.Twitch="twitch"}(m||(m={})),function(e){e.Vessel="Vessel",e.Phantom="Phantom",e.Metamask="Metamask",e.Coinbase="Coinbase",e.Binance="Binance",e.GenericEthereumWallet="Other Ethereum Wallet",e.GenericSolanaWallet="Other Solana Wallet"}(_||(_={})),function(e){e.embedded="embedded",e.floating="floating"}(y||(y={})),function(e){e.SMS="sms",e.WhatsApp="whatsapp",e.Email="email"}(b||(b={})),function(e){e.MagicLinkLoginOrCreateEvent="MAGIC_LINK_LOGIN_OR_CREATE",e.OTPsLoginOrCreateEvent="OTP_LOGIN_OR_CREATE",e.OTPsAuthenticate="OTP_AUTHENTICATE",e.CryptoWalletAuthenticateStart="CRYPTO_WALLET_AUTHENTICATE_START",e.CryptoWalletAuthenticate="CRYPTO_WALLET_AUTHENTICATE",e.PasswordCreate="PASSWORD_CREATE",e.PasswordAuthenticate="PASSWORD_AUTHENTICATE",e.PasswordResetByEmailStart="PASSWORD_RESET_BY_EMAIL_START",e.PasswordResetByEmail="PASSWORD_RESET_BY_EMAIL"}(g||(g={}));var k;Error,Error,Error,Error,Error;!function(e){e.BiometricsSensorError="biometrics_sensor_error",e.DeviceCredentialsNotAllowed="device_credentials_not_allowed",e.DeviceHardwareError="device_hardware_error",e.InternalError="internal_error",e.KeyInvalidated="key_invalidated",e.KeystoreUnavailable="keystore_unavailable",e.NoBiometricsEnrolled="no_biometrics_enrolled",e.NoBiometricsRegistration="no_biometrics_registration",e.SessionExpired="session_expired",e.UserCancellation="user_cancellation",e.UserLockedOut="user_locked_out"}(k||(k={}))},757749:function(e,t,r){"use strict";r.d(t,{G6:function(){return p},di:function(){return f}});var n=r(667294);const i=e=>`${e} can only be used inside <StytchProvider>.`;function o(e,t){if(!e)throw new Error(t)}const s=e=>{const t=(0,n.useRef)(!0),[r,i]=(0,n.useState)(e);(0,n.useEffect)((()=>(t.current=!0,()=>{t.current=!1})),[]);return[r,(0,n.useCallback)((e=>{t.current&&i(e)}),[])]},a={user:null,fromCache:!1},c={session:null,fromCache:!1},u=(0,n.createContext)({isMounted:!1}),l=(0,n.createContext)(a),h=(0,n.createContext)(c),d=()=>(0,n.useContext)(u).isMounted,p=()=>{const e=(0,n.useContext)(u);return o(e.isMounted,i("useStytch")),e.client},f=({stytch:e,children:t})=>{o(!d(),"You cannot render a <StytchProvider> inside another <StytchProvider>."),o("undefined"!=typeof window,"The @stytch/react library is not meant for use with serverside environments like NextJS.\nUse the @stytch/nextjs library instead - \nnpm remove @stytch/react && npm install @stytch/nextjs\n");const r=(0,n.useMemo)((()=>({client:e,isMounted:!0})),[e]),[i,p]=s({user:e.user.getSync(),fromCache:!0}),[f,v]=s({session:e.session.getSync(),fromCache:!0});(0,n.useEffect)((()=>{const t=e.user.onChange((e=>p({user:e,fromCache:!1}))),r=e.session.onChange((e=>v({session:e,fromCache:!1})));return()=>{t(),r()}}),[e,p,v]);const m=!!f.session==!!i.user?f:c,_=!!f.session==!!i.user?i:a;return n.createElement(u.Provider,{value:r},n.createElement(l.Provider,{value:_},n.createElement(h.Provider,{value:m},t)))}},146711:function(e,t,r){"use strict";r.d(t,{ct:function(){return $}});var n=r(831987);function i(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:String(t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t,r){return t=h(t),function(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}(e,l()?Reflect.construct(t,r||[],h(e).constructor):t.apply(e,r))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function b(){b=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof _?t:_,s=Object.create(o.prototype),a=new L(n||[]);return i(s,"_invoke",{value:P(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d="suspendedStart",p="suspendedYield",f="executing",v="completed",m={};function _(){}function g(){}function k(){}var w={};u(w,s,(function(){return this}));var S=Object.getPrototypeOf,C=S&&S(S(I([])));C&&C!==r&&n.call(C,s)&&(w=C);var O=k.prototype=_.prototype=Object.create(w);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==y(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function P(t,r,n){var i=d;return function(o,s){if(i===f)throw new Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=E(a,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var u=h(t,r,n);if("normal"===u.type){if(i=n.done?v:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(y(t)+" is not iterable")}return g.prototype=k,i(O,"constructor",{value:k,configurable:!0}),i(k,"constructor",{value:g,configurable:!0}),g.displayName=u(k,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,u(e,c,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},T(x.prototype),u(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new x(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(O),u(O,c,"Generator"),u(O,s,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function g(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function k(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){g(o,n,i,s,a,"next",e)}function a(e){g(o,n,i,s,a,"throw",e)}s(void 0)}))}}Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),Promise.resolve({pkceRequiredForPasswordResets:!1}),Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),Promise.resolve({pkceRequiredForPasswordResets:!1});var w=function(e){function t(e,r,i,o,s){var a,l,h,p,f,v=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{isEnabled:(f=k(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)}))),function(){return f.apply(this,arguments)}),getTelemetryID:(p=k(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)}))),function(){return p.apply(this,arguments)}),getDFPTelemetryIDAndCaptcha:(h=k(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{dfp_telemetry_id:void 0,captcha_token:void 0});case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)}),retryWithCaptchaAndDFP:(l=k(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("DFP protected auth is disabled");case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},m=arguments.length>6?arguments[6]:void 0;return c(this,t),(a=u(this,t,[e,r,i,o,s,v]))._oneTap=m,a.startOneTapDiscovery=function(e){return(0,n._)(d(a),void 0,void 0,b().mark((function t(){var r,i,o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._oneTap.createOneTapClient();case 2:if((r=t.sent).success){t.next=5;break}throw new Error("One Tap could not load: ".concat(r.reason));case 5:return i=r.client,o=this._oneTap.createOnDiscoverySuccessHandler({discoveryRedirectUrl:e.discovery_redirect_url,onSuccess:this._oneTap.RedirectOnSuccess}),t.abrupt("return",i.render({style:{position:n.e.floating},callback:o}));case 8:case"end":return t.stop()}}),t,this)})))},a.startOneTap=function(e){return(0,n._)(d(a),void 0,void 0,b().mark((function t(){var r,i,o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.organization_id){t.next=2;break}throw new n.a2("stytch.oauth.googleOneTap.start","organization_id is a required argument");case 2:return t.next=4,this._oneTap.createOneTapClient();case 4:if((r=t.sent).success){t.next=7;break}throw new Error("One Tap could not load: ".concat(r.reason));case 7:return i=r.client,o=this._oneTap.createOnSuccessHandler({organizationId:e.organization_id,signupRedirectUrl:e.signup_redirect_url,loginRedirectUrl:e.login_redirect_url,onSuccess:this._oneTap.RedirectOnSuccess}),t.abrupt("return",i.render({style:{position:n.e.floating},callback:o}));case 10:case"end":return t.stop()}}),t,this)})))},a.googleOneTap={discovery:{start:a.startOneTapDiscovery},start:a.startOneTap},a}return p(t,e),s(t)}(n.aa),S="bootstrap",C=function(){function e(t,r,i){var o=this;c(this,e),this._publicToken=t,this._networkClient=r,this._dataLayer=i,this._bootstrapDataPromise=this._networkClient.fetchSDK({url:"/projects/bootstrap/".concat(this._publicToken),method:"GET",errorMessage:"Error fetching bootstrap data for SDK for ".concat(this._publicToken)}).then(e.mapBootstrapData).then((function(e){return o._dataLayer.setItem(S,JSON.stringify(e)),e})).catch((function(e){return n.l.error(e),{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1,rbacPolicy:null}}))}return s(e,[{key:"getSync",value:function(){var e=this._dataLayer.getItem(S);if(null===e)return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1,rbacPolicy:null};try{return JSON.parse(e)}catch(e){return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1,rbacPolicy:null}}}},{key:"getAsync",value:function(){return this._bootstrapDataPromise}}],[{key:"mapBootstrapData",value:function(e){var t,r,n=null!==e.password_config?{ludsComplexity:e.password_config.luds_complexity,ludsMinimumCount:e.password_config.luds_minimum_count}:null;return{displayWatermark:!e.disable_sdk_watermark,captchaSettings:e.captcha_settings,cnameDomain:e.cname_domain,emailDomains:e.email_domains,pkceRequiredForEmailMagicLinks:e.pkce_required_for_email_magic_links,pkceRequiredForPasswordResets:e.pkce_required_for_password_resets,pkceRequiredForOAuth:e.pkce_required_for_oauth,pkceRequiredForSso:e.pkce_required_for_sso,slugPattern:e.slug_pattern,createOrganizationEnabled:e.create_organization_enabled,passwordConfig:n,runDFPProtectedAuth:null!==(t=e.dfp_protected_auth_enabled)&&void 0!==t&&t,dfpProtectedAuthMode:e.dfp_protected_auth_mode,rbacPolicy:null!==(r=e.rbac_policy)&&void 0!==r?r:null}}}]),e}(),O=s((function e(t){var r=this;c(this,e),this.bootstrapPromise=t,this.executeRecaptcha=function(){return(0,n._)(r,void 0,void 0,b().mark((function e(){var t,r,n,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.captchaClient,n=t.configured,i=t.siteKey,n){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,new Promise((function(e){return r.ready(e)}));case 10:return e.abrupt("return",r.execute(i,{action:"LOGIN"}));case 11:case"end":return e.stop()}}),e,this)})))},this.state=t.then((function(e){return(0,n._)(r,void 0,void 0,b().mark((function t(){return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.captchaSettings.enabled){t.next=2;break}return t.abrupt("return",{configured:!1});case 2:return t.next=4,r=e.captchaSettings.siteKey,(0,n.ab)("https://www.google.com/recaptcha/enterprise.js?render=".concat(r),(function(){return window.grecaptcha.enterprise}));case 4:return t.t0=t.sent,t.t1=e.captchaSettings.siteKey,t.abrupt("return",{configured:!0,captchaClient:t.t0,siteKey:t.t1});case 7:case"end":return t.stop()}var r}),t)})))}))})),T=function(){function e(t){var r=this;c(this,e),this.iframeURL=t,this.oneTapStart=function(e){return r.call("oneTapStart",e)},this.oneTapSubmit=function(e){return r.call("oneTapSubmit",e)},this.parsedPhoneNumber=function(e){return r.call("parsedPhoneNumber",e)}}return s(e,[{key:"frameClient",get:function(){var e;return this._frameClient=null!==(e=this._frameClient)&&void 0!==e?e:new n.ac(this.iframeURL),this._frameClient}},{key:"call",value:function(e,t){return this.frameClient.call(e,[t])}}]),e}(),x=function(){function e(t,r,i,o){c(this,e),this._publicToken=t,this._subscriptionDataLayer=r,this.baseURL=i,this.additionalTelemetryDataFn=o,this.updateSessionToken=function(){return null},this.eventLogger=new n.ad({maxBatchSize:n.ae,intervalDurationMs:n.af,logEventURL:this.buildSDKUrl("/events")})}return s(e,[{key:"logEvent",value:function(e){var t=e.name,r=e.details,n=e.error,i=void 0===n?{}:n;this.eventLogger.logEvent(this.createTelemetryBlob(),{public_token:this._publicToken,event_name:t,details:r,error_code:i.error_code,error_description:i.error_description,http_status_code:i.http_status_code})}},{key:"createTelemetryBlob",value:function(){return Object.assign(Object.assign({event_id:(0,n.ag)(),app_session_id:(0,n.ah)(),persistent_id:(0,n.ai)(),client_sent_at:(new Date).toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},this.additionalTelemetryDataFn()),{app:{identifier:window.location.hostname},sdk:{identifier:"Stytch.js Javascript SDK",version:"4.15.0"}})}},{key:"fetchSDK",value:function(e){var t=e.url,r=e.body,i=e.errorMessage,o=e.method;return(0,n._)(this,void 0,void 0,b().mark((function e(){var s,a,c,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this._subscriptionDataLayer.readSessionCookie().session_token,a="Basic "+window.btoa(this._publicToken+":"+(s||this._publicToken)),c=window.btoa(JSON.stringify(this.createTelemetryBlob())),u=window.location.origin,e.abrupt("return",(0,n.aj)({basicAuthHeader:a,body:r,errorMessage:i,finalURL:this.buildSDKUrl(t),method:o,xSDKClientHeader:c,xSDKParentHostHeader:u}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"retriableFetchSDK",value:function(e){var t=e.url,r=e.body,i=e.errorMessage,o=e.method,s=e.retryCallback;return(0,n._)(this,void 0,void 0,b().mark((function e(){var a,c,u,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._subscriptionDataLayer.readSessionCookie().session_token,c="Basic "+window.btoa(this._publicToken+":"+(a||this._publicToken)),u=window.btoa(JSON.stringify(this.createTelemetryBlob())),l=window.location.origin,e.abrupt("return",(0,n.ak)({basicAuthHeader:c,body:r,errorMessage:i,finalURL:this.buildSDKUrl(t),method:o,xSDKClientHeader:u,xSDKParentHostHeader:l,retryCallback:s}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"buildSDKUrl",value:function(e){return"".concat(this.baseURL,"/sdk/v1").concat(e)}}]),e}();function P(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t}var E=function(){function e(t,r){c(this,e),this._dataLayer=t,this.namespace=r}return s(e,[{key:"key",value:function(){return"PKCE_VERIFIER:"+this.namespace}},{key:"startPKCETransaction",value:function(){return(0,n._)(this,void 0,void 0,b().mark((function t(){var r;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createProofkeyPair();case 2:return r=t.sent,this._dataLayer.setItem(this.key(),JSON.stringify(r)),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getPKPair",value:function(){var e=this._dataLayer.getItem(this.key());if(null!==e)try{return JSON.parse(e)}catch(e){return void n.l.warn("Found malformed Proof Key pair in localstorage.")}}},{key:"clearPKPair",value:function(){return this._dataLayer.removeItem(this.key())}}],[{key:"createProofkeyPair",value:function(){return(0,n._)(this,void 0,void 0,b().mark((function e(){var t,r,n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Uint32Array(16),window.crypto.getRandomValues(t),r=Array.from(t).map(P).join(""),e.next=5,window.crypto.subtle.digest("SHA-256",(new TextEncoder).encode(r));case 5:return n=e.sent,e.abrupt("return",{code_challenge:(o=n,s=void 0,btoa((s=String.fromCharCode).call.apply(s,[null].concat(i(new Uint8Array(o))))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),code_verifier:r});case 7:case"end":return e.stop()}var o,s}),e)})))}}]),e}(),A=function(e){return(document.cookie?document.cookie.split("; "):[]).filter((function(t){var r=v(t.split("="),1)[0];return e===r})).length>1};function R(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var L=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=R({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+o}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var o=r[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(n[a]=t.read(s,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",R({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,R({},this.attributes,t))},withConverter:function(t){return e(R({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),I=new Map,D=function(e){clearTimeout(I.get(e))},j=function(e,t,r){D(e);var n=setTimeout((function(){void 0===L.get(e)&&L.set(e,t,r)}),10);return I.set(e,n),L.set(e,t,r)},F=function(e){function t(){return c(this,t),u(this,t,arguments)}return p(t,e),s(t)}(function(){function e(t,r){var i=this;c(this,e),this.browserSessionStorage={getItem:function(e){return sessionStorage.getItem((0,n.a9)(i.publicToken,e))},setItem:function(e,t){return sessionStorage.setItem((0,n.a9)(i.publicToken,e),t)},removeItem:function(e){return sessionStorage.removeItem((0,n.a9)(i.publicToken,e))}},this.publicToken=t,this.state=null,this.stateKeysUpdated=new Set,this.subscriptions={},(null==r?void 0:r.cookieOptions)?((0,n.aq)("SubscriptionDataLayer").isOptionalString("cookieOptions.opaqueTokenCookieName",r.cookieOptions.opaqueTokenCookieName).isOptionalString("cookieOptions.jwtCookieName",r.cookieOptions.jwtCookieName).isOptionalString("cookieOptions.istCookieName",r.cookieOptions.istCookieName).isOptionalString("cookieOptions.path",r.cookieOptions.path).isOptionalString("cookieOptions.domain",r.cookieOptions.domain),this._jwtCookieName=r.cookieOptions.jwtCookieName||null,this._opaqueTokenCookieName=r.cookieOptions.opaqueTokenCookieName||null,this._cookiePath=r.cookieOptions.path||null,this._domain=r.cookieOptions.domain||null,this._cookieAvailableToSubdomains=r.cookieOptions.availableToSubdomains||!1,this._istCookieName=r.cookieOptions.istCookieName||null):(this._opaqueTokenCookieName=null,this._jwtCookieName=null,this._cookiePath=null,this._domain=null,this._cookieAvailableToSubdomains=!1,this._istCookieName=null);var o=localStorage.getItem((0,n.a9)(this.publicToken));if(o){var s;try{s=JSON.parse(o)}catch(e){return void this.syncToLocalStorage()}this.state=s}}return s(e,[{key:"opaqueTokenCookieName",get:function(){var e;return null!==(e=this._opaqueTokenCookieName)&&void 0!==e?e:"stytch_session"}},{key:"jwtCookieName",get:function(){var e;return null!==(e=this._jwtCookieName)&&void 0!==e?e:"stytch_session_jwt"}},{key:"istCookieName",get:function(){var e;return null!==(e=this._istCookieName)&&void 0!==e?e:"stytch_intermediate_session_token"}},{key:"readSessionCookie",value:function(){return{session_token:L.get(this.opaqueTokenCookieName),session_jwt:L.get(this.jwtCookieName)}}},{key:"readIntermediateSessionTokenCookie",value:function(){return L.get(this.istCookieName)}},{key:"writeSessionCookie",value:function(t){var r,i,o,s,a=t.state,c=t.session_token,u=t.session_jwt,l=e.generateCookieOpts({expiresAt:null!==(i=null===(r=null==a?void 0:a.session)||void 0===r?void 0:r.expires_at)&&void 0!==i?i:"",availableToSubdomains:this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});j(this.opaqueTokenCookieName,c,l),j(this.jwtCookieName,u,l);var h=e.generateCookieOpts({expiresAt:null!==(s=null===(o=null==a?void 0:a.session)||void 0===o?void 0:o.expires_at)&&void 0!==s?s:"",availableToSubdomains:!this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});A(this.jwtCookieName)&&L.remove(this.jwtCookieName,h),A(this.opaqueTokenCookieName)&&L.remove(this.opaqueTokenCookieName,h),A(this.jwtCookieName)&&n.l.warn("Could not remove extraneous JWT cookie. This might happen if the cookie has been set using multiple `path` settings, and may produce unwanted behavior."),A(this.opaqueTokenCookieName)&&n.l.warn("Could not remove extraneous opaque token cookie.")}},{key:"writeIntermediateSessionTokenCookie",value:function(t){var r=new Date(Date.now()+6e5),n=e.generateCookieOpts({expiresAt:r.toString(),availableToSubdomains:this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});j(this.istCookieName,t,n)}},{key:"removeSessionCookie",value:function(){this.removeCookies([this.opaqueTokenCookieName,this.jwtCookieName])}},{key:"removeISTCookie",value:function(){this.removeCookies([this.istCookieName])}},{key:"removeCookies",value:function(t){var r=this;[!0,!1].forEach((function(n){[r._cookiePath,null].forEach((function(i){[r._domain,null].forEach((function(r){var o=e.generateCookieOpts({expiresAt:new Date(0).toString(),availableToSubdomains:n,path:i,domain:r});t.forEach((function(e){L.remove(e,o)}))}))}))})),t.forEach(D)}},{key:"syncToLocalStorage",value:function(){localStorage.setItem((0,n.a9)(this.publicToken),JSON.stringify(this.state))}},{key:"getItem",value:function(e){return localStorage.getItem((0,n.a9)(this.publicToken,e))}},{key:"setItem",value:function(e,t){return localStorage.setItem((0,n.a9)(this.publicToken,e),t)}},{key:"removeItem",value:function(e){return localStorage.removeItem((0,n.a9)(this.publicToken,e))}}],[{key:"generateCookieOpts",value:function(e){var t=e.path,r=e.domain,n=e.availableToSubdomains,i=e.expiresAt,o={expires:new Date(i),sameSite:"lax"};return t&&(o.path=t),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))?o.secure=!1:(n&&(o.domain=r||window.location.host),o.secure=!0),o}}]),e}()),B=Symbol.for("__stytch_b2b_DataLayer"),N=function(e,t){var r,n=((r=window)[B]||(r[B]={}),r[B]);return n[e]||(n[e]=new F(e,t)),n[e]},M=function(e,t){Object.values(e).forEach((function(e){return e(t)}))},U=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).KEYS_TO_EXCLUDE,t=void 0===e?[]:e;return function e(r,n){return y(r)===y(n)&&(null===r||null===n?r===n:"object"===y(r)?Object.keys(r).length===Object.keys(n).length&&!Object.keys(r).some((function(e){return!(e in n)}))&&Object.entries(r).filter((function(e){var r=v(e,1)[0];return!t.includes(r)})).every((function(t){var r=v(t,2),i=r[0],o=r[1];return e(o,n[i])})):r===n)}}({KEYS_TO_EXCLUDE:["last_accessed_at"]}),K=function(){function e(t,r){var i=this;c(this,e),this._publicToken=t,this._datalayer=r,this.fromCache=!0,this._listen=function(e){if(e.key===(0,n.a9)(i._publicToken)){var t=null===e.newValue||"null"===e.newValue?null:JSON.parse(e.newValue);i.updateState(t,!0)}},window.addEventListener("storage",this._listen),this._datalayer.readSessionCookie().session_token||this.destroySession()}return s(e,[{key:"getTokens",value:function(){var e=this._datalayer.readSessionCookie(),t=e.session_token,r=e.session_jwt;return"string"!=typeof t||"string"!=typeof r?null:{session_token:t,session_jwt:r}}},{key:"getIntermediateSessionToken",value:function(){return this._datalayer.readIntermediateSessionTokenCookie()||null}},{key:"destroyState",value:function(){this.updateStateAndTokens({state:null,session_token:null,session_jwt:null,intermediate_session_token:null})}},{key:"destroySession",value:function(){this._datalayer.removeSessionCookie(),this.updateState(null)}},{key:"_updateStateAndTokensInternal",value:function(e){var t=this._datalayer.state,r=null===e.state?null:Object.assign(Object.assign({},this._datalayer.state),e.state);this._datalayer.state=r;var n=this.getFromCache();this.setCacheRefreshed(),!n&&U(t,r)||M(this._datalayer.subscriptions,r)}},{key:"updateStateAndTokens",value:function(e){e.state?(this._datalayer.writeSessionCookie(e),this._datalayer.removeISTCookie()):e.intermediate_session_token?(this._datalayer.writeIntermediateSessionTokenCookie(e.intermediate_session_token),this._datalayer.removeSessionCookie()):(this._datalayer.removeSessionCookie(),this._datalayer.removeISTCookie()),this._updateStateAndTokensInternal(e),this._datalayer.syncToLocalStorage()}},{key:"updateState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._datalayer.state,n=null===e?null:Object.assign(Object.assign({},this._datalayer.state),e);this._datalayer.state=n;var i=this.getFromCache();this.setCacheRefreshed();var o=!U(r,n);(i||o)&&(M(this._datalayer.subscriptions,n),o&&!t&&this._datalayer.syncToLocalStorage())}},{key:"updateTokens",value:function(e){var t=e.session_token,r=e.session_jwt,n=this._datalayer.readSessionCookie(),i=Object.assign(Object.assign({},n),{session_token:t,session_jwt:r});t||r?(this._datalayer.writeSessionCookie(i),this._datalayer.removeISTCookie()):this._datalayer.removeSessionCookie()}},{key:"subscribeToState",value:function(e){return t=this._datalayer.subscriptions,r=e,n=Math.random().toString(36).slice(-10),t[n]=r,function(){return delete t[n]};var t,r,n}},{key:"getState",value:function(){return this._datalayer.state}},{key:"destroy",value:function(){window.removeEventListener("storage",this._listen)}},{key:"syncFromDeviceStorage",value:function(){return null}},{key:"getFromCache",value:function(){return this.fromCache}},{key:"setCacheRefreshed",value:function(){this.fromCache=!1}}]),e}(),q=function(e){function t(){var e;return c(this,t),(e=u(this,t,arguments)).updateMember=function(t){return e.updateState({member:t})},e.getMember=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.member)&&void 0!==r?r:null},e.updateOrganization=function(t){return e.updateState({organization:t})},e.getOrganization=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.organization)&&void 0!==r?r:null},e.getSession=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.session)&&void 0!==r?r:null},e}return p(t,e),s(t)}(K),z="undefined"!=typeof window&&"IdentityCredential"in window,W=function(e){return e===n.e.forceLegacyEmbedded?"force":e===n.e.embeddedOnly||e===n.e.embedded||e===n.e.floatingOrEmbedded},G=function(e){var t=W(e);return"force"===t||t&&!z},H=function(){function e(t,r){c(this,e),this._googleClient=t,this._clientId=r}return s(e,[{key:"cancel",value:function(){this._googleClient.cancel()}},{key:"render",value:function(e){var t=e.callback,r=e.onOneTapCancelled,i=e.style;return(0,n._)(this,void 0,void 0,b().mark((function e(){var n,o,s,a=this;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=W(i.position),o=G(i.position),s={client_id:this._clientId,callback:t,auto_select:!1,context:"use",itp_support:!0,use_fedcm_for_prompt:"force"!==n},o&&(s.prompt_parent_id="google-parent-prompt",s.cancel_on_tap_outside=!1),this._googleClient.initialize(s),e.abrupt("return",new Promise((function(e){a._googleClient.prompt((function(t){var n,i,s,c,u;if(t.isSkippedMoment()){var l=null!==(i=null===(n=t.getSkippedReason)||void 0===n?void 0:n.call(t))&&void 0!==i?i:"unknown_reason";return"user_cancel"===l&&(null==r||r()),e({success:!1,reason:l})}return!t.isNotDisplayed&&o||(null===(s=t.isNotDisplayed)||void 0===s?void 0:s.call(t))?e({success:!1,reason:null!==(u=null===(c=t.getNotDisplayedReason)||void 0===c?void 0:c.call(t))&&void 0!==u?u:"unknown_reason"}):t.isDismissedMoment()?void 0:(a.styleFrame(o),e({success:!0}))}))})));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"styleFrame",value:function(e){e&&Array.from(document.getElementsByTagName("iframe")).forEach((function(e){e.src.includes(n.ar)&&(e.style.width="100%")}))}}]),e}(),V=Promise.resolve({pkceRequiredForOAuth:!1}),Y=function(){function e(t,r){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:V;c(this,e),this._networkClient=t,this._pkceManager=r,this._config=o,this.createOnDiscoverySuccessHandler=function(e){var t=e.discoveryRedirectUrl,r=e.onSuccess,o=e.onError;return function(e){return(0,n._)(i,void 0,void 0,b().mark((function n(){var i,s;return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.credential,s=this.submitGoogleOneTapTokenDiscovery({credential:i,discoveryRedirectUrl:t}).then((function(e){return r(e.redirect_url)})),o&&(s=s.catch((function(e){return o(e)}))),n.next=5,s;case 5:case"end":return n.stop()}}),n,this)})))}},this.createOnSuccessHandler=function(e){var t=e.organizationId,r=e.signupRedirectUrl,o=e.loginRedirectUrl,s=e.onSuccess,a=e.onError;return function(e){return(0,n._)(i,void 0,void 0,b().mark((function n(){var i,c;return b().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.credential,c=this.submitGoogleOneTapToken({credential:i,organizationId:t,signupRedirectUrl:r,loginRedirectUrl:o}).then((function(e){return s(e.redirect_url)})),a&&(c=c.catch((function(e){return a(e)}))),n.next=5,c;case 5:case"end":return n.stop()}}),n,this)})))}},this.RedirectOnSuccess=function(e){window.location.href=e}}return s(e,[{key:"fetchGoogleStart",value:function(){return(0,n._)(this,void 0,void 0,b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.googleClientID){e.next=2;break}return e.abrupt("return",this.googleClientID);case 2:return e.next=4,this._networkClient.fetchSDK({url:"/b2b/oauth/google/onetap/start",method:"GET",errorMessage:"Failed to fetch google client ID"});case 4:return t=e.sent,this.googleClientID=t.google_client_id,e.abrupt("return",this.googleClientID);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"submitGoogleOneTapTokenDiscovery",value:function(e){var t=e.credential,r=e.discoveryRedirectUrl;return(0,n._)(this,void 0,void 0,b().mark((function e(){var n,i,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,e.next=3,this._config;case 3:if(i=e.sent,!i.pkceRequiredForOAuth){e.next=12;break}return e.next=8,this._pkceManager.startPKCETransaction();case 8:o=e.sent,n=o.code_challenge,e.next=13;break;case 12:this._pkceManager.clearPKPair();case 13:return e.next=15,this._networkClient.fetchSDK({url:"/b2b/oauth/google/onetap/discovery/submit",method:"POST",body:{id_token:t,discovery_redirect_url:r,pkce_code_challenge:n},errorMessage:"Failed to submit One Tap ID token for discovery"});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})))}},{key:"submitGoogleOneTapToken",value:function(e){var t=e.credential,r=e.organizationId,i=e.signupRedirectUrl,o=e.loginRedirectUrl;return(0,n._)(this,void 0,void 0,b().mark((function e(){var n,s,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=void 0,e.next=3,this._config;case 3:if(s=e.sent,!s.pkceRequiredForOAuth){e.next=12;break}return e.next=8,this._pkceManager.startPKCETransaction();case 8:a=e.sent,n=a.code_challenge,e.next=13;break;case 12:this._pkceManager.clearPKPair();case 13:return e.next=15,this._networkClient.fetchSDK({url:"/b2b/oauth/google/onetap/submit",method:"POST",body:{id_token:t,organization_id:r,signup_redirect_url:i,login_redirect_url:o,pkce_code_challenge:n},errorMessage:"Failed to submit One Tap ID token"});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})))}},{key:"createOneTapClient",value:function(){return(0,n._)(this,void 0,void 0,b().mark((function e(){var t,r,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchGoogleStart();case 3:t=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),r=e.t0,e.abrupt("return",{success:!1,reason:r.error_type});case 10:if(""!==t){e.next=12;break}return e.abrupt("return",{success:!1,reason:"oauth_config_not_found"});case 12:return e.t1=H,e.next=15,(0,n.ab)(n.as,(function(){return window.google.accounts.id}));case 15:return e.t2=e.sent,e.t3=t,i=new e.t1(e.t2,e.t3),e.abrupt("return",{success:!0,client:i});case 19:case"end":return e.stop()}}),e,this,[[0,6]])})))}}]),e}(),J=function(e){function t(e,r,i,o,s){c(this,t);var a=i;return(0,n.i)(e)&&(a=o),u(this,t,[e,r,a,s])}return p(t,e),s(t)}(x),$=s((function e(t,r){var i=this;c(this,e),(0,n.at)("StytchB2BHeadlessClient"),(0,n.au)(t);var o,s,a,u,l,h,d,p,f,v,m,_=r,y={cookieOptions:null==(o=_)?void 0:o.cookieOptions,endpoints:{sdkBackendURL:null!==(a=null===(s=null==o?void 0:o.endpoints)||void 0===s?void 0:s.sdkBackendURL)&&void 0!==a?a:n.al,testAPIURL:null!==(l=null===(u=null==o?void 0:o.endpoints)||void 0===u?void 0:u.testAPIURL)&&void 0!==l?l:n.am,liveAPIURL:null!==(d=null===(h=null==o?void 0:o.endpoints)||void 0===h?void 0:h.liveAPIURL)&&void 0!==d?d:n.an,dfpBackendURL:null!==(f=null===(p=null==o?void 0:o.endpoints)||void 0===p?void 0:p.dfpBackendURL)&&void 0!==f?f:n.ao,clientsideServicesIframeURL:null!==(m=null===(v=null==o?void 0:o.endpoints)||void 0===v?void 0:v.clientsideServicesIframeURL)&&void 0!==m?m:n.ap}};this._dataLayer=N(t,_),this._subscriptionService=new q(t,this._dataLayer),this._stateChangeClient=new n.av(this._subscriptionService,{}),this.onStateChange=function(){var e;return(e=i._stateChangeClient).onStateChange.apply(e,arguments)};var b=function(){var e,t,r,n;return{stytch_member_id:null===(t=null===(e=i._dataLayer.state)||void 0===e?void 0:e.member)||void 0===t?void 0:t.member_id,stytch_member_session_id:null===(n=null===(r=i._dataLayer.state)||void 0===r?void 0:r.session)||void 0===n?void 0:n.member_session_id}},g=new E(this._dataLayer,"passwords");this._networkClient=new x(t,this._dataLayer,y.endpoints.sdkBackendURL,b),this._apiNetworkClient=new J(t,this._dataLayer,y.endpoints.liveAPIURL,y.endpoints.testAPIURL,b);var k=new C(t,this._networkClient,this._dataLayer),S=new O(k.getAsync()),P=new n.aw(t,y.endpoints.dfpBackendURL,k.getAsync(),S.executeRecaptcha),A=new T(y.endpoints.clientsideServicesIframeURL),R=new E(this._dataLayer,"oauth"),L=new Y(this._apiNetworkClient,R,k.getAsync());this.organization=new n.ax(this._networkClient,this._subscriptionService),this.member=new n.ay(this._networkClient,this._subscriptionService),this.self=new n.ay(this._networkClient,this._subscriptionService),this.session=new n.az(this._networkClient,this._subscriptionService),this.magicLinks=new n.aA(this._networkClient,this._subscriptionService,new E(this._dataLayer,"magic_links"),g,k.getAsync(),P),this.oauth=new w(this._networkClient,this._subscriptionService,R,k.getAsync(),{publicToken:t,testAPIURL:y.endpoints.testAPIURL,liveAPIURL:y.endpoints.liveAPIURL},P,L),this.sso=new n.aB(this._networkClient,this._subscriptionService,new E(this._dataLayer,"sso"),k.getAsync(),{publicToken:t,testAPIURL:y.endpoints.testAPIURL,liveAPIURL:y.endpoints.liveAPIURL},P),this.discovery=new n.aC(this._networkClient,this._subscriptionService),this.passwords=new n.aD(this._networkClient,this._subscriptionService,g,k.getAsync(),P),this.otps=new n.aE(this._networkClient,this._subscriptionService,P),this.totp=new n.aF(this._networkClient,this._subscriptionService,P),this.recoveryCodes=new n.aG(this._networkClient,this._subscriptionService,P),this.rbac=new n.aH(k.getSync(),k.getAsync(),this._subscriptionService),this.scim=new n.aI(this._apiNetworkClient,this._subscriptionService),this._sessionManager=new n.aJ(this._subscriptionService,this.session);var I=new n.aK(this._networkClient,P);this._dataLayer.readSessionCookie().session_token&&this._sessionManager.performBackgroundRefresh(),this._networkClient.logEvent({name:"b2b_sdk_instance_instantiated",details:{event_callback_registered:!1,error_callback_registered:!1,success_callback_registered:!1}});var D={bootstrap:k,clientsideServices:A,publicToken:t,searchManager:I,dataLayer:this._dataLayer,networkClient:this._networkClient,apiNetworkClient:this._apiNetworkClient,oneTap:L};(0,n.aL)(this,D)}))},290973:function(e,t,r){"use strict";r.d(t,{w0:function(){return tr}});var n,i,o,s,a,c,u,l=r(425108);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t,r){return t=_(t),function(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(e,m()?Reflect.construct(t,r||[],_(e).constructor):t.apply(e,r))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function k(){k=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof _?t:_,s=Object.create(o.prototype),a=new L(n||[]);return i(s,"_invoke",{value:P(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d="suspendedStart",p="suspendedYield",f="executing",v="completed",m={};function _(){}function y(){}function b(){}var g={};u(g,s,(function(){return this}));var S=Object.getPrototypeOf,C=S&&S(S(I([])));C&&C!==r&&n.call(C,s)&&(g=C);var O=b.prototype=_.prototype=Object.create(g);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==w(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function P(t,r,n){var i=d;return function(o,s){if(i===f)throw new Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=E(a,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var u=h(t,r,n);if("normal"===u.type){if(i=n.done?v:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(w(t)+" is not iterable")}return y.prototype=b,i(O,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},T(x.prototype),u(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new x(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(O),u(O,c,"Generator"),u(O,s,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function O(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==w(t)?t:String(t)}function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function P(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t,r){return t=F(t),function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}(e,D()?Reflect.construct(t,r||[],F(e).constructor):t.apply(e,r))}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}function I(e){var t="function"==typeof Map?new Map:void 0;return I=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(D())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&j(i,r.prototype),i}(e,arguments,F(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),j(r,e)},I(e)}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(D=function(){return!!e})()}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}!function(e){e.emailMagicLinks="emailMagicLinks",e.oauth="oauth",e.otp="otp",e.crypto="crypto",e.passwords="passwords",e.passkeys="passkeys"}(n||(n={})),function(e){e.Google="google",e.Microsoft="microsoft",e.Apple="apple",e.Github="github",e.GitLab="gitlab",e.Facebook="facebook",e.Discord="discord",e.Salesforce="salesforce",e.Slack="slack",e.Amazon="amazon",e.Bitbucket="bitbucket",e.LinkedIn="linkedin",e.Coinbase="coinbase",e.Twitch="twitch",e.Twitter="twitter",e.TikTok="tiktok",e.Snapchat="snapchat",e.Figma="figma",e.Yahoo="yahoo"}(i||(i={})),function(e){e.Vessel="Vessel",e.Phantom="Phantom",e.Metamask="Metamask",e.Coinbase="Coinbase",e.Binance="Binance",e.GenericEthereumWallet="Other Ethereum Wallet",e.GenericSolanaWallet="Other Solana Wallet"}(o||(o={})),function(e){e.embedded="embedded",e.floating="floating",e.embeddedOnly="embeddedOnly",e.floatingOrEmbedded="floatingOrEmbedded",e.forceLegacyEmbedded="forceLegacyEmbedded"}(s||(s={})),function(e){e.SMS="sms",e.WhatsApp="whatsapp",e.Email="email"}(a||(a={})),function(e){e.MagicLinkLoginOrCreateEvent="MAGIC_LINK_LOGIN_OR_CREATE",e.OTPsLoginOrCreateEvent="OTP_LOGIN_OR_CREATE",e.OTPsAuthenticate="OTP_AUTHENTICATE",e.CryptoWalletAuthenticateStart="CRYPTO_WALLET_AUTHENTICATE_START",e.CryptoWalletAuthenticate="CRYPTO_WALLET_AUTHENTICATE",e.PasswordCreate="PASSWORD_CREATE",e.PasswordAuthenticate="PASSWORD_AUTHENTICATE",e.PasswordResetByEmailStart="PASSWORD_RESET_BY_EMAIL_START",e.PasswordResetByEmail="PASSWORD_RESET_BY_EMAIL",e.PasskeyRegister="PASSKEY_REGISTER",e.PasskeyAuthenticate="PASSKEY_AUTHENTICATE",e.PasskeySkip="PASSKEY_SKIP",e.PasskeyDone="PASSKEY_DONE",e.B2BMagicLinkEmailLoginOrSignup="B2B_MAGIC_LINK_EMAIL_LOGIN_OR_SIGNUP",e.B2BMagicLinkAuthenticate="B2B_MAGIC_LINK_AUTHENTICATE",e.B2BMagicLinkEmailDiscoverySend="B2B_MAGIC_LINK_EMAIL_DISCOVERY_SEND",e.B2BMagicLinkDiscoveryAuthenticate="B2B_MAGIC_LINK_DISCOVERY_AUTHENTICATE",e.B2BSSOStart="B2B_SSO_START",e.B2BSSOAuthenticate="B2B_SSO_AUTHENTICATE",e.B2BOAuthAuthenticate="B2B_OAUTH_AUTHENTICATE",e.B2BOAuthDiscoveryAuthenticate="B2B_OAUTH_DISCOVERY_AUTHENTICATE",e.B2BDiscoveryOrganizationsCreate="B2B_DISCOVERY_ORGANIZATIONS_CREATE",e.B2BDiscoveryIntermediateSessionExchange="B2B_DISCOVERY_INTERMEDIATE_SESSION_EXCHANGE",e.B2BPasswordAuthenticate="B2B_PASSWORD_AUTHENTICATE",e.B2BPasswordResetByEmailStart="B2B_PASSWORD_RESET_BY_EMAIL_START",e.B2BPasswordResetByEmail="B2B_PASSWORD_RESET_BY_EMAIL",e.B2BPasswordResetBySession="B2B_PASSWORD_RESET_BY_SESSION",e.B2BSMSOTPSend="B2B_SMS_OTP_SEND",e.B2BSMSOTPAuthenticate="B2B_SMS_OTP_AUTHENTICATE",e.B2BTOTPCreate="B2B_TOTP_CREATE",e.B2BTOTPAuthenticate="B2B_TOTP_AUTHENTICATE",e.B2BRecoveryCodesRecover="B2B_RECOVERY_CODES_RECOVER"}(c||(c={})),function(e){e[e.emailMagicLinks=0]="emailMagicLinks",e[e.oauth=1]="oauth",e[e.otp=2]="otp",e[e.passwords=3]="passwords"}(u||(u={}));var B,N,M,U,K=function(e){function t(e,r){var n;return E(this,t),(n=A(this,t,[e+"\n"+r])).message=e+"\n"+r,n.name="SDKAPIUnreachableError",n.details=r,Object.setPrototypeOf(R(n),t.prototype),n}return L(t,e),P(t)}(I(Error)),q=function(e){function t(e,r){var n;return E(this,t),(n=A(this,t)).name="StytchSDKUsageError",n.message="Invalid call to ".concat(e,"\n")+r,n}return L(t,e),P(t)}(I(Error)),z=function(e){function t(e){var r,n;E(this,t),(r=A(this,t)).name="StytchSDKSchemaError";var i=null===(n=e.body)||void 0===n?void 0:n.map((function(e){return"".concat(e.dataPath,": ").concat(e.message)})).join("\n");return r.message="[400] Request does not match expected schema\n".concat(i),r}return L(t,e),P(t)}(I(Error)),W=function(e){function t(e){var r;E(this,t),(r=A(this,t)).name="StytchSDKAPIError";var n=e.status_code,i=e.error_type,o=e.error_message,s=e.error_url,a=e.request_id;return r.error_type=i,r.error_message=o,r.error_url=s,r.request_id=a,r.status_code=n,r.message="[".concat(n,"] ").concat(i,"\n")+"".concat(o,"\n")+"See ".concat(s," for more information.\n")+(a?"request_id: ".concat(a,"\n"):""),r}return L(t,e),P(t)}(I(Error)),G=["unauthorized_credentials","user_unauthenticated","invalid_secret_authentication","session_not_found"],H=function(e){function t(e,r){var n;return E(this,t),(n=A(this,t,[r])).name=e,n}return L(t,e),P(t)}(I(Error)),V=function(e){function t(e){var r;return E(this,t),r=A(this,t,["StytchAPIUnreachableError",e]),Object.setPrototypeOf(R(r),t.prototype),r}return L(t,e),P(t)}(H),Y=function(e){function t(e){var r;E(this,t);var n=null===(r=e.body)||void 0===r?void 0:r.map((function(e){return"".concat(e.dataPath,": ").concat(e.message)})).join("\n");return A(this,t,["StytchAPISchemaError","Request does not match expected schema\n".concat(n)])}return L(t,e),P(t)}(H),J=function(e){function t(e){var r;E(this,t);var n=e.status_code,i=e.error_type,o=e.error_message,s=e.error_url,a=e.request_id;return(r=A(this,t,["StytchAPIError","[".concat(n,"] ").concat(i,"\n")+"".concat(o,"\n")+"See ".concat(s," for more information.\n")+(a?"request_id: ".concat(a,"\n"):"")])).error_type=i,r.error_message=o,r.error_url=s,r.request_id=a,r.status_code=n,r}return L(t,e),P(t)}(H);function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t);else for(;!(c=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,t)||X(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=X(e))||t){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function X(e,t){if(e){if("string"==typeof e)return Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Q(e,t):void 0}}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(){te=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var o=t&&t.prototype instanceof _?t:_,s=Object.create(o.prototype),a=new A(n||[]);return i(s,"_invoke",{value:T(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d="suspendedStart",p="suspendedYield",f="executing",v="completed",m={};function _(){}function y(){}function b(){}var g={};u(g,s,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(R([])));w&&w!==r&&n.call(w,s)&&(g=w);var S=b.prototype=_.prototype=Object.create(g);function C(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==ee(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function T(t,r,n){var i=d;return function(o,s){if(i===f)throw new Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:e,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=x(a,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var u=h(t,r,n);if("normal"===u.type){if(i=n.done?v:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=h(i,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function R(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(ee(t)+" is not iterable")}return y.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},C(O.prototype),u(O.prototype,a,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var s=new O(l(e,r,n,i),o);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(S),u(S,c,"Generator"),u(S,s,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=R,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return a.type="throw",a.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}function re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ie(n.key),n)}}function ne(e,t,r){return t&&re(e.prototype,t),r&&re(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ie(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==ee(t)?t:String(t)}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function se(e,t,r){return t=le(t),function(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ce()?Reflect.construct(t,r||[],le(e).constructor):t.apply(e,r))}function ae(e){var t="function"==typeof Map?new Map:void 0;return ae=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(ce())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&ue(i,r.prototype),i}(e,arguments,le(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ue(r,e)},ae(e)}function ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ce=function(){return!!e})()}function ue(e,t){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ue(e,t)}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}!function(e){e.emailMagicLinks="emailMagicLinks",e.sso="sso",e.passwords="passwords",e.oauth="oauth"}(B||(B={})),function(e){e.Discovery="Discovery",e.Organization="Organization",e.PasswordReset="PasswordReset"}(N||(N={})),function(e){e.smsOtp="smsOtp",e.totp="totp"}(M||(M={})),function(e){e.Google="google",e.Microsoft="microsoft"}(U||(U={}));var he,de="https://accounts.google.com/gsi",pe="".concat(de,"/client");function fe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function ve(e,t,r,n){return new(r||(r=Promise))((function(t,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}a((n=n.apply(e,[])).next())}))}"function"==typeof SuppressedError&&SuppressedError,function(e){e.RequiredCatcha="Catcha Required"}(he||(he={}));var me,_e=function(e){function t(e){var r;return oe(this,t),(r=se(this,t,[e])).type=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}(t,e),ne(t)}(ae(Error));function ye(e){var t=e.method,r=e.errorMessage,n=e.finalURL,i=e.basicAuthHeader,o=e.xSDKClientHeader,s=e.xSDKParentHostHeader,a=e.body,c=e.retryCallback;return ve(this,0,void 0,te().mark((function e(){var u;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={method:t,errorMessage:r,finalURL:n,basicAuthHeader:i,xSDKClientHeader:o,xSDKParentHostHeader:s,body:a},e.prev=1,e.next=4,be(u);case 4:case 15:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof _e)){e.next=16;break}return e.next=12,c(e.t0,u);case 12:return u=e.sent,e.next=15,be(u);case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,7]])})))}function be(e){var t,r=e.method,n=e.finalURL,i=e.basicAuthHeader,o=e.xSDKClientHeader,s=e.xSDKParentHostHeader,a=e.body;return ve(this,0,void 0,te().mark((function e(){var c,u,l,h,d,p;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={Authorization:i,"Content-Type":"application/json","X-SDK-Client":o},s&&(c["X-SDK-Parent-Host"]=s),u={method:r,headers:c,body:a&&JSON.stringify(a)},e.prev=3,e.next=6,fetch(n,u);case 6:l=e.sent,e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(3),"Failed to fetch"!==e.t0.message){e.next=13;break}throw new V("Unable to contact the Stytch servers. Are you online?");case 13:throw e.t0;case 14:if(!(l.status<=299)){e.next=25;break}return e.prev=15,e.next=18,l.json();case 18:return h=e.sent,e.abrupt("return",h.data);case 22:throw e.prev=22,e.t1=e.catch(15),new V("Invalid JSON response from the Stytch servers.");case 25:if(200===l.status||!(null===(t=l.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))){e.next=38;break}return e.prev=26,e.next=29,l.json();case 29:d=e.sent,e.next=35;break;case 32:throw e.prev=32,e.t2=e.catch(26),new V("Invalid or no response from server");case 35:if(!("body"in d||"params"in d||"query"in d)){e.next=37;break}throw new Y(d);case 37:throw new J(d);case 38:return e.prev=38,e.next=41,l.text();case 41:p=e.sent,e.next=47;break;case 44:throw e.prev=44,e.t3=e.catch(38),new V("Invalid response from the Stytch servers.");case 47:if(!p.includes("Captcha required")){e.next=49;break}throw new _e(he.RequiredCatcha);case 49:throw new V("Invalid response from the Stytch servers.");case 50:case"end":return e.stop()}}),e,null,[[3,9],[15,22],[26,32],[38,44]])})))}var ge=new Uint8Array(16);function ke(){if(!me&&!(me="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return me(ge)}var we=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Se=[],Ce=0;Ce<256;++Ce)Se.push((Ce+256).toString(16).substr(1));function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(Se[e[t+0]]+Se[e[t+1]]+Se[e[t+2]]+Se[e[t+3]]+"-"+Se[e[t+4]]+Se[e[t+5]]+"-"+Se[e[t+6]]+Se[e[t+7]]+"-"+Se[e[t+8]]+Se[e[t+9]]+"-"+Se[e[t+10]]+Se[e[t+11]]+Se[e[t+12]]+Se[e[t+13]]+Se[e[t+14]]+Se[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&we.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r}function Te(e,t,r){var n=(e=e||{}).random||(e.rng||ke)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,Oe(n)}var xe={};function Pe(e,t){return ve(this,0,void 0,te().mark((function r(){return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===xe[e]){r.next=2;break}return r.abrupt("return",xe[e]);case 2:return xe[e]=Ee(e,t),r.abrupt("return",xe[e]);case 4:case"end":return r.stop()}}),r)})))}function Ee(e,t){return new Promise((function(r,n){var i=function(e){var t=Ae(e);if(t[0])return t[0]}(e);if(i&&"true"===i.dataset.loaded)try{r(t())}catch(t){return n(new Error("".concat(e," already loaded, but module was not found in global scope: ").concat(t)))}var o=function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("async","true"),t.setAttribute("defer","true"),document.head.appendChild(t),t}(e);o.addEventListener("load",(function(){o.dataset.loaded="true";try{r(t())}catch(t){n(new Error("".concat(e," was loaded, but module was not found in global scope: ").concat(t)))}})),o.addEventListener("error",(function(t){n(new Error("".concat(e," could not be loaded: ").concat(t)))}))}))}var Ae=function(e){return document.querySelectorAll('script[src="'.concat(e,'"]'))};var Re,Le=["[Stytch]"],Ie=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=l).warn.apply(e,Le.concat(r))},De=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=l).error.apply(e,Le.concat(r))},je="\nYou can find your public token at https://stytch.com/dashboard/api-keys.",Fe=function(e){var t={isObject:function(r,n){var i="object"===ee(n)&&!Array.isArray(n)&&null!==n;if(!i)throw new q(e,r+" must be an object.");return t},isOptionalObject:function(e,r){return void 0===r?t:t.isObject(e,r)},isString:function(r,n){if("string"!=typeof n)throw new q(e,r+" must be a string.");return t},isOptionalString:function(e,r){return void 0===r?t:t.isString(e,r)},isStringArray:function(r,n){if(!Array.isArray(n))throw new q(e,r+" must be an array of strings.");var i,o=Z(n);try{for(o.s();!(i=o.n()).done;){if("string"!=typeof i.value)throw new q(e,r+" must be an array of strings.")}}catch(e){o.e(e)}finally{o.f()}return t},isOptionalStringArray:function(e,r){return void 0===r?t:t.isStringArray(e,r)},isNumber:function(r,n){if("number"!=typeof n)throw new q(e,r+" must be a number.");return t},isOptionalNumber:function(e,r){return void 0===r?t:t.isNumber(e,r)},isBoolean:function(r,n){if("boolean"!=typeof n)throw new q(e,r+" must be a boolean.");return t},isOptionalBoolean:function(e,r){return void 0===r?t:t.isBoolean(e,r)}};return t},Be=function(e){return fe(e,["request_id","status_code"])},Ne=function(e){return fe(e,["__user"])},Me=ne((function e(t,r,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return Promise.resolve(void 0)};oe(this,e),this.bootstrapPromise=n,this.isEnabled=function(){return ve(i,0,void 0,te().mark((function e(){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.state.then((function(e){return e.enabled})));case 1:case"end":return e.stop()}}),e,this)})))},this.getTelemetryID=function(){return ve(i,0,void 0,te().mark((function e(){var t,r,n,i;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.publicToken,n=t.enabled,i=t.dfpBackendURL,n){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,window.GetTelemetryID(r,"".concat(i,"/submit"));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})))},this.getDFPTelemetryIDAndCaptcha=function(){return ve(i,0,void 0,te().mark((function e(){var t,r,n,i,o,s;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.enabled,n=t.executeRecaptcha,i=t.mode,o=void 0,s=void 0,r){e.next=12;break}return e.next=11,n();case 11:s=e.sent;case 12:if("DECISIONING"!==i){e.next=18;break}return e.next=15,this.getTelemetryID();case 15:o=e.sent,e.next=25;break;case 18:if("OBSERVATION"!==i){e.next=25;break}return e.next=21,this.getTelemetryID();case 21:return o=e.sent,e.next=24,n();case 24:s=e.sent;case 25:return e.abrupt("return",{dfp_telemetry_id:o,captcha_token:s});case 26:case"end":return e.stop()}}),e,this)})))},this.retryWithCaptchaAndDFP=function(e,t){return ve(i,0,void 0,te().mark((function r(){var n,i,o;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.state;case 2:if(n=r.sent,i=n.enabled,o=n.executeRecaptcha,e.type!==he.RequiredCatcha||!i){r.next=14;break}if(!t.body){r.next=13;break}return r.next=9,this.getTelemetryID();case 9:return t.body.dfp_telemetry_id=r.sent,r.next=12,o();case 12:t.body.captcha_token=r.sent;case 13:return r.abrupt("return",t);case 14:throw new Error("Unable to query captcha and/or dfp telemetry ID");case 15:case"end":return r.stop()}}),r,this)})))},this.state=n.then((function(e){return ve(i,0,void 0,te().mark((function n(){return te().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.runDFPProtectedAuth){n.next=2;break}return n.abrupt("return",{publicToken:t,dfpBackendURL:r,enabled:!1,loaded:!1,executeRecaptcha:o});case 2:return n.next=4,Pe("".concat("https://elements.stytch.com","/telemetry.js"),(function(){return window.GetTelemetryID}));case 4:return n.abrupt("return",{publicToken:t,dfpBackendURL:r,enabled:!0,mode:e.dfpProtectedAuthMode||"OBSERVATION",loaded:!0,executeRecaptcha:o});case 5:case"end":return n.stop()}}),n)})))}))})),Ue=function(){return{isEnabled:function(){return ve(void 0,0,void 0,te().mark((function e(){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})))},getTelemetryID:function(){return ve(void 0,0,void 0,te().mark((function e(){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})))},getDFPTelemetryIDAndCaptcha:function(){return ve(void 0,0,void 0,te().mark((function e(){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{dfp_telemetry_id:void 0,captcha_token:void 0});case 1:case"end":return e.stop()}}),e)})))},retryWithCaptchaAndDFP:function(){return ve(void 0,0,void 0,te().mark((function e(){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("DFP protected auth is disabled");case 1:case"end":return e.stop()}}),e)})))}}},Ke=function(){function e(){oe(this,e)}return ne(e,null,[{key:"marshall",value:function(e){return Object.assign(Object.assign({},e),{name:e.name,message:e.message,stack:e.stack})}},{key:"inflate",value:function(e,t){var r=new e(t);return Object.assign(r,t),Object.setPrototypeOf(r,e.prototype),r}},{key:"unmarshall",value:function(t){if("name"in t)switch(t.name){case"SDKAPIUnreachableError":return e.inflate(K,t);case"StytchSDKSchemaError":return e.inflate(z,t);case"StytchAPIUnreachableError":return e.inflate(V,t);case"StytchAPISchemaError":return e.inflate(Y,t);case"StytchSDKAPIError":return e.inflate(W,t);case"StytchAPIError":return e.inflate(J,t);case"TypeError":return e.inflate(TypeError,t);case"SyntaxError":return e.inflate(SyntaxError,t);case"ReferenceError":return e.inflate(ReferenceError,t);case"RangeError":return e.inflate(RangeError,t);case"EvalError":return e.inflate(EvalError,t);case"URIError":return e.inflate(URIError,t)}return e.inflate(Error,t)}}]),e}(),qe=function(){function e(t){oe(this,e),this.maxBatchSize=t.maxBatchSize,this.logEventURL=t.logEventURL,setInterval(this.flush.bind(this),t.intervalDurationMs),this.batch=[]}return ne(e,[{key:"logEvent",value:function(e,t){this.batch.push({telemetry:e,event:t}),this.batch.length>=this.maxBatchSize&&this.flush()}},{key:"flush",value:function(){return ve(this,0,void 0,te().mark((function e(){var t;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.batch.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.batch,this.batch=[],e.prev=4,e.next=7,fetch(this.logEventURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,this,[[4,9]])})))}}]),e}();!function(e){e.LoginOrCreateEML="login_or_create_eml",e.LoginOrCreateOTP="login_or_create_otp",e.ResetPassword="reset_password"}(Re||(Re={}));var ze=ne((function e(t,r){var n=this;oe(this,e),this._networkClient=t,this._subscriptionService=r,this.get=function(){return ve(n,0,void 0,te().mark((function e(){var t,r;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._networkClient.fetchSDK({url:"/users/me",errorMessage:"Failed to retrieve user info.",method:"GET"});case 2:return t=e.sent,r=Be(t),this._subscriptionService.updateUser(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})))},this.getSync=function(){return n._subscriptionService.getUser()},this.getInfo=function(){return{user:n.getSync(),fromCache:n._subscriptionService.getFromCache()}},this.update=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.user.update").isOptionalObject("untrusted_metadata",e.untrusted_metadata),t.next=3,this._networkClient.fetchSDK({url:"/users/me",body:e,errorMessage:"Failed to update user.",method:"PUT"});case 3:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 7:case"end":return t.stop()}}),t,this)})))},this.deleteEmail=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/emails/".concat(e),errorMessage:"Failed to delete email.",method:"DELETE"});case 2:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deletePhoneNumber=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/phone_numbers/".concat(e),errorMessage:"Failed to delete phone number.",method:"DELETE"});case 2:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteTOTP=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/totps/".concat(e),errorMessage:"Failed to delete TOTP.",method:"DELETE"});case 2:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteOAuthRegistration=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/oauth/".concat(e),errorMessage:"Failed to delete OAuth registration.",method:"DELETE"});case 2:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteWebauthnRegistration=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/webauthn_registrations/".concat(e),errorMessage:"Failed to delete WebAuthn registration.",method:"DELETE"});case 2:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteBiometricRegistration=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/biometric_registrations/".concat(e),errorMessage:"Failed to delete Biometric registration.",method:"DELETE"});case 2:return r=t.sent,n=Be(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))},this.onChange=function(e){var t=n._subscriptionService.getUser();return n._subscriptionService.subscribeToState((function(r){var n;(null==r?void 0:r.user)!==t&&(t=null!==(n=null==r?void 0:r.user)&&void 0!==n?n:null,e(t))}))}})),We=function(){function e(t,r){var n=this;oe(this,e),this._networkClient=t,this._subscriptionService=r,this.getSync=function(){return n._subscriptionService.getSession()},this.getInfo=function(){return{session:n.getSync(),fromCache:n._subscriptionService.getFromCache()}},this.onChange=function(e){var t=n._subscriptionService.getSession();return n._subscriptionService.subscribeToState((function(r){var n;(null==r?void 0:r.session)!==t&&(t=null!==(n=null==r?void 0:r.session)&&void 0!==n?n:null,e(t))}))},this.revoke=function(e){return ve(n,0,void 0,te().mark((function t(){var r;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._networkClient.fetchSDK({url:"/sessions/revoke",errorMessage:"Error revoking session",method:"POST"});case 3:return r=t.sent,this._subscriptionService.destroyState(),t.abrupt("return",r);case 8:throw t.prev=8,t.t0=t.catch(0),((null==e?void 0:e.forceClear)||G.includes(t.t0.error_type))&&this._subscriptionService.destroyState(),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,8]])})))},this.authenticate=function(e){return ve(n,0,void 0,te().mark((function t(){var r,n,i,o,s=this;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this._subscriptionService.getSession(),n=function(){var e;return(null==r?void 0:r.session_id)!==(null===(e=s._subscriptionService.getSession())||void 0===e?void 0:e.session_id)},t.prev=2,i={session_duration_minutes:null==e?void 0:e.session_duration_minutes},t.next=6,this._networkClient.fetchSDK({url:"/sessions/authenticate",body:i,errorMessage:"Error authenticating session",method:"POST"});case 6:if(o=t.sent,!n()){t.next=9;break}return t.abrupt("return",this.authenticate(e));case 9:return this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 13:if(t.prev=13,t.t0=t.catch(2),!n()){t.next=17;break}return t.abrupt("return",this.authenticate(e));case 17:throw G.includes(t.t0.error_type)&&this._subscriptionService.destroySession(),t.t0;case 19:case"end":return t.stop()}}),t,this,[[2,13]])})))}}return ne(e,[{key:"getTokens",value:function(){return this._subscriptionService.getTokens()}},{key:"updateSession",value:function(e){var t;Fe("stytch.session.updateSession").isString("session_token",e.session_token).isOptionalString("session_jwt",null!==(t=e.session_jwt)&&void 0!==t?t:void 0),this._subscriptionService.updateTokens(e)}}]),e}(),Ge=Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),He=function(){function e(t,r,n,i){var o=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ge,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ue();oe(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._passwordResetPKCEManager=i,this._config=s,this.dfpProtectedAuth=a,this.email={loginOrCreate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ve(o,0,void 0,te().mark((function r(){var n,i,o,s,a,c,u;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config;case 2:if(n=r.sent,i=n.pkceRequiredForEmailMagicLinks,o=void 0,!i){r.next=9;break}return r.next=8,this.getCodeChallenge();case 8:o=r.sent;case 9:return r.next=11,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 11:return s=r.sent,a=s.dfp_telemetry_id,c=s.captcha_token,u=Object.assign(Object.assign({},t),{email:e,code_challenge:o,captcha_token:c,dfp_telemetry_id:a}),r.abrupt("return",this._networkClient.retriableFetchSDK({url:"/magic_links/email/login_or_create",body:u,errorMessage:"Failed to send magic link",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 16:case"end":return r.stop()}}),r,this)})))},send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ve(o,0,void 0,te().mark((function r(){var n,i,o,s,a,c,u,l,h;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config;case 2:if(n=r.sent,i=n.pkceRequiredForEmailMagicLinks,o=void 0,!i){r.next=9;break}return r.next=8,this.getCodeChallenge();case 8:o=r.sent;case 9:return r.next=11,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 11:return s=r.sent,a=s.dfp_telemetry_id,c=s.captcha_token,u=Object.assign(Object.assign({},t),{email:e,code_challenge:o,captcha_token:c,dfp_telemetry_id:a}),l=!!this._subscriptionService.getSession(),h=l?"/magic_links/email/send/secondary":"/magic_links/email/send/primary",r.abrupt("return",this._networkClient.retriableFetchSDK({url:h,body:u,errorMessage:"Failed to send magic link",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 18:case"end":return r.stop()}}),r,this)})))}},this.authenticate=function(e,t){return ve(o,0,void 0,te().mark((function r(){var n,i;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return Fe("stytch.magicLinks.authenticate").isString("Token",e).isNumber("session_duration_minutes",t.session_duration_minutes),r.next=3,this._passwordResetPKCEManager.getPKPair();case 3:if(n=r.sent,i=null,!(null==n?void 0:n.code_verifier)){r.next=19;break}return r.prev=6,r.next=9,this.handlePKCEForAuthenticate(this._passwordResetPKCEManager,Object.assign(Object.assign({},t),{token:e}));case 9:i=r.sent,r.next=19;break;case 12:if(r.prev=12,r.t0=r.catch(6),!r.t0.message.includes("pkce")){r.next=18;break}l.log("Authenticate with passwords pkce namespace failed. Falling back to authenticate with magic_links namespace."),r.next=19;break;case 18:throw r.t0;case 19:if(i){r.next=23;break}return r.next=22,this.handlePKCEForAuthenticate(this._pkceManager,Object.assign(Object.assign({},t),{token:e}));case 22:i=r.sent;case 23:return this._subscriptionService.updateStateAndTokens({state:{session:i.session,user:i.user},session_token:i.session_token,session_jwt:i.session_jwt,intermediate_session_token:null}),r.abrupt("return",Ne(i));case 25:case"end":return r.stop()}}),r,this,[[6,12]])})))}}return ne(e,[{key:"getCodeChallenge",value:function(){return ve(this,0,void 0,te().mark((function e(){var t;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._pkceManager.getPKPair();case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",t.code_challenge);case 5:return e.next=7,this._pkceManager.startPKCETransaction();case 7:return t=e.sent,e.abrupt("return",t.code_challenge);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"handlePKCEForAuthenticate",value:function(e,t){return ve(this,0,void 0,te().mark((function r(){var n,i,o;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getPKPair();case 2:return n=r.sent,i=Object.assign({code_verifier:null==n?void 0:n.code_verifier},t),r.next=6,this._networkClient.fetchSDK({url:"/magic_links/authenticate",body:i,errorMessage:"Failed to authenticate token.",method:"POST"});case 6:return o=r.sent,e.clearPKPair(),r.abrupt("return",o);case 9:case"end":return r.stop()}}),r,this)})))}}]),e}(),Ve=ne((function e(t,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Promise.resolve(void 0)},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ue();oe(this,e),this._networkClient=t,this._subscriptionService=r,this.executeRecaptcha=i,this.dfpProtectedAuth=o,this.sms={loginOrCreate:function(e,t){return ve(n,0,void 0,te().mark((function r(){var n,i,o,s;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:o,dfp_telemetry_id:i}),r.abrupt("return",this._networkClient.retriableFetchSDK({url:"/otps/sms/login_or_create",body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 7:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return ve(n,0,void 0,te().mark((function r(){var n,i,o,s,a,c;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:o,dfp_telemetry_id:i}),a=!!this._subscriptionService.getSession(),c=a?"/otps/sms/send/secondary":"/otps/sms/send/primary",r.abrupt("return",this._networkClient.retriableFetchSDK({url:c,body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 9:case"end":return r.stop()}}),r,this)})))}},this.whatsapp={loginOrCreate:function(e,t){return ve(n,0,void 0,te().mark((function r(){var n,i,o,s;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,dfp_telemetry_id:i,captcha_token:o}),r.abrupt("return",this._networkClient.retriableFetchSDK({url:"/otps/whatsapp/login_or_create",body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 7:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return ve(n,0,void 0,te().mark((function r(){var n,i,o,s,a,c;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:o,dfp_telemetry_id:i}),a=!!this._subscriptionService.getSession(),c=a?"/otps/whatsapp/send/secondary":"/otps/whatsapp/send/primary",r.abrupt("return",this._networkClient.retriableFetchSDK({url:c,body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 9:case"end":return r.stop()}}),r,this)})))}},this.email={loginOrCreate:function(e,t){return ve(n,0,void 0,te().mark((function r(){var n,i;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,i=Object.assign(Object.assign({},t),{email:e,captcha_token:n}),r.abrupt("return",this._networkClient.fetchSDK({url:"/otps/email/login_or_create",body:i,errorMessage:"Failed to send one time passcode",method:"POST"}));case 5:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return ve(n,0,void 0,te().mark((function r(){var n,i,o,s;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,i=Object.assign(Object.assign({},t),{email:e,captcha_token:n}),o=!!this._subscriptionService.getSession(),s=o?"/otps/email/send/secondary":"/otps/email/send/primary",r.abrupt("return",this._networkClient.fetchSDK({url:s,body:i,errorMessage:"Failed to send one time passcode",method:"POST"}));case 7:case"end":return r.stop()}}),r,this)})))}},this.authenticate=function(e,t,r){return ve(n,0,void 0,te().mark((function n(){var i,o,s,a,c;return te().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Fe("stytch.otps.authenticate").isString("Code",e).isNumber("session_duration_minutes",r.session_duration_minutes),n.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return i=n.sent,o=i.dfp_telemetry_id,s=i.captcha_token,a=Object.assign({token:e,method_id:t,dfp_telemetry_id:o,captcha_token:s},r),n.next=9,this._networkClient.retriableFetchSDK({url:"/otps/authenticate",body:a,errorMessage:"Failed to authenticate token.",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 9:return c=n.sent,this._subscriptionService.updateStateAndTokens({state:{session:c.session,user:c.user},session_token:c.session_token,session_jwt:c.session_jwt,intermediate_session_token:null}),n.abrupt("return",Ne(c));case 12:case"end":return n.stop()}}),n,this)})))}})),Ye=function(){function e(t,r,n,o,s){oe(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._dynamicConfig=o,this._config=s,this.google={start:this.startOAuthFlow(i.Google)},this.apple={start:this.startOAuthFlow(i.Apple)},this.microsoft={start:this.startOAuthFlow(i.Microsoft)},this.github={start:this.startOAuthFlow(i.Github)},this.gitlab={start:this.startOAuthFlow(i.GitLab)},this.facebook={start:this.startOAuthFlow(i.Facebook)},this.discord={start:this.startOAuthFlow(i.Discord)},this.salesforce={start:this.startOAuthFlow(i.Salesforce)},this.slack={start:this.startOAuthFlow(i.Slack)},this.amazon={start:this.startOAuthFlow(i.Amazon)},this.bitbucket={start:this.startOAuthFlow(i.Bitbucket)},this.linkedin={start:this.startOAuthFlow(i.LinkedIn)},this.coinbase={start:this.startOAuthFlow(i.Coinbase)},this.twitch={start:this.startOAuthFlow(i.Twitch)},this.twitter={start:this.startOAuthFlow(i.Twitter)},this.tiktok={start:this.startOAuthFlow(i.TikTok)},this.snapchat={start:this.startOAuthFlow(i.Snapchat)},this.figma={start:this.startOAuthFlow(i.Figma)},this.yahoo={start:this.startOAuthFlow(i.Yahoo)}}return ne(e,[{key:"authenticate",value:function(e,t){return ve(this,0,void 0,te().mark((function r(){var n,i;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return Fe("stytch.oauth.authenticate").isString("Token",e).isNumber("session_duration_minutes",t.session_duration_minutes),r.next=3,this._pkceManager.getPKPair();case 3:return(n=r.sent)||Ie("No code verifier found in local storage for OAuth flow.\nConsider using stytch.oauth.$provider.start() to add PKCE to your OAuth flows for added security.\nSee https://stytch.com/docs/oauth#guides_pkce for more information."),r.next=7,this._networkClient.fetchSDK({url:"/oauth/authenticate",method:"POST",body:Object.assign({token:e,code_verifier:null==n?void 0:n.code_verifier},t),errorMessage:"Failed to authenticate token"});case 7:return i=r.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateStateAndTokens({state:{session:i.session,user:Be(i.__user)},session_token:i.session_token,session_jwt:i.session_jwt,intermediate_session_token:null}),r.abrupt("return",Ne(i));case 11:case"end":return r.stop()}}),r,this)})))}},{key:"getBaseApiUrl",value:function(){return ve(this,0,void 0,te().mark((function e(){var t,r;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dynamicConfig;case 2:if(t=e.sent,!(r=t.cnameDomain)){e.next=6;break}return e.abrupt("return","https://".concat(r));case 6:if(!this._config.publicToken.includes("public-token-test")){e.next=8;break}return e.abrupt("return",this._config.testAPIURL);case 8:return e.abrupt("return",this._config.liveAPIURL);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"startOAuthFlow",value:function(e){var t=this;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.login_redirect_url,i=r.signup_redirect_url,o=r.custom_scopes,s=r.provider_params;return ve(t,0,void 0,te().mark((function t(){var r,a,c,u,l,h,d;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._dynamicConfig;case 2:return r=t.sent,a=r.cnameDomain,c=r.pkceRequiredForOAuth,t.next=7,this.getBaseApiUrl();case 7:if(u=t.sent,this._networkClient.logEvent({name:"start_oauth_flow",details:{provider_type:e,custom_scopes:o,cname_domain:a,pkce:c,provider_params:s}}),(l=new URL("".concat(u,"/v1/public/oauth/").concat(e,"/start"))).searchParams.set("public_token",this._config.publicToken),!c){t.next=18;break}return t.next=14,this._pkceManager.startPKCETransaction();case 14:h=t.sent,l.searchParams.set("code_challenge",h.code_challenge),t.next=19;break;case 18:this._pkceManager.clearPKPair();case 19:if(o&&(Fe("startOAuthFlow").isStringArray("custom_scopes",o),l.searchParams.set("custom_scopes",o.join(" "))),s)for(d in Fe("startOAuthFlow").isOptionalObject("provider_params",s),s)l.searchParams.set("provider_"+d,s[d]);n&&l.searchParams.set("login_redirect_url",n),i&&l.searchParams.set("signup_redirect_url",i),window.location.href=l.toString();case 24:case"end":return t.stop()}}),t,this)})))}}}]),e}(),Je=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Promise.resolve(void 0)},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ue();oe(this,e),this._networkClient=t,this._subscriptionService=r,this.executeRecaptcha=n,this.dfpProtectedAuth=i}return ne(e,[{key:"authenticateStart",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.cryptoWallets.authenticateStart").isString("crypto_wallet_address",e.crypto_wallet_address).isString("crypto_wallet_type",e.crypto_wallet_type),r=!!this._subscriptionService.getSession(),t.next=4,this.executeRecaptcha();case 4:return n=t.sent,i=r?"/crypto_wallets/authenticate/start/secondary":"/crypto_wallets/authenticate/start/primary",t.abrupt("return",this._networkClient.fetchSDK({url:i,method:"POST",errorMessage:"Failed to start wallet authentication.",body:{crypto_wallet_address:e.crypto_wallet_address,crypto_wallet_type:e.crypto_wallet_type,captcha_token:n}}));case 7:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.cryptoWallets.authenticate").isString("signature",e.signature).isString("crypto_wallet_address",e.crypto_wallet_address).isString("crypto_wallet_type",e.crypto_wallet_type).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/crypto_wallets/authenticate",method:"POST",errorMessage:"Failed to authenticate.",body:{session_duration_minutes:e.session_duration_minutes,crypto_wallet_address:e.crypto_wallet_address,crypto_wallet_type:e.crypto_wallet_type,signature:e.signature,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:Be(o.__user)},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 11:case"end":return t.stop()}}),t,this)})))}}]),e}(),$e=function(){function e(t,r,n){oe(this,e),this._networkClient=t,this._subscriptionService=r,this.dfpProtectedAuth=n}return ne(e,[{key:"create",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.totps.create").isNumber("expiration_minutes",e.expiration_minutes),t.next=3,this._networkClient.fetchSDK({url:"/totps",method:"POST",errorMessage:"Failed to create TOTP",body:{expiration_minutes:e.expiration_minutes}});case 3:return r=t.sent,this._subscriptionService.updateUser(r.__user),t.abrupt("return",Ne(r));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.totps.authenticate").isNumber("session_duration_minutes",e.session_duration_minutes).isString("totp_code",e.totp_code),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/totps/authenticate",method:"POST",errorMessage:"Failed to authenticate TOTP",body:{session_duration_minutes:e.session_duration_minutes,totp_code:e.totp_code,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.__user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"recoveryCodes",value:function(){return ve(this,0,void 0,te().mark((function e(){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._networkClient.fetchSDK({url:"/totps/recovery_codes",method:"POST",errorMessage:"Failed to retrieve recovery codes"}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"recover",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.totps.recover").isNumber("session_duration_minutes",e.session_duration_minutes).isString("recovery_code",e.recovery_code),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/totps/recover",method:"POST",errorMessage:"Failed to recover TOTP",body:{session_duration_minutes:e.session_duration_minutes,recovery_code:e.recovery_code,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.__user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 11:case"end":return t.stop()}}),t,this)})))}}]),e}();function Ze(e){for(var t="==".slice(0,(4-e.length%4)%4),r=e.replace(/-/g,"+").replace(/_/g,"/")+t,n=atob(r),i=new ArrayBuffer(n.length),o=new Uint8Array(i),s=0;s<n.length;s++)o[s]=n.charCodeAt(s);return i}function Xe(e){var t,r="",n=Z(new Uint8Array(e));try{for(n.s();!(t=n.n()).done;){var i=t.value;r+=String.fromCharCode(i)}}catch(e){n.e(e)}finally{n.f()}return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var Qe="copy",et="convert";function tt(e,t,r){if(t===Qe)return r;if(t===et)return e(r);if(t instanceof Array)return r.map((function(r){return tt(e,t[0],r)}));if(t instanceof Object){for(var n={},i=0,o=Object.entries(t);i<o.length;i++){var s=$(o[i],2),a=s[0],c=s[1];if(c.derive){var u=c.derive(r);void 0!==u&&(r[a]=u)}if(a in r)null!=r[a]?n[a]=tt(e,c.schema,r[a]):n[a]=null;else if(c.required)throw new Error("Missing key: ".concat(a))}return n}}function rt(e,t){return{required:!0,schema:e,derive:t}}function nt(e){return{required:!0,schema:e}}function it(e){return{required:!1,schema:e}}var ot={type:nt(Qe),id:nt(et),transports:it(Qe)},st={appid:it(Qe),appidExclude:it(Qe),credProps:it(Qe)},at={appid:it(Qe),appidExclude:it(Qe),credProps:it(Qe)},ct={publicKey:nt({rp:nt(Qe),user:nt({id:nt(et),name:nt(Qe),displayName:nt(Qe)}),challenge:nt(et),pubKeyCredParams:nt(Qe),timeout:it(Qe),excludeCredentials:it([ot]),authenticatorSelection:it(Qe),attestation:it(Qe),extensions:it(st)}),signal:it(Qe)},ut={type:nt(Qe),id:nt(Qe),rawId:nt(et),authenticatorAttachment:it(Qe),response:nt({clientDataJSON:nt(et),attestationObject:nt(et),transports:rt(Qe,(function(e){var t;return(null==(t=e.getTransports)?void 0:t.call(e))||[]}))}),clientExtensionResults:rt(at,(function(e){return e.getClientExtensionResults()}))},lt={mediation:it(Qe),publicKey:nt({challenge:nt(et),timeout:it(Qe),rpId:it(Qe),allowCredentials:it([ot]),userVerification:it(Qe),extensions:it(st)}),signal:it(Qe)},ht={type:nt(Qe),id:nt(Qe),rawId:nt(et),authenticatorAttachment:it(Qe),response:nt({clientDataJSON:nt(et),authenticatorData:nt(et),signature:nt(et),userHandle:nt(et)}),clientExtensionResults:rt(at,(function(e){return e.getClientExtensionResults()}))};function dt(e){return tt(Ze,ct,e)}function pt(e){return tt(Xe,ut,e)}function ft(e){return ve(this,0,void 0,te().mark((function t(){var r;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.credentials.create(dt(e));case 2:return r=t.sent,t.abrupt("return",pt(r));case 4:case"end":return t.stop()}}),t)})))}function vt(e){return tt(Ze,lt,e)}function mt(e){return tt(Xe,ht,e)}function _t(e){return ve(this,0,void 0,te().mark((function t(){var r;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.credentials.get(vt(e));case 2:return r=t.sent,t.abrupt("return",mt(r));case 4:case"end":return t.stop()}}),t)})))}var yt=function(){function e(t,r,n){oe(this,e),this._networkClient=t,this._subscriptionService=r,this.dfpProtectedAuth=n,this.checkEligibleInputs=function(){return!(document.querySelectorAll("input[autocomplete*='webauthn']").length<1)||(l.error('No <input> with `"webauthn"` in its `autocomplete` attribute was detected'),!1)}}return ne(e,[{key:"register",value:function(e){var t,r;return ve(this,0,void 0,te().mark((function n(){var i,o,s,a,c;return te().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Fe("stytch.webauthn.register").isOptionalString("domain",null==e?void 0:e.domain).isOptionalString("authenticator_type",null==e?void 0:e.authenticator_type).isOptionalBoolean("is_passkey",null==e?void 0:e.is_passkey).isOptionalNumber("session_duration_minutes",null==e?void 0:e.session_duration_minutes),n.next=3,this._networkClient.fetchSDK({url:"/webauthn/register/start",method:"POST",errorMessage:"Failed to start WebAuthn registration",body:{domain:null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:window.location.hostname,authenticator_type:null!==(r=null==e?void 0:e.authenticator_type)&&void 0!==r?r:void 0,return_passkey_credential_options:null==e?void 0:e.is_passkey,user_agent:navigator.userAgent}});case 3:return i=n.sent,o=i.public_key_credential_creation_options,s=JSON.parse(o),n.next=8,ft({publicKey:s});case 8:return a=n.sent,n.next=11,this._networkClient.fetchSDK({url:"/webauthn/register",method:"POST",errorMessage:"Failed to register WebAuthn device",body:{public_key_credential:JSON.stringify(a),session_duration_minutes:null==e?void 0:e.session_duration_minutes}});case 11:return c=n.sent,this._subscriptionService.updateStateAndTokens({state:{session:c.session,user:c.__user},session_token:c.session_token,session_jwt:c.session_jwt,intermediate_session_token:null}),n.abrupt("return",Ne(c));case 14:case"end":return n.stop()}}),n,this)})))}},{key:"authenticate",value:function(e){var t,r;return ve(this,0,void 0,te().mark((function n(){var i,o,s,a,c,u,h,d,p,f,v,m;return te().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Fe("stytch.webauthn.authenticate").isOptionalString("domain",e.domain).isNumber("session_duration_minutes",e.session_duration_minutes).isOptionalBoolean("is_passkey",e.is_passkey).isOptionalObject("signal",e.signal),n.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:if(i=n.sent,o=i.dfp_telemetry_id,s=i.captcha_token,!e.conditional_mediation){n.next=14;break}return n.next=9,this.browserSupportsAutofill();case 9:if(n.sent){n.next=12;break}return l.error("Browser does not support WebAuthn autofill"),n.abrupt("return",null);case 12:if(this.checkEligibleInputs()){n.next=14;break}return n.abrupt("return",null);case 14:return a=!!this._subscriptionService.getSession(),c=a?"/webauthn/authenticate/start/secondary":"/webauthn/authenticate/start/primary",n.next=18,this._networkClient.fetchSDK({url:c,method:"POST",errorMessage:"Failed to start WebAuthn authentication",body:{domain:null!==(t=e.domain)&&void 0!==t?t:window.location.hostname,return_passkey_credential_options:null==e?void 0:e.is_passkey}});case 18:return u=n.sent,h=u.public_key_credential_request_options,d=new AbortController,p={publicKey:JSON.parse(h),signal:null!==(r=e.signal)&&void 0!==r?r:d.signal},f=Object.assign(Object.assign({},p),{mediation:"conditional"}),n.next=25,_t(e.conditional_mediation?f:p);case 25:return v=n.sent,n.next=28,this._networkClient.retriableFetchSDK({url:"/webauthn/authenticate",method:"POST",errorMessage:"Failed to authenticate WebAuthn device",body:{public_key_credential:JSON.stringify(v),session_duration_minutes:e.session_duration_minutes,dfp_telemetry_id:o,captcha_token:s},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 28:return m=n.sent,this._subscriptionService.updateStateAndTokens({state:{session:m.session,user:m.__user},session_token:m.session_token,session_jwt:m.session_jwt,intermediate_session_token:null}),n.abrupt("return",Ne(m));case 31:case"end":return n.stop()}}),n,this)})))}},{key:"update",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="/webauthn/update/"+e.webauthn_registration_id,t.next=3,this._networkClient.fetchSDK({url:r,method:"PUT",errorMessage:"Failed to update WebAuthn Registration",body:{name:e.name}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"browserSupportsAutofill",value:function(){return ve(this,0,void 0,te().mark((function e(){var t;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=window.PublicKeyCredential)&&void 0!==t.isConditionalMediationAvailable){e.next=3;break}return e.abrupt("return",new Promise((function(e){return e(!1)})));case 3:return e.abrupt("return",t.isConditionalMediationAvailable());case 4:case"end":return e.stop()}}),e)})))}}]),e}(),bt=Promise.resolve({pkceRequiredForPasswordResets:!1}),gt=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bt,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ue();oe(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._config=i,this.dfpProtectedAuth=o}return ne(e,[{key:"getCodeChallenge",value:function(){return ve(this,0,void 0,te().mark((function e(){var t,r;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._config;case 2:if(t=e.sent,t.pkceRequiredForPasswordResets){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.next=8,this._pkceManager.getPKPair();case 8:if(!(r=e.sent)){e.next=11;break}return e.abrupt("return",r.code_challenge);case 11:return e.next=13,this._pkceManager.startPKCETransaction();case 13:return r=e.sent,e.abrupt("return",r.code_challenge);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"create",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.create").isString("password",e.password).isString("email",e.email).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords",method:"POST",errorMessage:"Failed to create password.",body:{email:e.email,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.authenticate").isString("password",e.password).isString("email",e.email).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords/authenticate",method:"POST",errorMessage:"Failed to authenticate password.",body:{email:e.email,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"resetByEmailStart",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.resetByEmailStart").isString("email",e.email).isOptionalString("login_redirect_url",e.login_redirect_url).isOptionalString("reset_password_redirect_url",e.reset_password_redirect_url).isOptionalString("reset_password_template_id",e.reset_password_template_id).isOptionalNumber("reset_password_expiration_minutes",e.reset_password_expiration_minutes),t.next=3,this.getCodeChallenge();case 3:return r=t.sent,t.next=6,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 6:return n=t.sent,i=n.dfp_telemetry_id,o=n.captcha_token,t.abrupt("return",this._networkClient.retriableFetchSDK({url:"/passwords/email/reset/start",method:"POST",errorMessage:"Failed to start password reset flow.",body:{email:e.email,login_redirect_url:e.login_redirect_url,reset_password_redirect_url:e.reset_password_redirect_url,reset_password_expiration_minutes:e.reset_password_expiration_minutes,reset_password_template_id:e.reset_password_template_id,code_challenge:r,captcha_token:o,dfp_telemetry_id:i},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"resetByEmail",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o,s,a;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.resetByEmail").isString("token",e.token).isString("password",e.password).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._pkceManager.getPKPair();case 8:return o=t.sent,s=null==o?void 0:o.code_verifier,t.next=12,this._networkClient.retriableFetchSDK({url:"/passwords/email/reset",method:"POST",errorMessage:"Failed to reset password.",body:{token:e.token,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:i,code_verifier:s,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 12:return a=t.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateStateAndTokens({state:{session:a.session,user:a.user},session_token:a.session_token,session_jwt:a.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(a));case 16:case"end":return t.stop()}}),t,this)})))}},{key:"resetByExistingPassword",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.resetByExistingPassword").isString("email",e.email).isString("existing_password",e.existing_password).isString("new_password",e.new_password).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords/existing_password/reset",method:"POST",errorMessage:"Failed to reset password.",body:{email:e.email,existing_password:e.existing_password,new_password:e.new_password,session_duration_minutes:e.session_duration_minutes,dfp_telemetry_id:n,captcha_token:i},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",Ne(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"resetBySession",value:function(e){return ve(this,0,void 0,te().mark((function t(){var r,n,i,o;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.resetBySession").isString("password",e.password),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords/session/reset",method:"POST",errorMessage:"Failed to reset by session.",body:{password:e.password,session_duration_minutes:e.session_duration_minutes,dfp_telemetry_id:n,captcha_token:i},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",o);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"strengthCheck",value:function(e){return ve(this,0,void 0,te().mark((function t(){return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Fe("stytch.passwords.strengthCheck").isOptionalString("email",e.email).isString("password",e.password),t.abrupt("return",this._networkClient.fetchSDK({url:"/passwords/strength_check",method:"POST",errorMessage:"Failed to check password strength.",body:{email:e.email,password:e.password}}));case 2:case"end":return t.stop()}}),t,this)})))}}]),e}();Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),Promise.resolve({pkceRequiredForPasswordResets:!1});var kt=function(){function e(t){oe(this,e),this.iframeURL=t,this.createIframe()}return ne(e,[{key:"createIframe",value:function(){var e=document.querySelector('[src~="'.concat(this.iframeURL,'"]'));e?Ie("It looks like you're creating multiple copies of the Stytch client. This behavior is unsupported, and unintended side effects may occur. Make sure you are creating the Stytch client at the global level, and not inside a component's render function."):((e=document.createElement("iframe")).src=this.iframeURL,e.style.position="absolute",e.style.width="0",e.style.height="0",e.style.border="0",document.body.appendChild(e)),"true"!==e.dataset.loaded?this.frame=new Promise((function(t){e.addEventListener("load",(function(){e.dataset.loaded="true",t(e)}),{once:!0})})):this.frame=Promise.resolve(e)}},{key:"call",value:function(e,t){return ve(this,0,void 0,te().mark((function r(){var n,i,o=this;return te().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.frame;case 2:return n=r.sent,i=new MessageChannel,r.abrupt("return",new Promise((function(r,s){var a;i.port1.onmessage=function(e){var t=e.data;i.port1.close(),t.success?r(t.payload):s(Ke.unmarshall(t.error))};var c={method:e,args:t};null===(a=n.contentWindow)||void 0===a||a.postMessage(c,o.iframeURL,[i.port2])})));case 5:case"end":return r.stop()}}),r,this)})))}}]),e}(),wt=function(){function e(t,r){oe(this,e),this._networkClient=t,this.dfpProtectedAuth=r}return ne(e,[{key:"searchUser",value:function(e){var t=this;return this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha().then((function(r){var n=r.dfp_telemetry_id,i=r.captcha_token;return t._networkClient.fetchSDK({url:"/users/search",method:"POST",body:{email:e,dfp_telemetry_id:n,captcha_token:i},errorMessage:"Error searching for user ".concat(e)})}))}},{key:"searchMember",value:function(e,t){return this._networkClient.fetchSDK({url:"/b2b/organizations/members/search",method:"POST",body:{email_address:e,organization_id:t},errorMessage:"Error searching for member ".concat(e)})}}]),e}(),St=function(){function e(t,r){var n=this;oe(this,e),this._subscriptionService=t,this._headlessSessionClient=r,this._onDataChange=function(e){!function(e){return!!(null==e?void 0:e.session)}(e)?n.cancelBackgroundRefresh():n.scheduleBackgroundRefresh()},this._reauthenticateWithBackoff=function(){return ve(n,0,void 0,te().mark((function t(){var r;return te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:return t.prev=2,t.next=5,this._headlessSessionClient.authenticate();case 5:return t.abrupt("return",t.sent);case 8:if(t.prev=8,t.t0=t.catch(2),!e.isUnrecoverableError(t.t0)){t.next=12;break}return t.abrupt("return",Promise.reject(t.t0));case 12:return r++,t.next=15,new Promise((function(t){return setTimeout(t,e.timeoutForAttempt(r))}));case 15:t.next=1;break;case 17:case"end":return t.stop()}}),t,this,[[2,8]])})))},this.timeout=null,this._subscriptionService.subscribeToState(this._onDataChange)}return ne(e,[{key:"performBackgroundRefresh",value:function(){var e=this;this._reauthenticateWithBackoff().then((function(){e.scheduleBackgroundRefresh()})).catch((function(t){Ie("Session background refresh failed. Signalling to app that user is logged out.",{error:t}),e._subscriptionService.destroySession()}))}},{key:"scheduleBackgroundRefresh",value:function(){var t=this;this.cancelBackgroundRefresh(),this.timeout=setTimeout((function(){t.performBackgroundRefresh()}),e.REFRESH_INTERVAL_MS)}},{key:"cancelBackgroundRefresh",value:function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}],[{key:"timeoutForAttempt",value:function(e){return e=Math.min(e,7),Math.floor(350*Math.random())-175+2e3*Math.pow(2,e)}},{key:"isUnrecoverableError",value:function(e){return G.includes(e.error_type)}}]),e}();St.REFRESH_INTERVAL_MS=18e4;var Ct=ne((function e(t,r){var n=this;oe(this,e),this._subscriptionService=t,this.emptyState=r,this.onStateChange=function(e){return n._subscriptionService.subscribeToState((function(t){e(null!=t?t:n.emptyState)}))}})),Ot="bootstrap",Tt=function(){function e(t,r,n){var i=this;S(this,e),this._publicToken=t,this._networkClient=r,this._dataLayer=n,this._bootstrapDataPromise=this._networkClient.fetchSDK({url:"/projects/bootstrap/".concat(this._publicToken),method:"GET",errorMessage:"Error fetching bootstrap data for SDK for ".concat(this._publicToken)}).then(e.mapBootstrapData).then((function(e){return i._dataLayer.setItem(Ot,JSON.stringify(e)),e})).catch((function(e){return De(e),{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1,rbacPolicy:null}}))}return O(e,[{key:"getSync",value:function(){var e=this._dataLayer.getItem(Ot);if(null===e)return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1,rbacPolicy:null};try{return JSON.parse(e)}catch(e){return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1,rbacPolicy:null}}}},{key:"getAsync",value:function(){return this._bootstrapDataPromise}}],[{key:"mapBootstrapData",value:function(e){var t,r,n=null!==e.password_config?{ludsComplexity:e.password_config.luds_complexity,ludsMinimumCount:e.password_config.luds_minimum_count}:null;return{displayWatermark:!e.disable_sdk_watermark,captchaSettings:e.captcha_settings,cnameDomain:e.cname_domain,emailDomains:e.email_domains,pkceRequiredForEmailMagicLinks:e.pkce_required_for_email_magic_links,pkceRequiredForPasswordResets:e.pkce_required_for_password_resets,pkceRequiredForOAuth:e.pkce_required_for_oauth,pkceRequiredForSso:e.pkce_required_for_sso,slugPattern:e.slug_pattern,createOrganizationEnabled:e.create_organization_enabled,passwordConfig:n,runDFPProtectedAuth:null!==(t=e.dfp_protected_auth_enabled)&&void 0!==t&&t,dfpProtectedAuthMode:e.dfp_protected_auth_mode,rbacPolicy:null!==(r=e.rbac_policy)&&void 0!==r?r:null}}}]),e}();function xt(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var Pt=O((function e(t){var r=this;S(this,e),this.bootstrapPromise=t,this.executeRecaptcha=function(){return xt(r,void 0,void 0,k().mark((function e(){var t,r,n,i;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.captchaClient,n=t.configured,i=t.siteKey,n){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,new Promise((function(e){return r.ready(e)}));case 10:return e.abrupt("return",r.execute(i,{action:"LOGIN"}));case 11:case"end":return e.stop()}}),e,this)})))},this.state=t.then((function(e){return xt(r,void 0,void 0,k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.captchaSettings.enabled){t.next=2;break}return t.abrupt("return",{configured:!1});case 2:return t.next=4,r=e.captchaSettings.siteKey,Pe("https://www.google.com/recaptcha/enterprise.js?render=".concat(r),(function(){return window.grecaptcha.enterprise}));case 4:return t.t0=t.sent,t.t1=e.captchaSettings.siteKey,t.abrupt("return",{configured:!0,captchaClient:t.t0,siteKey:t.t1});case 7:case"end":return t.stop()}var r}),t)})))}))})),Et=function(){function e(t){var r=this;S(this,e),this.iframeURL=t,this.oneTapStart=function(e){return r.call("oneTapStart",e)},this.oneTapSubmit=function(e){return r.call("oneTapSubmit",e)},this.parsedPhoneNumber=function(e){return r.call("parsedPhoneNumber",e)}}return O(e,[{key:"frameClient",get:function(){var e;return this._frameClient=null!==(e=this._frameClient)&&void 0!==e?e:new kt(this.iframeURL),this._frameClient}},{key:"call",value:function(e,t){return this.frameClient.call(e,[t])}}]),e}(),At=function(e){function t(e,r,n,i,o,a){var c;return S(this,t),(c=v(this,t,[e,r,n,i,o]))._oneTap=a,c.startOneTap=function(e){return xt(y(c),void 0,void 0,k().mark((function t(){var r,n,i;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._oneTap.createOneTapClient();case 2:if((r=t.sent).success){t.next=5;break}throw new Error("One Tap could not load: ".concat(r.reason));case 5:return n=r.client,i=this._oneTap.createOnSuccessHandler({signupRedirectUrl:e.signup_redirect_url,loginRedirectUrl:e.login_redirect_url,onSuccess:this._oneTap.RedirectOnSuccess}),t.abrupt("return",n.render({style:{position:s.floating},onOneTapCancelled:e.onOneTapCancelled,callback:i}));case 8:case"end":return t.stop()}}),t,this)})))},c.googleOneTap={start:c.startOneTap},c}return b(t,e),O(t)}(Ye),Rt=function(){function e(t,r,n,i){S(this,e),this._publicToken=t,this._subscriptionDataLayer=r,this.baseURL=n,this.additionalTelemetryDataFn=i,this.updateSessionToken=function(){return null},this.eventLogger=new qe({maxBatchSize:15,intervalDurationMs:800,logEventURL:this.buildSDKUrl("/events")})}return O(e,[{key:"logEvent",value:function(e){var t=e.name,r=e.details,n=e.error,i=void 0===n?{}:n;this.eventLogger.logEvent(this.createTelemetryBlob(),{public_token:this._publicToken,event_name:t,details:r,error_code:i.error_code,error_description:i.error_description,http_status_code:i.http_status_code})}},{key:"createTelemetryBlob",value:function(){return Object.assign(Object.assign({event_id:"event-id-".concat(Te()),app_session_id:"app-session-id-".concat(Te()),persistent_id:"persistent-id-".concat(Te()),client_sent_at:(new Date).toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},this.additionalTelemetryDataFn()),{app:{identifier:window.location.hostname},sdk:{identifier:"Stytch.js Javascript SDK",version:"4.15.0"}})}},{key:"fetchSDK",value:function(e){var t=e.url,r=e.body,n=e.errorMessage,i=e.method;return xt(this,void 0,void 0,k().mark((function e(){var o,s,a,c;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this._subscriptionDataLayer.readSessionCookie().session_token,s="Basic "+window.btoa(this._publicToken+":"+(o||this._publicToken)),a=window.btoa(JSON.stringify(this.createTelemetryBlob())),c=window.location.origin,e.abrupt("return",be({basicAuthHeader:s,body:r,errorMessage:n,finalURL:this.buildSDKUrl(t),method:i,xSDKClientHeader:a,xSDKParentHostHeader:c}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"retriableFetchSDK",value:function(e){var t=e.url,r=e.body,n=e.errorMessage,i=e.method,o=e.retryCallback;return xt(this,void 0,void 0,k().mark((function e(){var s,a,c,u;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this._subscriptionDataLayer.readSessionCookie().session_token,a="Basic "+window.btoa(this._publicToken+":"+(s||this._publicToken)),c=window.btoa(JSON.stringify(this.createTelemetryBlob())),u=window.location.origin,e.abrupt("return",ye({basicAuthHeader:a,body:r,errorMessage:n,finalURL:this.buildSDKUrl(t),method:i,xSDKClientHeader:c,xSDKParentHostHeader:u,retryCallback:o}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"buildSDKUrl",value:function(e){return"".concat(this.baseURL,"/sdk/v1").concat(e)}}]),e}(),Lt="undefined"!=typeof window&&"IdentityCredential"in window,It=function(e){return e===s.forceLegacyEmbedded?"force":e===s.embeddedOnly||e===s.embedded||e===s.floatingOrEmbedded},Dt=function(e){var t=It(e);return"force"===t||t&&!Lt},jt=function(){function e(t,r){S(this,e),this._googleClient=t,this._clientId=r}return O(e,[{key:"cancel",value:function(){this._googleClient.cancel()}},{key:"render",value:function(e){var t=e.callback,r=e.onOneTapCancelled,n=e.style;return xt(this,void 0,void 0,k().mark((function e(){var i,o,s,a=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=It(n.position),o=Dt(n.position),s={client_id:this._clientId,callback:t,auto_select:!1,context:"use",itp_support:!0,use_fedcm_for_prompt:"force"!==i},o&&(s.prompt_parent_id="google-parent-prompt",s.cancel_on_tap_outside=!1),this._googleClient.initialize(s),e.abrupt("return",new Promise((function(e){a._googleClient.prompt((function(t){var n,i,s,c,u;if(t.isSkippedMoment()){var l=null!==(i=null===(n=t.getSkippedReason)||void 0===n?void 0:n.call(t))&&void 0!==i?i:"unknown_reason";return"user_cancel"===l&&(null==r||r()),e({success:!1,reason:l})}return!t.isNotDisplayed&&o||(null===(s=t.isNotDisplayed)||void 0===s?void 0:s.call(t))?e({success:!1,reason:null!==(u=null===(c=t.getNotDisplayedReason)||void 0===c?void 0:c.call(t))&&void 0!==u?u:"unknown_reason"}):t.isDismissedMoment()?void 0:(a.styleFrame(o),e({success:!0}))}))})));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"styleFrame",value:function(e){e&&Array.from(document.getElementsByTagName("iframe")).forEach((function(e){e.src.includes(de)&&(e.style.width="100%")}))}}]),e}(),Ft=function(){function e(t,r){var n=this;S(this,e),this._publicToken=t,this.clientsideServices=r,this.createOnSuccessHandler=function(e){var t=e.loginRedirectUrl,r=e.signupRedirectUrl,i=e.onSuccess;return function(e){return xt(n,void 0,void 0,k().mark((function n(){var o,s,a;return k().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.credential,n.next=3,this.submitGoogleOneTapToken({credential:o,loginRedirectUrl:t,signupRedirectUrl:r});case 3:s=n.sent,a=s.redirect_url,i(a);case 6:case"end":return n.stop()}}),n,this)})))}},this.RedirectOnSuccess=function(e){window.location.href=e}}return O(e,[{key:"createOneTapClient",value:function(){return xt(this,void 0,void 0,k().mark((function e(){var t,r,n,i;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchGoogleStart();case 3:r=e.sent,t=r.googleClientId,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),n=e.t0,e.abrupt("return",{success:!1,reason:n.error_type});case 11:if(""!==t){e.next=13;break}return e.abrupt("return",{success:!1,reason:"oauth_config_not_found"});case 13:return e.t1=jt,e.next=16,Pe(pe,(function(){return window.google.accounts.id}));case 16:return e.t2=e.sent,e.t3=t,i=new e.t1(e.t2,e.t3),e.abrupt("return",{success:!0,client:i});case 20:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"fetchGoogleStart",value:function(){return this.googleConfig||(this.googleConfig=this.clientsideServices.oneTapStart({publicToken:this._publicToken})),this.googleConfig}},{key:"submitGoogleOneTapToken",value:function(e){var t=e.credential,r=e.loginRedirectUrl,n=e.signupRedirectUrl;return xt(this,void 0,void 0,k().mark((function e(){var i,o;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGoogleStart();case 2:return i=e.sent,o=i.oauthCallbackId,e.abrupt("return",this.clientsideServices.oneTapSubmit({publicToken:this._publicToken,idToken:t,loginRedirectURL:r,oauthCallbackID:o,signupRedirectURL:n}));case 5:case"end":return e.stop()}}),e,this)})))}}],[{key:"WillGoogleOneTapShowBannerForUA",value:function(e){var t=function(e,t){return-1!==e.indexOf(t)},r=t(e,"iPad")||t(e,"Android")&&!t(e,"Mobile")||t(e,"Silk"),n=t(e,"iPod")||t(e,"iPhone")||t(e,"Android")||t(e,"IEMobile");return!r&&n}},{key:"WillGoogleOneTapShowEmbedded",value:function(){return!e.WillGoogleOneTapShowBannerForUA(navigator.userAgent)}}]),e}();function Bt(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t}var Nt=function(){function e(t,r){S(this,e),this._dataLayer=t,this.namespace=r}return O(e,[{key:"key",value:function(){return"PKCE_VERIFIER:"+this.namespace}},{key:"startPKCETransaction",value:function(){return xt(this,void 0,void 0,k().mark((function t(){var r;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createProofkeyPair();case 2:return r=t.sent,this._dataLayer.setItem(this.key(),JSON.stringify(r)),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getPKPair",value:function(){var e=this._dataLayer.getItem(this.key());if(null!==e)try{return JSON.parse(e)}catch(e){return void Ie("Found malformed Proof Key pair in localstorage.")}}},{key:"clearPKPair",value:function(){return this._dataLayer.removeItem(this.key())}}],[{key:"createProofkeyPair",value:function(){return xt(this,void 0,void 0,k().mark((function e(){var t,r,n;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Uint32Array(16),window.crypto.getRandomValues(t),r=Array.from(t).map(Bt).join(""),e.next=5,window.crypto.subtle.digest("SHA-256",(new TextEncoder).encode(r));case 5:return n=e.sent,e.abrupt("return",{code_challenge:(i=n,o=void 0,btoa((o=String.fromCharCode).call.apply(o,[null].concat(d(new Uint8Array(i))))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),code_verifier:r});case 7:case"end":return e.stop()}var i,o}),e)})))}}]),e}(),Mt=function(e){return(document.cookie?document.cookie.split("; "):[]).filter((function(t){var r=h(t.split("="),1)[0];return e===r})).length>1},Ut=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat("stytch_sdk_state_").concat(e).concat(t?"::".concat(t):"")};function Kt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var qt=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=Kt({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+o}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var o=r[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(n[a]=t.read(s,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",Kt({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Kt({},this.attributes,t))},withConverter:function(t){return e(Kt({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),zt=new Map,Wt=function(e){clearTimeout(zt.get(e))},Gt=function(e,t,r){Wt(e);var n=setTimeout((function(){void 0===qt.get(e)&&qt.set(e,t,r)}),10);return zt.set(e,n),qt.set(e,t,r)},Ht=function(e){function t(){return S(this,t),v(this,t,arguments)}return b(t,e),O(t)}(function(){function e(t,r){var n=this;S(this,e),this.browserSessionStorage={getItem:function(e){return sessionStorage.getItem(Ut(n.publicToken,e))},setItem:function(e,t){return sessionStorage.setItem(Ut(n.publicToken,e),t)},removeItem:function(e){return sessionStorage.removeItem(Ut(n.publicToken,e))}},this.publicToken=t,this.state=null,this.stateKeysUpdated=new Set,this.subscriptions={},(null==r?void 0:r.cookieOptions)?(Fe("SubscriptionDataLayer").isOptionalString("cookieOptions.opaqueTokenCookieName",r.cookieOptions.opaqueTokenCookieName).isOptionalString("cookieOptions.jwtCookieName",r.cookieOptions.jwtCookieName).isOptionalString("cookieOptions.istCookieName",r.cookieOptions.istCookieName).isOptionalString("cookieOptions.path",r.cookieOptions.path).isOptionalString("cookieOptions.domain",r.cookieOptions.domain),this._jwtCookieName=r.cookieOptions.jwtCookieName||null,this._opaqueTokenCookieName=r.cookieOptions.opaqueTokenCookieName||null,this._cookiePath=r.cookieOptions.path||null,this._domain=r.cookieOptions.domain||null,this._cookieAvailableToSubdomains=r.cookieOptions.availableToSubdomains||!1,this._istCookieName=r.cookieOptions.istCookieName||null):(this._opaqueTokenCookieName=null,this._jwtCookieName=null,this._cookiePath=null,this._domain=null,this._cookieAvailableToSubdomains=!1,this._istCookieName=null);var i=localStorage.getItem(Ut(this.publicToken));if(i){var o;try{o=JSON.parse(i)}catch(e){return void this.syncToLocalStorage()}this.state=o}}return O(e,[{key:"opaqueTokenCookieName",get:function(){var e;return null!==(e=this._opaqueTokenCookieName)&&void 0!==e?e:"stytch_session"}},{key:"jwtCookieName",get:function(){var e;return null!==(e=this._jwtCookieName)&&void 0!==e?e:"stytch_session_jwt"}},{key:"istCookieName",get:function(){var e;return null!==(e=this._istCookieName)&&void 0!==e?e:"stytch_intermediate_session_token"}},{key:"readSessionCookie",value:function(){return{session_token:qt.get(this.opaqueTokenCookieName),session_jwt:qt.get(this.jwtCookieName)}}},{key:"readIntermediateSessionTokenCookie",value:function(){return qt.get(this.istCookieName)}},{key:"writeSessionCookie",value:function(t){var r,n,i,o,s=t.state,a=t.session_token,c=t.session_jwt,u=e.generateCookieOpts({expiresAt:null!==(n=null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.expires_at)&&void 0!==n?n:"",availableToSubdomains:this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});Gt(this.opaqueTokenCookieName,a,u),Gt(this.jwtCookieName,c,u);var l=e.generateCookieOpts({expiresAt:null!==(o=null===(i=null==s?void 0:s.session)||void 0===i?void 0:i.expires_at)&&void 0!==o?o:"",availableToSubdomains:!this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});Mt(this.jwtCookieName)&&qt.remove(this.jwtCookieName,l),Mt(this.opaqueTokenCookieName)&&qt.remove(this.opaqueTokenCookieName,l),Mt(this.jwtCookieName)&&Ie("Could not remove extraneous JWT cookie. This might happen if the cookie has been set using multiple `path` settings, and may produce unwanted behavior."),Mt(this.opaqueTokenCookieName)&&Ie("Could not remove extraneous opaque token cookie.")}},{key:"writeIntermediateSessionTokenCookie",value:function(t){var r=new Date(Date.now()+6e5),n=e.generateCookieOpts({expiresAt:r.toString(),availableToSubdomains:this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});Gt(this.istCookieName,t,n)}},{key:"removeSessionCookie",value:function(){this.removeCookies([this.opaqueTokenCookieName,this.jwtCookieName])}},{key:"removeISTCookie",value:function(){this.removeCookies([this.istCookieName])}},{key:"removeCookies",value:function(t){var r=this;[!0,!1].forEach((function(n){[r._cookiePath,null].forEach((function(i){[r._domain,null].forEach((function(r){var o=e.generateCookieOpts({expiresAt:new Date(0).toString(),availableToSubdomains:n,path:i,domain:r});t.forEach((function(e){qt.remove(e,o)}))}))}))})),t.forEach(Wt)}},{key:"syncToLocalStorage",value:function(){localStorage.setItem(Ut(this.publicToken),JSON.stringify(this.state))}},{key:"getItem",value:function(e){return localStorage.getItem(Ut(this.publicToken,e))}},{key:"setItem",value:function(e,t){return localStorage.setItem(Ut(this.publicToken,e),t)}},{key:"removeItem",value:function(e){return localStorage.removeItem(Ut(this.publicToken,e))}}],[{key:"generateCookieOpts",value:function(e){var t=e.path,r=e.domain,n=e.availableToSubdomains,i=e.expiresAt,o={expires:new Date(i),sameSite:"lax"};return t&&(o.path=t),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))?o.secure=!1:(n&&(o.domain=r||window.location.host),o.secure=!0),o}}]),e}()),Vt=Symbol.for("__stytch_DataLayer"),Yt=function(e,t){var r,n=((r=window)[Vt]||(r[Vt]={}),r[Vt]);return n[e]||(n[e]=new Ht(e,t)),n[e]},Jt=function(e,t){Object.values(e).forEach((function(e){return e(t)}))},$t=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).KEYS_TO_EXCLUDE,t=void 0===e?[]:e;return function e(r,n){return w(r)===w(n)&&(null===r||null===n?r===n:"object"===w(r)?Object.keys(r).length===Object.keys(n).length&&!Object.keys(r).some((function(e){return!(e in n)}))&&Object.entries(r).filter((function(e){var r=h(e,1)[0];return!t.includes(r)})).every((function(t){var r=h(t,2),i=r[0],o=r[1];return e(o,n[i])})):r===n)}}({KEYS_TO_EXCLUDE:["last_accessed_at"]}),Zt=function(){function e(t,r){var n=this;S(this,e),this._publicToken=t,this._datalayer=r,this.fromCache=!0,this._listen=function(e){if(e.key===Ut(n._publicToken)){var t=null===e.newValue||"null"===e.newValue?null:JSON.parse(e.newValue);n.updateState(t,!0)}},window.addEventListener("storage",this._listen),this._datalayer.readSessionCookie().session_token||this.destroySession()}return O(e,[{key:"getTokens",value:function(){var e=this._datalayer.readSessionCookie(),t=e.session_token,r=e.session_jwt;return"string"!=typeof t||"string"!=typeof r?null:{session_token:t,session_jwt:r}}},{key:"getIntermediateSessionToken",value:function(){return this._datalayer.readIntermediateSessionTokenCookie()||null}},{key:"destroyState",value:function(){this.updateStateAndTokens({state:null,session_token:null,session_jwt:null,intermediate_session_token:null})}},{key:"destroySession",value:function(){this._datalayer.removeSessionCookie(),this.updateState(null)}},{key:"_updateStateAndTokensInternal",value:function(e){var t=this._datalayer.state,r=null===e.state?null:Object.assign(Object.assign({},this._datalayer.state),e.state);this._datalayer.state=r;var n=this.getFromCache();this.setCacheRefreshed(),!n&&$t(t,r)||Jt(this._datalayer.subscriptions,r)}},{key:"updateStateAndTokens",value:function(e){e.state?(this._datalayer.writeSessionCookie(e),this._datalayer.removeISTCookie()):e.intermediate_session_token?(this._datalayer.writeIntermediateSessionTokenCookie(e.intermediate_session_token),this._datalayer.removeSessionCookie()):(this._datalayer.removeSessionCookie(),this._datalayer.removeISTCookie()),this._updateStateAndTokensInternal(e),this._datalayer.syncToLocalStorage()}},{key:"updateState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._datalayer.state,n=null===e?null:Object.assign(Object.assign({},this._datalayer.state),e);this._datalayer.state=n;var i=this.getFromCache();this.setCacheRefreshed();var o=!$t(r,n);(i||o)&&(Jt(this._datalayer.subscriptions,n),o&&!t&&this._datalayer.syncToLocalStorage())}},{key:"updateTokens",value:function(e){var t=e.session_token,r=e.session_jwt,n=this._datalayer.readSessionCookie(),i=Object.assign(Object.assign({},n),{session_token:t,session_jwt:r});t||r?(this._datalayer.writeSessionCookie(i),this._datalayer.removeISTCookie()):this._datalayer.removeSessionCookie()}},{key:"subscribeToState",value:function(e){return t=this._datalayer.subscriptions,r=e,n=Math.random().toString(36).slice(-10),t[n]=r,function(){return delete t[n]};var t,r,n}},{key:"getState",value:function(){return this._datalayer.state}},{key:"destroy",value:function(){window.removeEventListener("storage",this._listen)}},{key:"syncFromDeviceStorage",value:function(){return null}},{key:"getFromCache",value:function(){return this.fromCache}},{key:"setCacheRefreshed",value:function(){this.fromCache=!1}}]),e}(),Xt=function(e){function t(){var e;return S(this,t),(e=v(this,t,arguments)).updateUser=function(t){return e.updateState({user:t})},e.getUser=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.user)&&void 0!==r?r:null},e.getSession=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.session)&&void 0!==r?r:null},e}return b(t,e),O(t)}(Zt),Qt=Symbol.for("stytch__internal_b2c"),er=function(e,t){Object.assign(e,function(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},Qt,t))},tr=O((function e(t,r){var n,i=this;S(this,e),function(e){if("undefined"==typeof window)throw new Error("The ".concat(e," is not compatible with server-side environments.\nIf using nextjs, use the create").concat(e," method instead.\n```\n").concat("import { createStytchHeadlessClient } from '@stytch/nextjs/ui';\n    \nconst stytch = createStytchHeadlessClient('public-token-...');\n","\n```\n"))}("StytchHeadlessClient"),"string"!=typeof(n=t)?Ie("Public token is malformed. Expected a string, got ".concat(ee(n),".").concat(je)):""===n?Ie('Public token is malformed. Expected "public-token-...", got an empty string.'.concat(je)):n.startsWith("public-token-")||Ie('Public token is malformed. Expected "public-token-...", got '.concat(n,".").concat(je));var o,s,a,c,u,l,h,d,p,f,v,m=r,_={cookieOptions:null==(o=m)?void 0:o.cookieOptions,endpoints:{sdkBackendURL:null!==(a=null===(s=null==o?void 0:o.endpoints)||void 0===s?void 0:s.sdkBackendURL)&&void 0!==a?a:"https://web.stytch.com",testAPIURL:null!==(u=null===(c=null==o?void 0:o.endpoints)||void 0===c?void 0:c.testAPIURL)&&void 0!==u?u:"https://test.stytch.com",liveAPIURL:null!==(h=null===(l=null==o?void 0:o.endpoints)||void 0===l?void 0:l.liveAPIURL)&&void 0!==h?h:"https://api.stytch.com",dfpBackendURL:null!==(p=null===(d=null==o?void 0:o.endpoints)||void 0===d?void 0:d.dfpBackendURL)&&void 0!==p?p:"https://telemetry.stytch.com",clientsideServicesIframeURL:null!==(v=null===(f=null==o?void 0:o.endpoints)||void 0===f?void 0:f.clientsideServicesIframeURL)&&void 0!==v?v:"https://js.stytch.com/clientside-services/index.html"}};this._dataLayer=Yt(t,m),this._subscriptionService=new Xt(t,this._dataLayer),this._stateChangeClient=new Ct(this._subscriptionService,{}),this.onStateChange=function(){var e;return(e=i._stateChangeClient).onStateChange.apply(e,arguments)};var y=new Nt(this._dataLayer,"passwords");this._networkClient=new Rt(t,this._dataLayer,_.endpoints.sdkBackendURL,(function(){var e,t,r,n;return{stytch_user_id:null===(t=null===(e=i._dataLayer.state)||void 0===e?void 0:e.user)||void 0===t?void 0:t.user_id,stytch_session_id:null===(n=null===(r=i._dataLayer.state)||void 0===r?void 0:r.session)||void 0===n?void 0:n.session_id}}));var b=new Tt(t,this._networkClient,this._dataLayer),g=new Pt(b.getAsync()),k=new Me(t,_.endpoints.dfpBackendURL,b.getAsync(),g.executeRecaptcha),w=new Et(_.endpoints.clientsideServicesIframeURL),C=new Ft(t,w),O=new wt(this._networkClient,k);this.user=new ze(this._networkClient,this._subscriptionService),this.session=new We(this._networkClient,this._subscriptionService),this.magicLinks=new He(this._networkClient,this._subscriptionService,new Nt(this._dataLayer,"magic_links"),y,b.getAsync(),k),this.otps=new Ve(this._networkClient,this._subscriptionService,g.executeRecaptcha,k),this.oauth=new At(this._networkClient,this._subscriptionService,new Nt(this._dataLayer,"oauth"),b.getAsync(),{publicToken:t,testAPIURL:_.endpoints.testAPIURL,liveAPIURL:_.endpoints.liveAPIURL},C),this.cryptoWallets=new Je(this._networkClient,this._subscriptionService,g.executeRecaptcha,k),this.totps=new $e(this._networkClient,this._subscriptionService,k),this.webauthn=new yt(this._networkClient,this._subscriptionService,k),this.passwords=new gt(this._networkClient,this._subscriptionService,y,b.getAsync(),k),this._sessionManager=new St(this._subscriptionService,this.session),this._dataLayer.readSessionCookie().session_token&&this._sessionManager.performBackgroundRefresh(),this._networkClient.logEvent({name:"sdk_instance_instantiated",details:{event_callback_registered:!1,error_callback_registered:!1,success_callback_registered:!1}}),er(this,{bootstrap:b,clientsideServices:w,captcha:g,oneTap:C,searchManager:O,publicToken:t,dataLayer:this._dataLayer,networkClient:this._networkClient})}))},226143:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0,i(r(104802),t),i(r(889788),t),i(r(287816),t),i(r(589689),t);var o=r(604802);Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return o.Token}})},889788:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseError=t.parseItem=t.parseList=t.parseDictionary=void 0;const n=r(287816),i=r(604802),o=r(589689);t.parseDictionary=function(e){return new a(e).parseDictionary()},t.parseList=function(e){return new a(e).parseList()},t.parseItem=function(e){return new a(e).parseItem()};class s extends Error{constructor(e,t){super(`Parse error: ${t} at offset ${e}`)}}t.ParseError=s;class a{constructor(e){this.input=e,this.pos=0}parseDictionary(){this.skipWS();const e=new Map;for(;!this.eof();){const t=this.parseKey();let r;if("="===this.lookChar()?(this.pos++,r=this.parseItemOrInnerList()):r=[!0,this.parseParameters()],e.set(t,r),this.skipOWS(),this.eof())return e;if(this.expectChar(","),this.pos++,this.skipOWS(),this.eof())throw new s(this.pos,"Dictionary contained a trailing comma")}return e}parseList(){this.skipWS();const e=[];for(;!this.eof();){if(e.push(this.parseItemOrInnerList()),this.skipOWS(),this.eof())return e;if(this.expectChar(","),this.pos++,this.skipOWS(),this.eof())throw new s(this.pos,"A list may not end with a trailing comma")}return e}parseItem(e=!0){e&&this.skipWS();const t=[this.parseBareItem(),this.parseParameters()];return e&&this.checkTrail(),t}parseItemOrInnerList(){return"("===this.lookChar()?this.parseInnerList():this.parseItem(!1)}parseInnerList(){this.expectChar("("),this.pos++;const e=[];for(;!this.eof();){if(this.skipWS(),")"===this.lookChar())return this.pos++,[e,this.parseParameters()];e.push(this.parseItem(!1));const t=this.lookChar();if(" "!==t&&")"!==t)throw new s(this.pos,"Expected a whitespace or ) after every item in an inner list")}throw new s(this.pos,"Could not find end of inner list")}parseBareItem(){const e=this.lookChar();if(void 0===e)throw new s(this.pos,"Unexpected end of string");if(e.match(/^[-0-9]/))return this.parseIntegerOrDecimal();if('"'===e)return this.parseString();if(e.match(/^[A-Za-z*]/))return this.parseToken();if(":"===e)return this.parseByteSequence();if("?"===e)return this.parseBoolean();throw new s(this.pos,"Unexpected input")}parseParameters(){const e=new Map;for(;!this.eof();){if(";"!==this.lookChar())break;this.pos++,this.skipWS();const t=this.parseKey();let r=!0;"="===this.lookChar()&&(this.pos++,r=this.parseBareItem()),e.set(t,r)}return e}parseIntegerOrDecimal(){let e="integer",t=1,r="";if("-"===this.lookChar()&&(t=-1,this.pos++),!u(this.lookChar()))throw new s(this.pos,"Expected a digit (0-9)");for(;!this.eof();){const t=this.getChar();if(u(t))r+=t;else{if("integer"!==e||"."!==t){this.pos--;break}if(r.length>12)throw new s(this.pos,"Exceeded maximum decimal length");r+=".",e="decimal"}if("integer"===e&&r.length>15)throw new s(this.pos,"Exceeded maximum integer length");if("decimal"===e&&r.length>16)throw new s(this.pos,"Exceeded maximum decimal length")}if("integer"===e)return parseInt(r,10)*t;if(r.endsWith("."))throw new s(this.pos,"Decimal cannot end on a period");if(r.split(".")[1].length>3)throw new s(this.pos,"Number of digits after the decimal point cannot exceed 3");return parseFloat(r)*t}parseString(){let e="";for(this.expectChar('"'),this.pos++;!this.eof();){const t=this.getChar();if("\\"===t){if(this.eof())throw new s(this.pos,"Unexpected end of input");const t=this.getChar();if("\\"!==t&&'"'!==t)throw new s(this.pos,"A backslash must be followed by another backslash or double quote");e+=t}else{if('"'===t)return e;if(!(0,o.isAscii)(t))throw new s(this.pos,"Strings must be in the ASCII range");e+=t}}throw new s(this.pos,"Unexpected end of input")}parseToken(){let e="";for(;!this.eof();){const t=this.lookChar();if(void 0===t||!/^[:/!#$%&'*+\-.^_`|~A-Za-z0-9]$/.test(t))return new i.Token(e);e+=this.getChar()}return new i.Token(e)}parseByteSequence(){this.expectChar(":"),this.pos++;const e=this.input.indexOf(":",this.pos);if(-1===e)throw new s(this.pos,'Could not find a closing ":" character to mark end of Byte Sequence');const t=this.input.substring(this.pos,e);if(this.pos+=t.length+1,!/^[A-Za-z0-9+/=]*$/.test(t))throw new s(this.pos,"ByteSequence does not contain a valid base64 string");return new n.ByteSequence(t)}parseBoolean(){this.expectChar("?"),this.pos++;const e=this.getChar();if("1"===e)return!0;if("0"===e)return!1;throw new s(this.pos,'Unexpected character. Expected a "1" or a "0"')}parseKey(){var e;if(!(null===(e=this.lookChar())||void 0===e?void 0:e.match(/^[a-z*]/)))throw new s(this.pos,"A key must begin with an asterisk or letter (a-z)");let t="";for(;!this.eof();){const e=this.lookChar();if(void 0===e||!/^[a-z0-9_\-.*]$/.test(e))return t;t+=this.getChar()}return t}lookChar(){return this.input[this.pos]}expectChar(e){if(this.lookChar()!==e)throw new s(this.pos,`Expected ${e}`)}getChar(){return this.input[this.pos++]}eof(){return this.pos>=this.input.length}skipOWS(){for(;;){const e=this.input.substr(this.pos,1);if(" "!==e&&"\t"!==e)break;this.pos++}}skipWS(){for(;" "===this.lookChar();)this.pos++}checkTrail(){if(this.skipWS(),!this.eof())throw new s(this.pos,"Unexpected characters at end of input")}}t.default=a;const c=/^[0-9]$/;function u(e){return void 0!==e&&c.test(e)}},104802:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeKey=t.serializeParameters=t.serializeToken=t.serializeByteSequence=t.serializeBoolean=t.serializeString=t.serializeDecimal=t.serializeInteger=t.serializeBareItem=t.serializeInnerList=t.serializeItem=t.serializeDictionary=t.serializeList=t.SerializeError=void 0;const n=r(287816),i=r(604802),o=r(589689);class s extends Error{}function a(e){return u(e[0])+m(e[1])}function c(e){return`(${e[0].map((e=>a(e))).join(" ")})${m(e[1])}`}function u(e){if("number"==typeof e)return Number.isInteger(e)?l(e):h(e);if("string"==typeof e)return d(e);if(e instanceof i.Token)return v(e);if(e instanceof n.ByteSequence)return f(e);if("boolean"==typeof e)return p(e);throw new s("Cannot serialize values of type "+typeof e)}function l(e){if(e<-999999999999999||e>999999999999999)throw new s("Structured headers can only encode integers in the range range of -999,999,999,999,999 to 999,999,999,999,999 inclusive");return e.toString()}function h(e){const t=e.toFixed(3).replace(/0+$/,"");if(t.split(".")[0].replace("-","").length>12)throw new s("Fractional numbers are not allowed to have more than 12 significant digits before the decimal point");return t}function d(e){if(!(0,o.isAscii)(e))throw new s("Only ASCII strings may be serialized");return`"${e.replace(/("|\\)/g,(e=>"\\"+e))}"`}function p(e){return e?"?1":"?0"}function f(e){return`:${e.toBase64()}:`}function v(e){return e.toString()}function m(e){return Array.from(e).map((([e,t])=>{let r=";"+_(e);return!0!==t&&(r+="="+u(t)),r})).join("")}function _(e){if(!(0,o.isValidKeyStr)(e))throw new s("Keys in dictionaries must only contain lowercase letter, numbers, _-*. and must start with a letter or *");return e}t.SerializeError=s,t.serializeList=function(e){return e.map((e=>(0,o.isInnerList)(e)?c(e):a(e))).join(", ")},t.serializeDictionary=function(e){return Array.from(e.entries()).map((([e,t])=>{let r=_(e);return!0===t[0]?r+=m(t[1]):(r+="=",(0,o.isInnerList)(t)?r+=c(t):r+=a(t)),r})).join(", ")},t.serializeItem=a,t.serializeInnerList=c,t.serializeBareItem=u,t.serializeInteger=l,t.serializeDecimal=h,t.serializeString=d,t.serializeBoolean=p,t.serializeByteSequence=f,t.serializeToken=v,t.serializeParameters=m,t.serializeKey=_},604802:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0;const n=r(589689);t.Token=class{constructor(e){if(!(0,n.isValidTokenStr)(e))throw new TypeError("Invalid character in Token string. Tokens must start with *, A-Z and the rest of the string may only contain a-z, A-Z, 0-9, :/!#$%&'*+-.^_`|~");this.value=e}toString(){return this.value}}},287816:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ByteSequence=void 0;t.ByteSequence=class{constructor(e){this.base64Value=e}toBase64(){return this.base64Value}}},589689:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isByteSequence=t.isInnerList=t.isValidKeyStr=t.isValidTokenStr=t.isAscii=void 0;const r=/^[\x20-\x7E]*$/,n=/^[a-zA-Z*][:/!#$%&'*+\-.^_`|~A-Za-z0-9]*$/,i=/^[a-z*][*\-_.a-z0-9]*$/;t.isAscii=function(e){return r.test(e)},t.isValidTokenStr=function(e){return n.test(e)},t.isValidKeyStr=function(e){return i.test(e)},t.isInnerList=function(e){return Array.isArray(e[0])},t.isByteSequence=function(e){return"object"==typeof e&&"base64Value"in e}},257848:function(e,t,r){var n=r(318139);function i(e,t){var r,i=null;if(!e||"string"!=typeof e)return i;for(var o,s,a=n(e),c="function"==typeof t,u=0,l=a.length;u<l;u++)o=(r=a[u]).property,s=r.value,c?t(o,s,r):s&&(i||(i={}),i[o]=s);return i}e.exports=i,e.exports.default=i},452738:function(e,t,r){"use strict";var n=r(257848);t.Z=n}}]);
//# sourceMappingURL=vendors-7a8d64d6-c65a115db8f53912.bundle.js.map