!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8c102774-8241-4354-9951-ee9b9de3137a",e._sentryDebugIdIdentifier="sentry-dbid-8c102774-8241-4354-9951-ee9b9de3137a")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"03c050f83997f8f858284f712ef0b0ca3dc661b2"},(self.webpackChunkdisco=self.webpackChunkdisco||[]).push([[4137],{600781:function(e,t,a){"use strict";function n(e,t){if(e===t)return!0;if(!e||!t)return!1;var a=Object.keys(e),n=Object.keys(t),s=a.length;if(n.length!==s)return!1;for(var r=0;r<s;r++){var i=a[r];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}a.d(t,{V:function(){return n}})},596774:function(e){e.exports=function(e,t,a,n){var s=a?a.call(n,e,t):void 0;if(void 0!==s)return!!s;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(t),c=0;c<r.length;c++){var l=r[c];if(!o(l))return!1;var d=e[l],u=t[l];if(!1===(s=a?a.call(n,d,u,l):void 0)||void 0===s&&d!==u)return!1}return!0}},442830:function(e,t,a){e.exports=s;var n=a(717187).EventEmitter;function s(){n.call(this)}a(35717)(s,n),s.Readable=a(179481),s.Writable=a(464229),s.Duplex=a(756753),s.Transform=a(974605),s.PassThrough=a(882725),s.finished=a(308610),s.pipeline=a(259946),s.Stream=s,s.prototype.pipe=function(e,t){var a=this;function s(t){e.writable&&!1===e.write(t)&&a.pause&&a.pause()}function r(){a.readable&&a.resume&&a.resume()}a.on("data",s),e.on("drain",r),e._isStdio||t&&!1===t.end||(a.on("end",o),a.on("close",c));var i=!1;function o(){i||(i=!0,e.end())}function c(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(d(),0===n.listenerCount(this,"error"))throw e}function d(){a.removeListener("data",s),e.removeListener("drain",r),a.removeListener("end",o),a.removeListener("close",c),a.removeListener("error",l),e.removeListener("error",l),a.removeListener("end",d),a.removeListener("close",d),e.removeListener("close",d)}return a.on("error",l),e.on("error",l),a.on("end",d),a.on("close",d),e.on("close",d),e.emit("pipe",a),e}},852429:function(e,t,a){"use strict";a.d(t,{P:function(){return G}});var n=a(667294),s=a(432228),r=a(922004),i=a(770149),o=a(565155),c=a(21681);const l=n.memo((e=>{const{actionHandler:t,actions:a,id:s,text:r}=e,{t:i}=(0,c.Ht)("UnMemoizedAttachmentActions");return n.createElement("div",{className:"str-chat__message-attachment-actions"},n.createElement("div",{className:"str-chat__message-attachment-actions-form"},n.createElement("span",null,r),a.map((e=>n.createElement("button",{className:`str-chat__message-attachment-actions-button str-chat__message-attachment-actions-button--${e.style}`,"data-testid":`${e.name}`,"data-value":e.value,key:`${s}-${e.value}`,onClick:a=>((e,a,n)=>t?.(a,n,e))(a,e.name,e.value)},e.text?i(e.text):null)))))}));var d=a(822787),u=a(998250),m=a(844068);const g=({fileSize:e,maximumFractionDigits:t})=>e&&Number.isFinite(Number(e))?n.createElement("span",{className:"str-chat__message-attachment-file--item-size","data-testid":"file-size-indicator"},(0,m.zu)(e,t)):null,h=({className:e,onClick:t,progress:a})=>n.createElement("div",{className:(0,i.Z)("str-chat__message-attachment-audio-widget--progress-track",e),"data-progress":a,"data-testid":"audio-progress",onClick:t,role:"progressbar",style:{"--str-chat__message-attachment-audio-widget-progress":a+"%"}},n.createElement("div",{className:"str-chat__message-attachment-audio-widget--progress-slider",style:{left:`${a}px`}}));var p=a(309288);const f=n.memo((e=>{const{og:{asset_url:t,file_size:a,mime_type:s,title:r}}=e,{audioRef:i,isPlaying:o,progress:c,seek:l,togglePlay:m}=(0,p.P)({mimeType:s});if(!t)return null;return n.createElement("div",{className:"str-chat__message-attachment-audio-widget","data-testid":"audio-widget"},n.createElement("audio",{ref:i},n.createElement("source",{"data-testid":"audio-source",src:t,type:"audio/mp3"})),n.createElement("div",{className:"str-chat__message-attachment-audio-widget--play-controls"},n.createElement(d.J,{isPlaying:o,onClick:m})),n.createElement("div",{className:"str-chat__message-attachment-audio-widget--text"},n.createElement("div",{className:"str-chat__message-attachment-audio-widget--text-first-row"},n.createElement("div",{className:"str-chat__message-attachment-audio-widget--title"},r),n.createElement(u.o,{assetUrl:t})),n.createElement("div",{className:"str-chat__message-attachment-audio-widget--text-second-row"},n.createElement(g,{fileSize:a}),n.createElement(h,{onClick:l,progress:c}))))}));var _=a(90725);const v=({children:e,onClick:t})=>n.createElement("button",{className:"str-chat__message_attachment__playback-rate-button","data-testid":"playback-rate-button",onClick:t},e);var y=a(431840);const E="str-chat__message-attachment__voice-recording-widget",w=({attachment:e,playbackRates:t})=>{const{t:a}=(0,c.Ht)("VoiceRecordingPlayer"),{asset_url:r,duration:i=0,mime_type:o,title:l=a("Voice message"),waveform_data:u}=e,{audioRef:m,increasePlaybackRate:h,isPlaying:f,playbackRate:w,progress:b,secondsElapsed:M,seek:C,togglePlay:N}=(0,p.P)({durationSeconds:i??0,mimeType:o,playbackRates:t});if(!r)return null;const S=M||i;return n.createElement("div",{className:E,"data-testid":"voice-recording-widget"},n.createElement("audio",{ref:m},n.createElement("source",{"data-testid":"audio-source",src:r,type:o})),n.createElement(d.J,{isPlaying:f,onClick:N}),n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__metadata"},n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__title","data-testid":"voice-recording-title",title:l},l),n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__audio-state"},n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__timer"},e.duration?(0,s.dp)(S):n.createElement(g,{fileSize:e.file_size,maximumFractionDigits:0})),n.createElement(_.e,{progress:b,seek:C,waveformData:u||[]}))),n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__right-section"},f?n.createElement(v,{disabled:!m.current,onClick:h},w.toFixed(1),"x"):n.createElement(y.a,{big:!0,mimeType:o,size:40})))},b=({attachment:e})=>{const{t:t}=(0,c.Ht)(),a=e.title||t("Voice message");return n.createElement("div",{className:E,"data-testid":"quoted-voice-recording-widget"},n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__metadata"},a&&n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__title","data-testid":"voice-recording-title",title:a},a),n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__audio-state"},n.createElement("div",{className:"str-chat__message-attachment__voice-recording-widget__timer"},e.duration?(0,s.dp)(e.duration):n.createElement(g,{fileSize:e.file_size,maximumFractionDigits:0})))),n.createElement(y.a,{big:!0,mimeType:e.mime_type,size:34}))},M=({attachment:e,isQuoted:t})=>t?n.createElement(b,{attachment:e}):n.createElement(w,{attachment:e});var C=a(219530),N=a(117967),S=a(606892),T=a(827666),x=a(249868),P=a(540239);const k=e=>{const{dimensions:t={},fallback:a,image_url:s,thumb_url:r,innerRef:i,previewUrl:o,style:c}=e,[l,d]=(0,n.useState)(!1),{BaseImage:u=S.Z,ModalGallery:m=x.R}=(0,P.yM)("ImageComponent"),g=(0,N.Nm)(o||s||r),h=()=>d((e=>!e));return n.createElement(n.Fragment,null,n.createElement(u,{alt:a,className:"str-chat__message-attachment--img","data-testid":"image-test",onClick:h,src:g,style:c,tabIndex:0,title:a,...t,...i&&{ref:i}}),n.createElement(T.u,{className:"str-chat__image-modal",onClose:h,open:l},n.createElement(m,{images:[e],index:0})))};var L=a(675813),R=a(387029);const I=({type:e})=>{const{t:t}=(0,c.Ht)("Card");return n.createElement("div",{className:(0,i.Z)("str-chat__message-attachment-card",{[`str-chat__message-attachment-card--${e}`]:e})},n.createElement("div",{className:"str-chat__message-attachment-card--content"},n.createElement("div",{className:"str-chat__message-attachment-card--text"},t("this content could not be displayed"))))},A=({author_name:e,url:t})=>n.createElement("div",{className:"str-chat__message-attachment-card--source-link","data-testid":"card-source-link"},n.createElement(L.H,{className:"str-chat__message-attachment-card--url",href:t,rel:"noopener noreferrer",target:"_blank"},e||(e=>{if(null!=e){const[t]=e.replace(/^(?:https?:\/\/)?(?:www\.)?/i,"").split("/");return t}return null})(t))),O=e=>{const{asset_url:t,dimensions:a,image:s,image_url:i,thumb_url:o,title:c,type:l}=e;let d=null;return t&&"video"===l?d=n.createElement(r.Z,{className:"react-player",controls:!0,height:"100%",url:t,width:"100%"}):s&&(d=n.createElement(k,{dimensions:a,fallback:c||s,image_url:i,thumb_url:o})),d?n.createElement("div",{className:"str-chat__message-attachment-card--header str-chat__message-attachment-card-react--header","data-testid":"card-header"},d):null},D=e=>{const{author_name:t,og_scrape_url:a,text:s,title:r,title_link:i,type:o}=e,c=i||a;return n.createElement("div",{className:"str-chat__message-attachment-card--content"},"audio"===o?n.createElement(H,{og:e}):n.createElement("div",{className:"str-chat__message-attachment-card--flex"},c&&n.createElement(A,{author_name:t,url:c}),r&&n.createElement("div",{className:"str-chat__message-attachment-card--title"},r),s&&n.createElement("div",{className:"str-chat__message-attachment-card--text"},s)))},H=({og:{asset_url:e,author_name:t,mime_type:a,og_scrape_url:s,text:r,title:i,title_link:o}})=>{const{audioRef:c,isPlaying:l,progress:u,seek:m,togglePlay:g}=(0,p.P)({mimeType:a}),f=o||s;return n.createElement("div",{className:"str-chat__message-attachment-card-audio-widget","data-testid":"card-audio-widget"},e&&n.createElement(n.Fragment,null,n.createElement("audio",{ref:c},n.createElement("source",{"data-testid":"audio-source",src:e,type:"audio/mp3"})),n.createElement("div",{className:"str-chat__message-attachment-card-audio-widget--first-row"},n.createElement("div",{className:"str-chat__message-attachment-audio-widget--play-controls"},n.createElement(d.J,{isPlaying:l,onClick:g})),n.createElement(h,{onClick:m,progress:u}))),n.createElement("div",{className:"str-chat__message-attachment-audio-widget--second-row"},f&&n.createElement(A,{author_name:t,url:f}),i&&n.createElement("div",{className:"str-chat__message-attachment-audio-widget--title"},i),r&&n.createElement("div",{className:"str-chat__message-attachment-audio-widget--description"},r)))},j=n.memo((e=>{const{asset_url:t,giphy:a,image_url:s,thumb_url:r,title:i,title_link:o,type:c}=e,{giphyVersion:l}=(0,R.JN)("CardHeader");let d=r||s;const u={};if("giphy"===c&&void 0!==a){const e=a[l];d=e.url,u.height=e.height,u.width=e.width}return i||o||t||d?n.createElement("div",{className:`str-chat__message-attachment-card str-chat__message-attachment-card--${c}`},n.createElement(O,{...e,dimensions:u,image:d}),n.createElement(D,{...e})):n.createElement(I,null)})),F=n.memo((({attachment:e})=>n.createElement("div",{className:"str-chat__message-attachment-file--item","data-testid":"attachment-file"},n.createElement(y.a,{className:"str-chat__file-icon",mimeType:e.mime_type}),n.createElement("div",{className:"str-chat__message-attachment-file--item-text"},n.createElement("div",{className:"str-chat__message-attachment-file--item-first-row"},n.createElement("div",{className:"str-chat__message-attachment-file--item-name","data-testid":"file-title"},e.title),n.createElement(u.o,{assetUrl:e.asset_url})),n.createElement(g,{fileSize:e.file_size}))))),$=({attachment:e})=>{const{t:t}=(0,c.Ht)("UnsupportedAttachment");return n.createElement("div",{className:"str-chat__message-attachment-unsupported","data-testid":"attachment-unsupported"},n.createElement(y.a,{className:"str-chat__file-icon"}),n.createElement("div",{className:"str-chat__message-attachment-unsupported__metadata"},n.createElement("div",{className:"str-chat__message-attachment-unsupported__title","data-testid":"unsupported-attachment-title"},e.title||t("Unsupported attachment"))))},B=({attachment:e,children:t,componentType:a})=>{let r="";(0,s.BE)(e)||(r="card"!==a||e?.image_url||e?.thumb_url?e?.actions?.length?"actions":"":"no-image");const o=(0,i.Z)("str-chat__message-attachment str-chat__message-attachment-dynamic-size",{[`str-chat__message-attachment--${a}`]:a,[`str-chat__message-attachment--${e?.type}`]:e?.type,[`str-chat__message-attachment--${a}--${r}`]:a&&r,"str-chat__message-attachment--svg-image":(0,s.WV)(e),"str-chat__message-attachment-with-actions":"actions"===r});return n.createElement("div",{className:o},t)},U=({actionHandler:e,attachment:t,AttachmentActions:a=l})=>t.actions?.length?n.createElement(a,{...t,actionHandler:e,actions:t.actions,id:t.id||"",text:t.text||""}):null;function V(e){const t={"--original-height":1e6,"--original-width":1e6};if(o.Bu(e,"url")){const a=new URL(e).searchParams,n=Number(a.get("oh")),s=Number(a.get("ow")),r=n>1?n:1e6,i=s>1?s:1e6;t["--original-width"]=i,t["--original-height"]=r}return t}const z=({attachment:e,Gallery:t=C.r})=>{const a=(0,n.useRef)([]),{imageAttachmentSizeHandler:s}=(0,R.JN)(),[r,i]=(0,n.useState)([]);(0,n.useLayoutEffect)((()=>{if(a.current&&a.current.every((e=>!!e))&&s){const t=[];a.current.forEach(((a,n)=>{const r=s(e.images[n],a);t.push(r)})),i(t)}}),[a,s,e]);const o=e.images.map(((t,a)=>({...t,previewUrl:r[a]?.url||"about:blank",style:V(e.images[a]?.image_url||e.images[a]?.thumb_url||"")})));return n.createElement(B,{attachment:e,componentType:"gallery"},n.createElement(t,{images:o||[],innerRefs:a,key:"gallery"}))},Z=e=>{const{attachment:t,Image:a=k}=e,s="image",r=(0,n.useRef)(null),{imageAttachmentSizeHandler:i}=(0,R.JN)(),[o,c]=(0,n.useState)(void 0);(0,n.useLayoutEffect)((()=>{if(r.current&&i){const e=i(t,r.current);c(e)}}),[r,i,t]);const l={...t,previewUrl:o?.url||"about:blank",style:V(t.image_url||t.thumb_url||"")};return t.actions&&t.actions.length?n.createElement(B,{attachment:t,componentType:s},n.createElement("div",{className:"str-chat__attachment"},n.createElement(a,{...l,innerRef:r}),n.createElement(U,{...e}))):n.createElement(B,{attachment:t,componentType:s},n.createElement(a,{...l,innerRef:r}))},W={audio:({attachment:e,Audio:t=f})=>n.createElement(B,{attachment:e,componentType:"audio"},n.createElement("div",{className:"str-chat__attachment"},n.createElement(t,{og:e}))),card:e=>{const{attachment:t,Card:a=j}=e,s="card";return t.actions&&t.actions.length?n.createElement(B,{attachment:t,componentType:s},n.createElement("div",{className:"str-chat__attachment"},n.createElement(a,{...t}),n.createElement(U,{...e}))):n.createElement(B,{attachment:t,componentType:s},n.createElement(a,{...t}))},file:({attachment:e,File:t=F})=>e.asset_url?n.createElement(B,{attachment:e,componentType:"file"},n.createElement(t,{attachment:e})):null,media:e=>{const{attachment:t,Media:a=r.Z}=e,s="media",{shouldGenerateVideoThumbnail:i,videoAttachmentSizeHandler:o}=(0,R.JN)(),c=(0,n.useRef)(null),[l,d]=(0,n.useState)();(0,n.useLayoutEffect)((()=>{if(c.current&&o){const e=o(t,c.current,i);d(e)}}),[c,o,t]);const u=n.createElement("div",{className:"str-chat__player-wrapper","data-testid":"video-wrapper",ref:c,style:V(t.thumb_url||"")},n.createElement(a,{className:"react-player",config:{file:{attributes:{poster:l?.thumbUrl}}},controls:!0,height:"100%",url:l?.url,width:"100%"}));return t.actions?.length?n.createElement(B,{attachment:t,componentType:s},n.createElement("div",{className:"str-chat__attachment"},u,n.createElement(U,{...e}))):n.createElement(B,{attachment:t,componentType:s},u)},unsupported:({attachment:e,UnsupportedAttachment:t=$})=>n.createElement(n.Fragment,null,n.createElement(t,{attachment:e})),voiceRecording:({attachment:e,VoiceRecording:t=M,isQuoted:a})=>n.createElement(B,{attachment:e,componentType:"voiceRecording"},n.createElement("div",{className:"str-chat__attachment"},n.createElement(t,{attachment:e,isQuoted:a})))},q=["card","gallery","image","media","audio","voiceRecording","file","unsupported"],G=e=>{const{attachments:t}=e,a=(0,n.useMemo)((()=>Q(e)),[t]);return n.createElement("div",{className:"str-chat__attachment-list"},q.reduce(((e,t)=>[...e,...a[t]]),[]))},Q=({attachments:e,...t})=>{const a=e.filter((e=>(0,s.bw)(e))),r=e.filter((e=>!(0,s.bw)(e))).reduce(((e,a)=>{const s=J(a),r=W[s];return e[s].push(n.createElement(r,{key:`${s}-${e[s].length}`,...t,attachment:a})),e}),{audio:[],card:[],file:[],media:[],unsupported:[],image:[],gallery:[],voiceRecording:[]});return a.length>1?r.gallery=[n.createElement(z,{key:"gallery-container",...t,attachment:{images:a,type:"gallery"}})]:1===a.length&&(r.image=[n.createElement(Z,{key:"image-container",...t,attachment:a[0]})]),r},J=e=>(0,s.VO)(e)?"card":(0,s.As)(e)?"media":(0,s.zf)(e)?"audio":(0,s.dG)(e)?"voiceRecording":(0,s.Vx)(e)?"file":"unsupported"},482613:function(e,t,a){"use strict";a.d(t,{me:function(){return r}});var n=a(432228),s=a(425108);const r=(e,t)=>e.length===t?e:e.length>t?function(e,t){if(e.length<=t||0===t)return e;if(1===t)return[c(e)];const a=[],n=(e.length-2)/(t-2);let s,r,d,u=0;a.push(e[u]);for(let c=1;c<t-1;c++){const t=e[u],m=l(e,c,n),g=Math.floor((c-1)*n)+1,h=Math.floor(c*n)+1,p=1+h-g;r=d=-1;for(let a=g;a<h;a++){const n=Math.abs(a-g)+1,c=p-n,l=e[a];d=i(o(Math.abs(t-l),n),o(Math.abs(l-m),c),o(Math.abs(t-m),p)),d>r&&(r=d,s=e[a],u=a)}void 0!==s&&a.push(s)}return a.push(e[e.length-1]),a}(e,t):d(e,t);const i=(e,t,a)=>{const n=(e+t+a)/2;return Math.sqrt(n*(n-e)*(n-t)*(n-a))},o=(e,t)=>Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),c=e=>e.reduce(((e,t)=>e+t),0)/e.length,l=(e,t,a)=>{const n=Math.floor(t*a)+1;let s=Math.floor((t+1)*a)+1;return s=s<e.length?s:e.length,c(e.slice(n,s))},d=(e,t)=>{if(!e.length)return s.warn("Cannot extend empty array of amplitudes."),e;if(e.length>t)return s.warn("Requested to extend the waveformData that is longer than the target list size"),e;if(t===e.length)return e;let[a,r]=(0,n.Cw)(t,e.length);const i=[];for(let t=0;t<e.length;t++){const n=r&&r--?1:0;i.push(...Array(a+n).fill(e[t]))}return i}},998250:function(e,t,a){"use strict";a.d(t,{o:function(){return i}});var n=a(667294),s=a(839129),r=a(675813);const i=({assetUrl:e})=>n.createElement(r.H,{className:"str-chat__message-attachment-file--item-download",download:!0,href:e,target:"_blank"},n.createElement(s._8,{className:"str-chat__message-attachment-download-icon"}))},822787:function(e,t,a){"use strict";a.d(t,{J:function(){return r}});var n=a(667294),s=a(839129);const r=({isPlaying:e,onClick:t})=>n.createElement("button",{className:"str-chat__message-attachment-audio-widget--play-button","data-testid":e?"pause-audio":"play-audio",onClick:t},e?n.createElement(s.fp,null):n.createElement(s.Kd,null))},90725:function(e,t,a){"use strict";a.d(t,{e:function(){return c}});var n=a(493096),s=a.n(n),r=a(667294),i=a(770149),o=a(482613);const c=({amplitudesCount:e=40,progress:t=0,relativeAmplitudeBarWidth:a=2,relativeAmplitudeGap:n=1,seek:c,waveformData:l})=>{const[d,u]=(0,r.useState)(null),m=(0,r.useRef)(!1),[g,h]=(0,r.useState)(null),[p,f]=(0,r.useState)(),_=(0,r.useRef)(),v=(0,r.useCallback)((()=>{d&&(m.current=!1,d.style.removeProperty("cursor"))}),[d]),y=(0,r.useMemo)((()=>s()((t=>{if(t===_.current)return;_.current=t;const s=Math.floor(t/(n+a)),r=s<e?s:e,i=r&&t/r*(a/(a+n));f({barCount:r,barWidth:i,gap:i*(n/a)})}),1)),[a,n,e]),E=(0,r.useMemo)((()=>p?(0,o.me)(l,p.barCount):[]),[p,l]);return(0,r.useEffect)((()=>(document.addEventListener("pointerup",v),()=>{document.removeEventListener("pointerup",v)})),[v]),(0,r.useEffect)((()=>{if(!g||"undefined"==typeof ResizeObserver)return;const e=new ResizeObserver((([e])=>{y(e.contentRect.width)}));return e.observe(g),()=>{e.disconnect()}}),[y,g]),(0,r.useLayoutEffect)((()=>{if(!g)return;const{width:e}=g.getBoundingClientRect();y(e)}),[y,g]),l.length&&0!==p?.barCount?r.createElement("div",{className:"str-chat__wave-progress-bar__track","data-testid":"wave-progress-bar-track",onClick:c,onPointerDown:e=>{e.preventDefault(),d&&(m.current=!0,d.style.cursor="grabbing")},onPointerMove:e=>{m.current&&c({...e})},onPointerUp:v,ref:h,role:"progressbar",style:{"--str-chat__voice-recording-amplitude-bar-gap-width":p?.gap+"px"}},E.map(((e,a)=>r.createElement("div",{className:(0,i.Z)("str-chat__wave-progress-bar__amplitude-bar",{"str-chat__wave-progress-bar__amplitude-bar--active":t>a/E.length*100}),"data-testid":"amplitude-bar",key:`amplitude-${a}`,style:{"--str-chat__voice-recording-amplitude-bar-width":p?.barWidth+"px","--str-chat__wave-progress-bar__amplitude-bar-height":e?100*e+"%":"0%"}}))),r.createElement("div",{className:"str-chat__wave-progress-bar__progress-indicator","data-testid":"wave-progress-bar-progress-indicator",ref:u,style:{left:`${t<0?0:t>100?100:t}%`}})):null}},309288:function(e,t,a){"use strict";a.d(t,{P:function(){return d}});var n=a(493096),s=a.n(n),r=a(667294),i=a(437495),o=a(21681),c=a(425108);const l=[1,1.5,2],d=({durationSeconds:e,mimeType:t,playbackRates:a=l}={})=>{const{addNotification:n}=(0,i.uz)("useAudioController"),{t:d}=(0,o.Ht)("useAudioController"),[u,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)(),[p,f]=(0,r.useState)(!0),[_,v]=(0,r.useState)(0),[y,E]=(0,r.useState)(0),w=(0,r.useRef)(),b=(0,r.useRef)(null),M=(0,r.useCallback)((e=>{(e=>{c.error("[AUDIO PLAYER]",e)})(e),h(e),n(e.message,"error")}),[n]),C=(0,r.useCallback)((async()=>{if(b.current){if(clearTimeout(w.current),w.current=void 0,t&&!b.current.canPlayType(t))return M(new Error(d("Recording format is not supported and cannot be reproduced"))),void f(!1);if(!(e=b.current)||e.paused||e.ended){w.current=setTimeout((()=>{if(b.current)try{b.current.pause(),m(!1)}catch(e){M(new Error(d("Failed to play the recording")))}}),2e3);try{await b.current.play(),m(!0)}catch(e){M(e),m(!1)}finally{clearTimeout(w.current),w.current=void 0}}else b.current.pause(),m(!1);var e}}),[t,M,d]),N=(0,r.useMemo)((()=>s()((({clientX:e,currentTarget:t})=>{if(!t||!b.current)return;if((a=b.current).duration===1/0||isNaN(a.duration))return void M(new Error(d("Cannot seek in the recording")));var a;const{width:n,x:s}=t.getBoundingClientRect(),r=(e-s)/n;if(r>1||r<0)return;const i=r*b.current.duration;v(i),b.current.currentTime=i}),16)),[M,d]);return(0,r.useEffect)((()=>{if(!b.current)return;const t=b.current,a=()=>{v(t?.duration??e??0),m(!1)};t.addEventListener("ended",a);const s=()=>{n(d("Error reproducing the recording"),"error"),m(!1)};t.addEventListener("error",s);const r=()=>{v(t?.currentTime)};return t.addEventListener("timeupdate",r),()=>{t.pause(),t.removeEventListener("ended",a),t.removeEventListener("error",s),t.removeEventListener("timeupdate",r)}}),[n,e,d]),{audioRef:b,canPlayRecord:p,increasePlaybackRate:()=>{E((e=>{if(!b.current)return e;const t=e===a.length-1?0:e+1;return b.current.playbackRate=a[t],t}))},isPlaying:u,playbackError:g,playbackRate:a[y],progress:b.current&&_?_/b.current.duration*100:0,secondsElapsed:_,seek:N,togglePlay:C}}},839129:function(e,t,a){"use strict";a.d(t,{Kd:function(){return r},_8:function(){return s},fp:function(){return i}});var n=a(667294);const s=({className:e})=>n.createElement("svg",{className:e,"data-testid":"download",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4C9.11 4 6.6 5.64 5.35 8.04C2.34 8.36 0 10.91 0 14C0 17.31 2.69 20 6 20H19C21.76 20 24 17.76 24 15C24 12.36 21.95 10.22 19.35 10.04ZM19 18H6C3.79 18 2 16.21 2 14C2 11.95 3.53 10.24 5.56 10.03L6.63 9.92L7.13 8.97C8.08 7.14 9.94 6 12 6C14.62 6 16.88 7.86 17.39 10.43L17.69 11.93L19.22 12.04C20.78 12.14 22 13.45 22 15C22 16.65 20.65 18 19 18ZM13.45 10H10.55V13H8L12 17L16 13H13.45V10Z",fill:"black"})),r=()=>n.createElement("svg",{fill:"none",viewBox:"0 0 12 14",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M0.5 0V14L11.5 7L0.5 0Z",fill:"#080707"})),i=()=>n.createElement("svg",{fill:"none",viewBox:"0 0 12 14",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M0 14H4V0H0V14ZM8 0V14H12V0H8Z",fill:"#080707"}))},432228:function(e,t,a){"use strict";a.d(t,{As:function(){return p},BE:function(){return c},Cw:function(){return v},EM:function(){return f},JO:function(){return m},SW:function(){return o},V8:function(){return d},VO:function(){return r},Vx:function(){return g},WV:function(){return _},a9:function(){return s},bw:function(){return i},dG:function(){return u},dp:function(){return y},es:function(){return h},zf:function(){return l}});const n=["video/mp4","video/ogg","video/webm","video/quicktime"],s=e=>!!e.localMetadata?.id,r=e=>e.og_scrape_url||e.title_link,i=e=>"image"===e.type&&!r(e),o=e=>i(e)&&s(e),c=e=>Array.isArray(e.images),l=e=>"audio"===e.type,d=e=>l(e)&&s(e),u=e=>"voiceRecording"===e.type,m=e=>u(e)&&s(e),g=e=>"file"===e.type||!(!e.mime_type||-1!==n.indexOf(e.mime_type)||"video"===e.type),h=e=>g(e)&&s(e),p=e=>e.mime_type&&-1!==n.indexOf(e.mime_type)||"video"===e.type,f=e=>p(e)&&s(e),_=e=>(e.fallback||"").toLowerCase().endsWith(".svg"),v=(e,t)=>[Math.floor(e/t),e%t],y=e=>{if(!e||e<0)return"00:00";const[t,a]=v(e,3600),[n,s]=v(a,60),r=Math.ceil(s),i=1===t.toString().length?"0":"",o=`${1===n.toString().length?"0":""}${n}:${1===r.toString().length?"0":""}${r}`;return t?`${i}${t}:`+o:o}},610602:function(e,t,a){"use strict";a.d(t,{K:function(){return E}});var n=a(667294),s=a(45697),r=a.n(s),i=a(490869),o=a(716496),c=a.n(o),l=a(693154),d=a(770149),u=a(540239);const m=n.forwardRef((function(e,t){const{className:a,component:s,item:r,onClickHandler:i,onSelectHandler:o,selected:c,style:l}=e,u=(0,n.useCallback)((()=>o(r)),[r,o]),m=(0,n.useCallback)((e=>i(e,r)),[r,i]);return n.createElement("li",{className:(0,d.Z)(a,{"str-chat__suggestion-item--selected":c}),style:l},n.createElement("a",{href:"",onClick:m,onFocus:u,onMouseEnter:u,ref:t},n.createElement(s,{entity:r,selected:c})))}));var g=a(329688);const h=({className:e,component:t,currentTrigger:a,dropdownScroll:s,getSelectedItem:r,getTextToReplace:i,itemClassName:o,itemStyle:c,onSelect:l,selectionEnd:h,style:p,SuggestionItem:f,value:_,values:v})=>{const{AutocompleteSuggestionItem:y}=(0,u.yM)("SuggestionList"),E=f||y||m,[w,b]=(0,n.useState)(void 0),M=[],C=e=>w===v.findIndex((t=>N(t)===N(e))),N=e=>{const t=i(e);return t.key?t.key:"string"!=typeof e&&e.key?e.key:t.text},S=(0,n.useCallback)((e=>v.findIndex((t=>t.id?t.id===e.id:t.name===e.name))),[v]),T=e=>{e&&(l(i(e)),r&&r(e))},x=(0,n.useCallback)(((e,t)=>{e?.preventDefault();const a=S(t);T(v[a])}),[T,S]),P=(0,n.useCallback)((e=>{const t=S(e);b(t)}),[S]),k=(0,n.useCallback)((e=>("ArrowUp"===e.key&&b((e=>{if(void 0===e)return 0;const t=0===e?v.length-1:e-1;return s(M[t]),t})),"ArrowDown"===e.key&&b((e=>{if(void 0===e)return 0;const t=e===v.length-1?0:e+1;return s(M[t]),t})),"Enter"!==e.key&&"Tab"!==e.key||void 0===w||x(e,v[w]),null)),[w,v]);(0,n.useEffect)((()=>(document.addEventListener("keydown",k,!1),()=>document.removeEventListener("keydown",k))),[k]),(0,n.useEffect)((()=>{v?.length&&P(v[0])}),[v]);const L=(0,n.useCallback)((e=>{const t=e.name||e.id,n=_.slice(0,h),s=n.lastIndexOf(a),r=(0,g.hr)(n.slice(s+1)),i={match:r,parts:t.split(new RegExp(`(${r})`,"gi"))};return{...e,itemNameParts:i}}),[_,h,a]),R=(0,n.useMemo)((()=>v.map(L)),[v,L]);return n.createElement("ul",{className:(0,d.Z)("str-chat__suggestion-list",e),style:p},R.map(((e,a)=>n.createElement(E,{className:o,component:t,item:e,key:N(e),onClickHandler:x,onSelectHandler:P,ref:e=>{M[a]=e},selected:C(e),style:c,value:_}))))};var p=a(425108);const f="next";var _=a(516164),v=a(109509),y=a(96895);class E extends n.Component{constructor(e){super(e),this.getSelectionPosition=()=>this.textareaRef?{selectionEnd:this.textareaRef.selectionEnd,selectionStart:this.textareaRef.selectionStart}:null,this.getSelectedText=()=>{if(!this.textareaRef)return null;const{selectionEnd:e,selectionStart:t}=this.textareaRef;return t===e?null:this.state.value.substr(t,e-t)},this.setCaretPosition=(e=0)=>{this.textareaRef&&(this.textareaRef.focus(),this.textareaRef.setSelectionRange(e,e))},this.getCaretPosition=()=>this.textareaRef?this.textareaRef.selectionEnd:0,this._defaultShouldSubmit=e=>"Enter"===e.key&&!e.shiftKey&&!e.nativeEvent.isComposing,this._handleKeyDown=e=>{const{shouldSubmit:t=this._defaultShouldSubmit}=this.props;return"ArrowUp"!==e.key&&"ArrowDown"!==e.key||!this.dropdownRef||e.preventDefault(),t?.(e)?this._onEnter(e):" "===e.key?this._onSpace(e):"Escape"===e.key?this._closeAutocomplete():void 0},this._onEnter=async e=>{if(!this.textareaRef)return;this.state.currentTrigger&&this.state.data||(e.persist(),await this._replaceWord(),this.textareaRef&&(this.textareaRef.selectionEnd=0),this.props.handleSubmit(e),this._closeAutocomplete())},this._onSpace=()=>{if(!this.props.replaceWord||!this.textareaRef)return;this.textareaRef.matches(":focus")&&this._replaceWord()},this._replaceWord=async()=>{const{value:e}=this.state,t=/([^\s]+)(\s*)$/.exec(e.slice(0,this.getCaretPosition())),a=t&&t[1];if(!a)return;const n=t[2],s=await this.props.replaceWord(a);if(null==s)return;const r=e.slice(0,this.getCaretPosition()-t[0].length)+s+n+e.slice(this.getCaretPosition(),-1);this.setState({value:r},(()=>{const e=new CustomEvent("change",{bubbles:!0});this.textareaRef.dispatchEvent(e),this.props.onChange&&this.props.onChange(e)}))},this._onSelect=e=>{const{closeCommandsList:t,closeMentionsList:a,onChange:n,showCommandsList:s,showMentionsList:r}=this.props,{currentTrigger:i,selectionEnd:o,value:c}=this.state,l=s?"/":r?"@":i;if(!l)return;const d=s?"/":r?"@":c.slice(0,o),u=d.lastIndexOf(l),m="next"===e.caretPosition?`${e.text} `:e.text,g=((e,t,a)=>{switch(e){case"start":return a;case"next":case"end":return a+t.length;default:if(!Number.isInteger(e))throw new Error('RTA: caretPosition should be "start", "next", "end" or number.');return e}})(e.caretPosition,m,u),h=d.substring(0,u)+m,p=c.replace(d,h);this.setState({dataLoading:!1,value:p},(()=>{const e=new CustomEvent("change",{bubbles:!0});this.textareaRef.dispatchEvent(e),n&&n(e),this.setCaretPosition(g)})),this._closeAutocomplete(),s&&t(),r&&a()},this._getItemOnSelect=e=>{const{currentTrigger:t}=this.state,a=this._getCurrentTriggerSettings(e),n=e||t;if(!n||!a)return null;const{callback:s}=a;return s?e=>{if("function"!=typeof s)throw new Error('Output functor is not defined! You have to define "output" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type');return s?s(e,n):null}:null},this._getTextToReplace=e=>{const{actualToken:t,currentTrigger:a}=this.state,n=this._getCurrentTriggerSettings(e),s=e||a;if(!s||!n)return null;const{output:r}=n;return e=>{if("object"==typeof e&&(!r||"function"!=typeof r))throw new Error('Output functor is not defined! If you are using items as object you have to define "output" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type');if(r){const a=r(e,s);if(!a||"number"==typeof a)throw new Error(`Output functor should return string or object in shape {text: string, caretPosition: string | number}.\nGot "${String(a)}". Check the implementation for trigger "${s}" and its token "${t}"\n\nSee https://github.com/webscopeio/react-textarea-autocomplete#trigger-type for more informations.\n`);if("string"==typeof a)return{caretPosition:f,text:a};if(!a.text&&":"!==s)throw new Error(`Output "text" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger "${s}" and its token "${t}"\n`);if(!a.caretPosition)throw new Error(`Output "caretPosition" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger "${s}" and its token "${t}"\n`);return a}if("string"!=typeof e)throw new Error("Output item should be string\n");return{caretPosition:f,text:`${s}${e}${s}`}}},this._getCurrentTriggerSettings=e=>{const{currentTrigger:t}=this.state,a=e||t;return a?this.props.trigger[a]:null},this._getValuesFromProvider=()=>{const{actualToken:e,currentTrigger:t}=this.state,a=this._getCurrentTriggerSettings();if(!t||!a)return;const{component:n,dataProvider:s}=a;if("function"!=typeof s)throw new Error("Trigger provider has to be a function!");this.setState({dataLoading:!0}),s(e,this.state.value,((e,a)=>{if(a===this.state.actualToken){if(!Array.isArray(e))throw new Error("Trigger provider has to provide an array!");if(!(0,l.isValidElementType)(n))throw new Error("Component should be defined!");t===this.state.currentTrigger&&(e.length?this.setState({component:n,data:e,dataLoading:!1}):this._closeAutocomplete())}}))},this._getSuggestions=e=>{const{currentTrigger:t,data:a}=this.state;return!(e||t)||!a||a&&!a.length?null:a},this._closeAutocomplete=()=>{this.setState({currentTrigger:null,data:null,dataLoading:!1,left:null,top:null})},this._cleanUpProps=()=>{const e={...this.props},t=["additionalTextareaProps","className","closeCommandsList","closeMentionsList","closeOnClickOutside","containerClassName","containerStyle","disableMentions","dropdownClassName","dropdownStyle","grow","handleSubmit","innerRef","itemClassName","itemStyle","listClassName","listStyle","loaderClassName","loaderStyle","loadingComponent","minChar","movePopupAsYouType","onCaretPositionChange","onChange","ref","replaceWord","scrollToItem","shouldSubmit","showCommandsList","showMentionsList","SuggestionItem","SuggestionList","trigger","value"];for(const a in e)t.includes(a)&&delete e[a];return e},this._isCommand=e=>{if("/"!==e[0])return!1;return e.split(" ").length<=1},this._changeHandler=e=>{const{minChar:t,movePopupAsYouType:a,onCaretPositionChange:n,onChange:s,trigger:r}=this.props,{left:i,top:o}=this.state,l=e.target,{selectionEnd:d,selectionStart:u,value:m}=l;let g,h;if(s&&(e.persist(),s(e)),n&&n(this.getCaretPosition()),this.setState({value:m}),this._isCommand(m))g="/",h=m;else{const e=Object.keys(r).join().replace("/",""),t=`[^\\s${e}]*`,a=new RegExp(`(?!^|\\W)?[${e}]${t}\\s?${t}$`,"g"),n=m.slice(0,d).match(a);h=n&&n[n.length-1].trim(),g=h&&Object.keys(r).find((e=>e===h[0]))||null}if(!h||h.length<=t)return void this._closeAutocomplete();const f=h.slice(1);if(g){if(a||null===o&&null===i||1===h.length){const{left:e,top:t}=c()(l,d);this.setState({left:e,top:t-this.textareaRef.scrollTop||0})}this.setState({actualToken:f,currentTrigger:g,selectionEnd:d,selectionStart:u},(()=>{try{this._getValuesFromProvider()}catch(t){e=t.message,p.error(`RTA: dataProvider fails: ${e}\n    \nCheck the documentation or create issue if you think it's bug. https://github.com/webscopeio/react-textarea-autocomplete/issues`)}var e}))}},this._selectHandler=e=>{const{onCaretPositionChange:t,onSelect:a}=this.props;t&&t(this.getCaretPosition()),a&&(e.persist(),a(e))},this._onClickAndBlurHandler=e=>{const{closeOnClickOutside:t,onBlur:a}=this.props,n=e.relatedTarget,s=(0,y.G)()&&"blur"===e.type;this.dropdownRef&&n instanceof Node&&this.dropdownRef.contains(n)||s||(t&&this._closeAutocomplete(),a&&(e.persist(),a(e)))},this._onScrollHandler=()=>this._closeAutocomplete(),this._dropdownScroll=e=>{const{scrollToItem:t}=this.props;if(t)if(!0!==t){if("function"!=typeof t||2!==t.length)throw new Error("`scrollToItem` has to be boolean (true for default implementation) or function with two parameters: container, item.");t(this.dropdownRef,e)}else!function(e,t){if(!t)return;const a=parseInt(getComputedStyle(t).getPropertyValue("height"),10),n=parseInt(getComputedStyle(e).getPropertyValue("height"),10)-a,s=e.scrollTop,r=t.offsetTop;r<s+n&&s<r||(e.scrollTop=r)}(this.dropdownRef,e)},this.getTriggerProps=()=>{const{showCommandsList:e,showMentionsList:t,trigger:a}=this.props,{component:n,currentTrigger:s,selectionEnd:r,value:i}=this.state,o=this._getItemOnSelect(),c=this._getSuggestions(),l={component:n,currentTrigger:s,getSelectedItem:o,getTextToReplace:this._getTextToReplace(),selectionEnd:r,value:i,values:c};if(e&&a["/"]||t&&a["@"]){let t;const n=a[e?"/":"@"].dataProvider;n?.("",e?"/":"@",(e=>{t=e})),l.component=e?_.d:v.E,l.currentTrigger=e?"/":"@",l.getTextToReplace=this._getTextToReplace(e?"/":"@"),l.getSelectedItem=this._getItemOnSelect(e?"/":"@"),l.selectionEnd=1,l.value=e?"/":"@",l.values=t}return l},this.setDropdownRef=e=>{this.dropdownRef=e};const{loadingComponent:t,trigger:a,value:n}=this.props;if(!t)throw new Error("RTA: loadingComponent is not defined");if(!a)throw new Error("RTA: trigger is not defined");this.state={actualToken:"",component:null,currentTrigger:null,data:null,dataLoading:!1,isComposing:!1,left:null,selectionEnd:0,selectionStart:0,top:null,value:n||""}}static getDerivedStateFromProps(e,t){return e.value===t.propsValue&&t.value?null:{propsValue:e.value,value:e.value}}renderSuggestionListContainer(){const{disableMentions:e,dropdownClassName:t,dropdownStyle:a,itemClassName:s,itemStyle:r,listClassName:i,SuggestionItem:o,SuggestionList:c=h}=this.props,{isComposing:l}=this.state,u=this.getTriggerProps();return l||!u.values||!u.currentTrigger||e&&"@"===u.currentTrigger?null:n.createElement("div",{className:(0,d.Z)("str-chat__suggestion-list-container",t),ref:this.setDropdownRef,style:a},n.createElement(c,{className:i,dropdownScroll:this._dropdownScroll,itemClassName:(0,d.Z)("str-chat__suggestion-list-item",s),itemStyle:r,onSelect:this._onSelect,SuggestionItem:o,...u}))}render(){const{className:e,containerClassName:t,containerStyle:a,style:s}=this.props,{onBlur:r,onChange:o,onClick:c,onFocus:l,onKeyDown:u,onScroll:m,onSelect:g,...h}=this.props.additionalTextareaProps||{};let{maxRows:p}=this.props;const{dataLoading:f,value:_}=this.state;return this.props.grow||(p=1),n.createElement("div",{className:(0,d.Z)("rta",t,{"rta--loading":f}),style:a},this.renderSuggestionListContainer(),n.createElement(i.Z,{"data-testid":"message-input",...this._cleanUpProps(),className:(0,d.Z)("rta__textarea",e),maxRows:p,onBlur:e=>{this._onClickAndBlurHandler(e),r?.(e)},onChange:e=>{this._changeHandler(e),o?.(e)},onClick:e=>{this._onClickAndBlurHandler(e),c?.(e)},onCompositionEnd:()=>this.setState((e=>({...e,isComposing:!1}))),onCompositionStart:()=>this.setState((e=>({...e,isComposing:!0}))),onFocus:e=>{this.props.onFocus?.(e),l?.(e)},onKeyDown:e=>{this._handleKeyDown(e),u?.(e)},onScroll:e=>{this._onScrollHandler(e),m?.(e)},onSelect:e=>{this._selectHandler(e),g?.(e)},ref:e=>{this.props?.innerRef(e),this.textareaRef=e},style:s,value:_,...h,defaultValue:void 0}))}}E.defaultProps={closeOnClickOutside:!0,maxRows:10,minChar:1,movePopupAsYouType:!1,scrollToItem:!0,value:""},E.propTypes={className:r().string,closeOnClickOutside:r().bool,containerClassName:r().string,containerStyle:r().object,disableMentions:r().bool,dropdownClassName:r().string,dropdownStyle:r().object,itemClassName:r().string,itemStyle:r().object,listClassName:r().string,listStyle:r().object,loaderClassName:r().string,loaderStyle:r().object,loadingComponent:r().elementType,minChar:r().number,onBlur:r().func,onCaretPositionChange:r().func,onChange:r().func,onSelect:r().func,shouldSubmit:r().func,style:r().object,SuggestionList:r().elementType,trigger:({trigger:e})=>{if(!e)return Error("Invalid prop trigger. Prop missing.");const t=Object.entries(e);for(let e=0;e<t.length;e+=1){const[a,n]=t[e];if("string"!=typeof a||1!==a.length)return Error("Invalid prop trigger. Keys of the object has to be string / one character.");const s=n,{callback:r,component:i,dataProvider:o,output:c}=s;if(!(0,l.isValidElementType)(i))return Error("Invalid prop trigger: component should be defined.");if(!o||"function"!=typeof o)return Error("Invalid prop trigger: dataProvider should be defined.");if(c&&"function"!=typeof c)return Error("Invalid prop trigger: output should be a function.");if(r&&"function"!=typeof r)return Error("Invalid prop trigger: callback should be a function.")}return null},value:r().string}},613943:function(e,t,a){"use strict";a.d(t,{q:function(){return o}});var n=a(770149),s=a(667294),r=a(363678),i=a(406175);const o=e=>{const{className:t,image:a,name:o,onClick:c=(()=>{}),onMouseOver:l=(()=>{})}=e,[d,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{u(!1)}),[a]);const m=o?.toString()||"",g=(0,i.X)(m,0),h=a&&!d;return s.createElement("div",{className:(0,n.Z)("str-chat__avatar str-chat__message-sender-avatar",t,{"str-chat__avatar--multiple-letters":g.length>1,"str-chat__avatar--no-letters":!g.length,"str-chat__avatar--one-letter":1===g.length}),"data-testid":"avatar",onClick:c,onMouseOver:l,role:"button",title:o},h?s.createElement("img",{alt:g,className:"str-chat__avatar-image","data-testid":"avatar-img",onError:()=>u(!0),src:a}):s.createElement(s.Fragment,null,!!g.length&&s.createElement("div",{className:(0,n.Z)("str-chat__avatar-fallback"),"data-testid":"avatar-fallback"},g),!g.length&&s.createElement(r.J.User,null)))}},427225:function(e,t,a){"use strict";a.d(t,{$:function(){return G}});var n=a(667294),s=a(691296),r=a.n(s),i=a(892098),o=a.n(i),c=a(493096),l=a.n(c),d=a(900373),u=a(770149);const m=(e,t)=>{switch(t.type){case"closeThread":return{...e,thread:null,threadLoadingMore:!1,threadMessages:[]};case"copyMessagesFromChannel":{const{channel:a,parentId:n}=t;return{...e,messages:[...a.state.messages],pinnedMessages:[...a.state.pinnedMessages],suppressAutoscroll:!1,threadMessages:n?{...a.state.threads}[n]||[]:e.threadMessages}}case"copyStateFromChannelOnEvent":{const{channel:a}=t;return{...e,members:{...a.state.members},messages:[...a.state.messages],pinnedMessages:[...a.state.pinnedMessages],read:{...a.state.read},watcherCount:a.state.watcher_count,watchers:{...a.state.watchers}}}case"initStateFromChannel":{const{channel:a,hasMore:n}=t;return{...e,hasMore:n,loading:!1,members:{...a.state.members},messages:[...a.state.messages],pinnedMessages:[...a.state.pinnedMessages],read:{...a.state.read},watcherCount:a.state.watcher_count,watchers:{...a.state.watchers}}}case"jumpToLatestMessage":return{...e,hasMoreNewer:!1,highlightedMessageId:void 0,loading:!1,suppressAutoscroll:!1};case"jumpToMessageFinished":return{...e,hasMoreNewer:t.hasMoreNewer,highlightedMessageId:t.highlightedMessageId};case"clearHighlightedMessage":return{...e,highlightedMessageId:void 0};case"loadMoreFinished":{const{hasMore:a,messages:n}=t;return{...e,hasMore:a,loadingMore:!1,messages:n,suppressAutoscroll:!1}}case"loadMoreNewerFinished":{const{hasMoreNewer:a,messages:n}=t;return{...e,hasMoreNewer:a,loadingMoreNewer:!1,messages:n}}case"loadMoreThreadFinished":{const{threadHasMore:a,threadMessages:n}=t;return{...e,threadHasMore:a,threadLoadingMore:!1,threadMessages:n}}case"openThread":{const{channel:a,message:n}=t;return{...e,thread:n,threadHasMore:!0,threadMessages:n.id&&{...a.state.threads}[n.id]||[],threadSuppressAutoscroll:!1}}case"setError":{const{error:a}=t;return{...e,error:a}}case"setLoadingMore":{const{loadingMore:a}=t;return{...e,loadingMore:a,suppressAutoscroll:a}}case"setLoadingMoreNewer":{const{loadingMoreNewer:a}=t;return{...e,loadingMoreNewer:a}}case"setThread":{const{message:a}=t;return{...e,thread:a}}case"setTyping":{const{channel:a}=t;return{...e,typing:{...a.state.typing}}}case"startLoadingThread":return{...e,threadLoadingMore:!0,threadSuppressAutoscroll:!0};case"updateThreadOnEvent":{const{channel:a,message:n}=t;return e.thread?{...e,thread:n?.id===e.thread.id?a.state.formatMessage(n):e.thread,threadMessages:e.thread?.id&&{...a.state.threads}[e.thread.id]||[]}:e}default:return e}},g={error:null,hasMore:!0,hasMoreNewer:!1,loading:!0,loadingMore:!1,members:{},messages:[],pinnedMessages:[],read:{},suppressAutoscroll:!1,thread:null,threadHasMore:!0,threadLoadingMore:!1,threadMessages:[],threadSuppressAutoscroll:!1,typing:{},watcherCount:0,watchers:{}};var h=a(766722);var p=a(983156);var f=a(21681);const _=n.memo((({error:e})=>{const{t:t}=(0,f.Ht)("LoadingErrorIndicator");return e?n.createElement("div",null,t("Error: {{ errorMessage }}",{errorMessage:e.message})):null}),((e,t)=>e.error?.message===t.error?.message)),v=()=>n.createElement("div",{className:"str-chat__loading-channel-message"},n.createElement("div",{className:"str-chat__loading-channel-message-avatar"}),n.createElement("div",{className:"str-chat__loading-channel-message-end"},n.createElement("div",{className:"str-chat__loading-channel-message-sender"}),n.createElement("div",{className:"str-chat__loading-channel-message-last-row"},n.createElement("div",{className:"str-chat__loading-channel-message-text"}),n.createElement("div",{className:"str-chat__loading-channel-message-date"})))),y=()=>n.createElement("div",{className:"str-chat__loading-channel-message-input-row"},n.createElement("div",{className:"str-chat__loading-channel-message-input"}),n.createElement("div",{className:"str-chat__loading-channel-message-send"})),E=()=>n.createElement("div",{className:"str-chat__loading-channel-header"},n.createElement("div",{className:"str-chat__loading-channel-header-avatar"}),n.createElement("div",{className:"str-chat__loading-channel-header-end"},n.createElement("div",{className:"str-chat__loading-channel-header-name"}),n.createElement("div",{className:"str-chat__loading-channel-header-info"}))),w=()=>n.createElement("div",{className:"str-chat__loading-channel"},n.createElement(E,null),n.createElement("div",{className:"str-chat__loading-channel-message-list"},Array.from(Array(3)).map(((e,t)=>n.createElement(v,{key:`loading-message-${t}`})))),n.createElement(y,null));var b=a(368493),M=a(387029),C=a(437495),N=a(219140),S=a(561687),T=a(345853),x=a(25297);const P=()=>{const{useImageFlagEmojisOnWindows:e}=(0,p.mx)("Channel");return e&&navigator.userAgent.match(/Win/)?"str-chat--windows-flags":""},k=e=>e??"str-chat__container",L=(e,t)=>{for(let a=t.length-1;a>=0;a--){const n=t[a];if(n.id===e)return{index:a,target:n}}return{index:-1}},R=(e,t,a=!1)=>{const n=e.getTime();let s=0,r=0,i=t.length-1;for(;s<=i;){r=Math.floor((i+s)/2);const e=new Date(t[r].created_at).getTime(),a=t[r-1]?.created_at&&new Date(t[r-1].created_at).getTime(),o=t[r+1]?.created_at&&new Date(t[r+1].created_at).getTime();if(e===n||a&&o&&a<n&&n<o)return{index:r,target:t[r]};e<n?s=r+1:i=r-1}return a&&new Date(t[s].created_at).getTime()!==n?{index:-1}:{index:s,target:t[s]}};var I=a(788041),A=a(565155),O=a(425108);const D=(e,t)=>{let a;const n=e.image_url||e.thumb_url||"";if(A.Bu(n,"url")){const e=new URL(n),s=j(e,t);s&&(s.height*=2,s.width*=2,U(s,e)),a=e.href}return{url:a||""}},H=(e,t,a)=>{let n;if(e.thumb_url&&a&&A.Bu(e.thumb_url,"url")){const a=new URL(e.thumb_url),s=j(a,t);s&&(s.height*=2,s.width*=2,U(s,a)),n=a.href}return{thumbUrl:n,url:e.asset_url||""}},j=(e,t)=>{const a=e.searchParams,n=Number(a.get("oh"))||1,s=Number(a.get("ow"))||1,r=$(t);let i;return i=(r.maxHeight||r.height)&&r.maxWidth?F(n,s,r.maxHeight||r.height,r.maxWidth):void 0,i},F=(e,t,a,n)=>({height:Math.round(Math.max(a,n/t*e)),width:Math.round(Math.max(a,n/e*t))}),$=e=>{const t=getComputedStyle(e),a=B(t.getPropertyValue("height")),n=B(t.getPropertyValue("max-height")),s=B(t.getPropertyValue("max-width"));return(a||n)&&s||O.warn("Invalid value set for height/max-height and/or max-width for HTML element, this can cause scrolling issues inside the message list, more info https://getstream.io/chat/docs/sdk/react/message-components/attachment/#image-and-video-sizing"),{height:a,maxHeight:n,maxWidth:s}},B=e=>{if(!e.endsWith("px"))return;const t=parseFloat(e);return isNaN(t)?void 0:t},U=(e,t)=>{t.searchParams.set("h",e.height.toString()),t.searchParams.set("w",e.width.toString())};var V=a(636791),z=a(771762),Z=a(425108);const W=({children:e,className:t,...a})=>{const{customClasses:s,theme:r}=(0,p.mx)("Channel"),{channelClass:i,chatClass:o}=(({customClasses:e})=>{const t=P();return{channelClass:e?.channel??"str-chat__channel",chatClass:e?.chat??"str-chat",chatContainerClass:k(e?.chatContainer),windowsEmojiClass:t}})({customClasses:s}),c=(0,u.Z)(o,r,i,t);return n.createElement("div",{id:z.l,...a,className:c},e)},q=e=>{const{acceptedFiles:t,activeUnreadHandler:a,channel:s,channelQueryOptions:i,children:c,doDeleteMessageRequest:u,doMarkReadRequest:v,doSendMessageRequest:y,doUpdateMessageRequest:E,dragAndDropWindow:A=!1,enrichURLForPreviewConfig:O,initializeOnMount:j=!0,LoadingErrorIndicator:F=_,LoadingIndicator:$=w,markReadOnMount:B=!0,maxNumberOfFiles:U,multipleUploads:z=!0,onMentionsClick:q,onMentionsHover:G,optionalMessageInputProps:Q={},skipMessageDataMemoization:J}=e,K=(0,n.useMemo)((()=>o()(i,{messages:{limit:T.eW}})),[i]),{client:Y,customClasses:X,latestMessageDatesByChannels:ee,mutes:te}=(0,p.mx)("Channel"),{t:ae}=(0,f.Ht)("Channel"),ne=k(X?.chatContainer),se=P(),re=(0,V.io)(),[ie,oe]=(0,n.useState)(s.getConfig()),[ce,le]=(0,n.useState)([]),[de,ue]=(0,n.useState)(),[me,ge]=(0,n.useState)(),he=(0,n.useRef)([]),[pe,fe]=(0,n.useReducer)(m,{...g,hasMore:s.state.messagePagination.hasPrev,loading:!s.initialized}),_e=(()=>{const e=(0,n.useRef)(!1);return(0,n.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),e})(),ve=(0,n.useRef)(""),ye=(0,n.useRef)(),Ee=(0,n.useRef)(!0),we=s.data?.own_capabilities,be=l()((()=>fe({channel:s,type:"copyStateFromChannelOnEvent"})),500,{leading:!0,trailing:!0}),Me=(0,n.useMemo)((()=>l()(ge,200,{leading:!0,trailing:!1})),[]),Ce=(0,n.useMemo)((()=>l()((async e=>{const{updateChannelUiUnreadState:t=!0}=e??{};if(!s.disconnected&&ie?.read_events){ye.current=new Date;try{if(v)v(s,t?Me:void 0);else{const e=await s.markRead();t&&e&&ge({last_read:ye.current,last_read_message_id:e.event.last_read_message_id,unread_messages:0})}a?a(0,ve.current):ve.current&&(document.title=ve.current)}catch(e){Z.error(ae("Failed to mark channel as read"))}}}),500,{leading:!0,trailing:!1})),[a,s,ie,v,Me,ae]),Ne=async e=>{if(e.message&&fe({channel:s,message:e.message,type:"updateThreadOnEvent"}),"user.watching.start"!==e.type&&"user.watching.stop"!==e.type){if("typing.start"===e.type||"typing.stop"===e.type)return fe({channel:s,type:"setTyping"});if("connection.changed"===e.type&&"boolean"==typeof e.online&&(Ee.current=e.online),"message.new"===e.type){if((!e.message?.parent_id||e.message?.show_in_channel)&&document.hidden&&ie?.read_events&&!s.muteStatus().muted){const e=s.countUnread(ye.current);a?a(e,ve.current):document.title=`(${e}) ${ve.current}`}if(e.message?.user?.id===Y.userID&&e?.message?.created_at&&e?.message?.cid){const t=new Date(e.message.created_at),a=e.message.cid;(!ee[a]||ee[a].getTime()<t.getTime())&&(ee[a]=t)}}if("user.deleted"===e.type){const e=s.state?.messages?.[0]?.id;await s.query({messages:{id_lt:e,limit:T.cE},watchers:{limit:T.cE}})}"notification.mark_unread"===e.type&&ge((t=>e.last_read_at&&e.user?{first_unread_message_id:e.first_unread_message_id,last_read:new Date(e.last_read_at),last_read_message_id:e.last_read_message_id,unread_messages:e.unread_messages??0}:t)),"channel.truncated"===e.type&&e.cid===s.cid&&ge(void 0),be()}};(0,n.useLayoutEffect)((()=>{let e=!1,t=!1;(async()=>{if(!s.initialized&&j)try{const e=[];if(!s.id&&s.data?.members)for(const t of s.data.members){let a;if("string"==typeof t)a=t;else if("object"==typeof t){const{user:e,user_id:n}=t;a=n||e?.id}a&&e.push(a)}await(0,I.m)({channel:s,client:Y,members:e,options:K});const t=s.getConfig();oe(t)}catch(t){fe({error:t,type:"setError"}),e=!0}if(t=!0,ve.current=document.title,!e){if(fe({channel:s,hasMore:s.state.messagePagination.hasPrev,type:"initStateFromChannel"}),Y.user?.id&&s.state.read[Y.user.id]){const{user:e,...t}=s.state.read[Y.user.id];ge(t)}s.countUnread()>0&&B&&Ce({updateChannelUiUnreadState:!1}),Y.on("connection.changed",Ne),Y.on("connection.recovered",Ne),Y.on("user.updated",Ne),Y.on("user.deleted",Ne),s.on(Ne)}})();const a=he.current;return()=>{!e&&t&&(s?.off(Ne),Y.off("connection.changed",Ne),Y.off("connection.recovered",Ne),Y.off("user.deleted",Ne),a.forEach(clearTimeout))}}),[s.cid,K,v,ie?.read_events,j]),(0,n.useEffect)((()=>{if(!pe.thread)return;const e=pe.messages?.find((e=>e.id===pe.thread?.id));e&&fe({message:e,type:"setThread"})}),[pe.messages,pe.thread]);const Se=(0,n.useMemo)((()=>((e,t)=>(a,n)=>{if("string"!=typeof a||"success"!==n&&"error"!==n)return;const s=(0,d.x0)();e((e=>[...e,{id:s,text:a,type:n}]));const r=setTimeout((()=>e((e=>e.filter((e=>e.id!==s))))),5e3);t.push(r)})(le,he.current)),[]),Te=(0,n.useCallback)(r()(((e,t)=>{_e.current&&fe({hasMore:e,messages:t,type:"loadMoreFinished"})}),2e3,{leading:!0,trailing:!0}),[]),xe=async(e=T.cE)=>{if(!Ee.current||!window.navigator.onLine||!s.state.messagePagination.hasPrev)return 0;const t=pe?.messages?.[0];if(pe.loadingMore||pe.loadingMoreNewer||"received"!==t?.status)return 0;fe({loadingMore:!0,type:"setLoadingMore"});const a=t?.id,n=e;let r;try{r=await s.query({messages:{id_lt:a,limit:n},watchers:{limit:n}})}catch(e){return Z.warn("message pagination request failed with error",e),fe({loadingMore:!1,type:"setLoadingMore"}),0}return Te(s.state.messagePagination.hasPrev,s.state.messages),r.messages.length},Pe=async(e=T.cE)=>{if(!Ee.current||!window.navigator.onLine||!s.state.messagePagination.hasNext)return 0;const t=pe?.messages?.[pe?.messages?.length-1];if(pe.loadingMore||pe.loadingMoreNewer)return 0;fe({loadingMoreNewer:!0,type:"setLoadingMoreNewer"});const a=t?.id,n=e;let r;try{r=await s.query({messages:{id_gt:a,limit:n},watchers:{limit:n}})}catch(e){return Z.warn("message pagination request failed with error",e),fe({loadingMoreNewer:!1,type:"setLoadingMoreNewer"}),0}return fe({hasMoreNewer:s.state.messagePagination.hasNext,messages:s.state.messages,type:"loadMoreNewerFinished"}),r.messages.length},ke=(0,n.useRef)(null),Le=(0,n.useCallback)((async(e,t=T.Do,a=T.Tt)=>{fe({loadingMore:!0,type:"setLoadingMore"}),await s.state.loadMessageIntoState(e,void 0,t),Te(s.state.messagePagination.hasPrev,s.state.messages),fe({hasMoreNewer:s.state.messagePagination.hasNext,highlightedMessageId:e,type:"jumpToMessageFinished"}),ke.current&&clearTimeout(ke.current),ke.current=setTimeout((()=>{ke.current=null,fe({type:"clearHighlightedMessage"})}),a)}),[s,Te]),Re=(0,n.useCallback)((async()=>{await s.state.loadMessageIntoState("latest"),Te(s.state.messagePagination.hasPrev,s.state.messages),fe({type:"jumpToLatestMessage"})}),[s,Te]),Ie=(0,n.useCallback)((async(e=T.Do,t=T.Tt)=>{if(!me?.unread_messages)return;let a=me?.last_read_message_id,n=me?.first_unread_message_id,r=!1;if(n){r=-1!==L(n,s.state.messages).index}else if(a){const e=L(a,s.state.messages);r=!!e.target,n=e.index>-1?s.state.messages[e.index+1]?.id:void 0}else{const t=me.last_read.getTime(),{index:i,target:o}=R(me.last_read,s.state.messages,!0);if(o)n=s.state.messages[i+1]?.id,r=!!n,a=o.id;else{let r;fe({loadingMore:!0,type:"setLoadingMore"});try{r=(await s.query({messages:{created_at_around:me.last_read.toISOString(),limit:e}},"new")).messages}catch(e){return Se(ae("Failed to jump to the first unread message"),"error"),void Te(s.state.messagePagination.hasPrev,s.state.messages)}const i=r.find((e=>e.created_at));if(!i)return Se(ae("Failed to jump to the first unread message"),"error"),void Te(s.state.messagePagination.hasPrev,s.state.messages);if(t<new Date(i.created_at).getTime())n=i.id;else{const e=R(me.last_read,r);a=e.target?.id}Te(s.state.messagePagination.hasPrev,s.state.messages)}}if(n||a){if(!r){fe({loadingMore:!0,type:"setLoadingMore"});try{const t=n??a;await s.state.loadMessageIntoState(t,void 0,e);const r=s.state.messages.findIndex((e=>e.id===t));Te(s.state.messagePagination.hasPrev,s.state.messages),n=n??s.state.messages[r+1]?.id}catch(e){return Se(ae("Failed to jump to the first unread message"),"error"),void Te(s.state.messagePagination.hasPrev,s.state.messages)}}n?(me.first_unread_message_id||ge({...me,first_unread_message_id:n,last_read_message_id:a}),fe({hasMoreNewer:s.state.messagePagination.hasNext,highlightedMessageId:n,type:"jumpToMessageFinished"}),ke.current&&clearTimeout(ke.current),ke.current=setTimeout((()=>{ke.current=null,fe({type:"clearHighlightedMessage"})}),t)):Se(ae("Failed to jump to the first unread message"),"error")}else Se(ae("Failed to jump to the first unread message"),"error")}),[Se,s,Te,ae,me]),Ae=(0,n.useCallback)((async e=>{if(!e?.id)throw new Error("Cannot delete a message - missing message ID.");let t;if(u)t=await u(e);else{t=(await Y.deleteMessage(e.id)).message}return t}),[Y,u]),Oe=e=>{s.state.addMessageSorted(e,!0),fe({channel:s,parentId:pe.thread&&e.parent_id,type:"copyMessagesFromChannel"})},De=async(e,t,a)=>{const{attachments:n,id:r,mentioned_users:i=[],parent_id:o,text:c}=e,l=(d=i,null!=d[0]?.id?i.map((({id:e})=>e)):i);var d;const u={attachments:n,id:r,mentioned_users:l,parent_id:o,quoted_message_id:o===de?.parent_id?de?.id:void 0,text:c,...t};try{let e,t;e=y?await y(s,u,a):await s.sendMessage(u,a);for(let e=s.state.messages.length-1;e>=0;e--){const a=s.state.messages[e];if(a.id&&a.id===u.id){t=a;break}}const n=new Date(e?.message?.updated_at||0).getTime(),r=n>(t?.updated_at?.getTime()||0);e?.message&&(r||"sending"===t?.status)&&Oe({...e.message,status:"received"}),de&&o===de?.parent_id&&ue(void 0)}catch(t){const a=JSON.stringify(t),n=a?JSON.parse(a):{};4===n.code&&t instanceof Error&&t.message.includes("already exists")?Oe({...e,status:"received"}):(Oe({...e,error:n,errorStatusCode:n.status||void 0,status:"failed"}),re?.upsertReplyLocally({message:{...e,error:n,errorStatusCode:n.status||void 0,status:"failed"}}))}},He=async({attachments:e=[],mentioned_users:t=[],parent:a,text:n=""},r,i)=>{s.state.filterErrorMessages();const o={attachments:e,created_at:new Date,html:n,id:r?.id??`${Y.userID}-${(0,d.x0)()}`,mentioned_users:t,parent_id:a?.id,reactions:[],status:"sending",text:n,type:"regular",user:Y.user};re?.upsertReplyLocally({message:o}),Oe(o),await De(o,r,i)},je=async e=>{Oe({...e,errorStatusCode:void 0,status:"sending"}),e.attachments&&(e.attachments=e.attachments.filter((e=>!e.og_scrape_url))),await De(e)},Fe=e=>{s.state.removeMessage(e),fe({channel:s,parentId:pe.thread&&e.parent_id,type:"copyMessagesFromChannel"})},$e=(e,t)=>{t?.preventDefault(),ue((t=>t?.parent_id!==e?.parent_id?void 0:t)),fe({channel:s,message:e,type:"openThread"})},Be=e=>{e?.preventDefault(),fe({type:"closeThread"})},Ue=(0,n.useCallback)(r()(((e,t)=>{fe({threadHasMore:e,threadMessages:t,type:"loadMoreThreadFinished"})}),2e3,{leading:!0,trailing:!0}),[]),Ve=async(e=T.ZN)=>{if(pe.threadLoadingMore||!pe.thread||!pe.threadHasMore)return;fe({type:"startLoadingThread"});const t=pe.thread.id;if(!t)return fe({type:"closeThread"});const a=s.state.threads[t]||[],n=a[0]?.id;try{const a=await s.getReplies(t,{id_lt:n,limit:e}),r=(0,x.Th)(a.messages.length,e),i=s.state.threads[t]||[];Ue(r,i)}catch(e){Ue(!1,a)}},ze=((e,t)=>(0,n.useCallback)(((a,n)=>{if(!e&&!t||!(a.target instanceof HTMLElement))return;const s=a.target.innerHTML.replace("*","");if("@"===s[0]){const r=s.replace("@",""),i=n?.find((({id:e,name:t})=>t===r||e===r));e&&"function"==typeof e&&"mouseover"===a.type&&e(a,i),t&&"click"===a.type&&"function"==typeof t&&t(a,i)}}),[t,e]))(G,q),Ze=(e=>{const{channel:t,client:a}=(0,p.mx)("useEditMessageHandler");return(n,s)=>e&&t?Promise.resolve(e(t.cid,n,s)):a.updateMessage(n,void 0,s)})(E),{typing:We,...qe}=pe,Ge=(e=>{const{acceptedFiles:t,channel:a,channelCapabilitiesArray:s=[],channelConfig:r,debounceURLEnrichmentMs:i,dragAndDropWindow:o,enrichURLForPreview:c,giphyVersion:l,error:d,findURLFn:u,hasMore:m,hasMoreNewer:g,imageAttachmentSizeHandler:p,suppressAutoscroll:f,highlightedMessageId:_,loading:v,loadingMore:y,maxNumberOfFiles:E,members:w,messages:b=[],multipleUploads:M,mutes:C,notifications:N,onLinkPreviewDismissed:S,pinnedMessages:T,quotedMessage:x,read:P={},shouldGenerateVideoThumbnail:k,skipMessageDataMemoization:L,thread:R,threadHasMore:I,threadLoadingMore:A,threadMessages:O=[],channelUnreadUiState:D,videoAttachmentSizeHandler:H,watcherCount:j,watcher_count:F,watchers:$}=e,B=a.cid,U=a.initialized&&a.lastRead()?.getTime(),V=Object.keys(w||[]).length,z=N.length,Z=Object.values(P),W=Z.length,q=Z.map((({last_read:e})=>e.toISOString())).join(),G=O?.length,Q={};s.forEach((e=>{Q[e]=!0}));const J=L?b:b.map((({deleted_at:e,latest_reactions:t,pinned:a,reply_count:n,status:s,updated_at:r,user:i})=>`${e}${t?t.map((({type:e})=>e)).join():""}${a}${n}${s}${r&&((0,h.MD)(r)||(0,h.J_)(r))?r.toISOString():r||""}${i?.updated_at}`)).join(),K=O.map((({deleted_at:e,latest_reactions:t,pinned:a,status:n,updated_at:s,user:r})=>`${e}${t?t.map((({type:e})=>e)).join():""}${a}${n}${s&&((0,h.MD)(s)||(0,h.J_)(s))?s.toISOString():s||""}${r?.updated_at}`)).join();return(0,n.useMemo)((()=>({acceptedFiles:t,channel:a,channelCapabilities:Q,channelConfig:r,channelUnreadUiState:D,debounceURLEnrichmentMs:i,dragAndDropWindow:o,enrichURLForPreview:c,error:d,findURLFn:u,giphyVersion:l,hasMore:m,hasMoreNewer:g,highlightedMessageId:_,imageAttachmentSizeHandler:p,loading:v,loadingMore:y,maxNumberOfFiles:E,members:w,messages:b,multipleUploads:M,mutes:C,notifications:N,onLinkPreviewDismissed:S,pinnedMessages:T,quotedMessage:x,read:P,shouldGenerateVideoThumbnail:k,suppressAutoscroll:f,thread:R,threadHasMore:I,threadLoadingMore:A,threadMessages:O,videoAttachmentSizeHandler:H,watcher_count:F,watcherCount:j,watchers:$})),[a.data?.name,B,D,i,c,d,u,m,g,_,U,v,y,V,J,K,z,S,x,W,q,k,L,f,R,I,A,G,j])})({...qe,acceptedFiles:t,channel:s,channelCapabilitiesArray:we,channelConfig:ie,channelUnreadUiState:me,debounceURLEnrichmentMs:O?.debounceURLEnrichmentMs,dragAndDropWindow:A,enrichURLForPreview:e.enrichURLForPreview,findURLFn:O?.findURLFn,giphyVersion:e.giphyVersion||"fixed_height",imageAttachmentSizeHandler:e.imageAttachmentSizeHandler||D,maxNumberOfFiles:U,multipleUploads:z,mutes:te,notifications:ce,onLinkPreviewDismissed:O?.onLinkPreviewDismissed,quotedMessage:de,shouldGenerateVideoThumbnail:e.shouldGenerateVideoThumbnail||!0,videoAttachmentSizeHandler:e.videoAttachmentSizeHandler||H,watcher_count:pe.watcherCount}),Qe=(0,n.useMemo)((()=>({addNotification:Se,closeThread:Be,deleteMessage:Ae,dispatch:fe,editMessage:Ze,jumpToFirstUnreadMessage:Ie,jumpToLatestMessage:Re,jumpToMessage:Le,loadMore:xe,loadMoreNewer:Pe,loadMoreThread:Ve,markRead:Ce,onMentionsClick:ze,onMentionsHover:ze,openThread:$e,removeMessage:Fe,retrySendMessage:je,sendMessage:He,setChannelUnreadUiState:Me,setQuotedMessage:ue,skipMessageDataMemoization:J,updateMessage:Oe})),[s.cid,Ae,O?.findURLFn,O?.onLinkPreviewDismissed,xe,Pe,Ce,de,Ie,Le,Re,Me]),Je=(0,n.useMemo)((()=>({Attachment:e.Attachment,AttachmentPreviewList:e.AttachmentPreviewList,AttachmentSelector:e.AttachmentSelector,AttachmentSelectorInitiationButtonContents:e.AttachmentSelectorInitiationButtonContents,AudioRecorder:e.AudioRecorder,AutocompleteSuggestionItem:e.AutocompleteSuggestionItem,AutocompleteSuggestionList:e.AutocompleteSuggestionList,Avatar:e.Avatar,BaseImage:e.BaseImage,CooldownTimer:e.CooldownTimer,CustomMessageActionsList:e.CustomMessageActionsList,DateSeparator:e.DateSeparator,EditMessageInput:e.EditMessageInput,EmojiPicker:e.EmojiPicker,emojiSearchIndex:e.emojiSearchIndex,EmptyStateIndicator:e.EmptyStateIndicator,FileUploadIcon:e.FileUploadIcon,GiphyPreviewMessage:e.GiphyPreviewMessage,HeaderComponent:e.HeaderComponent,Input:e.Input,LinkPreviewList:e.LinkPreviewList,LoadingIndicator:e.LoadingIndicator,Message:e.Message,MessageActions:e.MessageActions,MessageBouncePrompt:e.MessageBouncePrompt,MessageDeleted:e.MessageDeleted,MessageListNotifications:e.MessageListNotifications,MessageNotification:e.MessageNotification,MessageOptions:e.MessageOptions,MessageRepliesCountButton:e.MessageRepliesCountButton,MessageStatus:e.MessageStatus,MessageSystem:e.MessageSystem,MessageTimestamp:e.MessageTimestamp,ModalGallery:e.ModalGallery,PinIndicator:e.PinIndicator,PollActions:e.PollActions,PollContent:e.PollContent,PollCreationDialog:e.PollCreationDialog,PollHeader:e.PollHeader,PollOptionSelector:e.PollOptionSelector,QuotedMessage:e.QuotedMessage,QuotedMessagePreview:e.QuotedMessagePreview,QuotedPoll:e.QuotedPoll,reactionOptions:e.reactionOptions,ReactionSelector:e.ReactionSelector,ReactionsList:e.ReactionsList,SendButton:e.SendButton,StartRecordingAudioButton:e.StartRecordingAudioButton,ThreadHead:e.ThreadHead,ThreadHeader:e.ThreadHeader,ThreadStart:e.ThreadStart,Timestamp:e.Timestamp,TriggerProvider:e.TriggerProvider,TypingIndicator:e.TypingIndicator,UnreadMessagesNotification:e.UnreadMessagesNotification,UnreadMessagesSeparator:e.UnreadMessagesSeparator,VirtualMessage:e.VirtualMessage})),[e.Attachment,e.AttachmentPreviewList,e.AttachmentSelector,e.AttachmentSelectorInitiationButtonContents,e.AudioRecorder,e.AutocompleteSuggestionItem,e.AutocompleteSuggestionList,e.Avatar,e.BaseImage,e.CooldownTimer,e.CustomMessageActionsList,e.DateSeparator,e.EditMessageInput,e.EmojiPicker,e.EmptyStateIndicator,e.FileUploadIcon,e.GiphyPreviewMessage,e.HeaderComponent,e.Input,e.LinkPreviewList,e.LoadingIndicator,e.Message,e.MessageActions,e.MessageBouncePrompt,e.MessageDeleted,e.MessageListNotifications,e.MessageNotification,e.MessageOptions,e.MessageRepliesCountButton,e.MessageStatus,e.MessageSystem,e.MessageTimestamp,e.ModalGallery,e.PinIndicator,e.PollActions,e.PollContent,e.PollCreationDialog,e.PollHeader,e.PollOptionSelector,e.QuotedMessage,e.QuotedMessagePreview,e.QuotedPoll,e.ReactionSelector,e.ReactionsList,e.SendButton,e.StartRecordingAudioButton,e.ThreadHead,e.ThreadHeader,e.ThreadStart,e.Timestamp,e.TriggerProvider,e.TypingIndicator,e.UnreadMessagesNotification,e.UnreadMessagesSeparator,e.VirtualMessage,e.emojiSearchIndex,e.reactionOptions]),Ke=(e=>{const{typing:t}=e,a=Object.keys(t||{}).join();return(0,n.useMemo)((()=>({typing:t})),[a])})({typing:We});return pe.error?n.createElement(W,null,n.createElement(F,{error:pe.error})):pe.loading?n.createElement(W,null,n.createElement($,null)):s.watch?n.createElement(W,{className:se},n.createElement(M.gZ,{value:Ge},n.createElement(C.PM,{value:Qe},n.createElement(N.y,{overrides:Je},n.createElement(S.ln,{value:Ke},n.createElement("div",{className:`${ne}`},A&&n.createElement(b.g,{...Q},c),!A&&n.createElement(n.Fragment,null,c))))))):n.createElement(W,null,n.createElement("div",null,ae("Channel Missing")))},G=n.memo((e=>{const{channel:t,EmptyPlaceholder:a=null,LoadingErrorIndicator:s,LoadingIndicator:r=w}=e,{channel:i,channelsQueryState:o}=(0,p.mx)("Channel"),c=t||i;return"reload"===o.queryInProgress&&r?n.createElement(W,null,n.createElement(r,null)):o.error&&s?n.createElement(W,null,n.createElement(s,{error:o.error})):c?.cid?n.createElement(q,{...e,channel:c,key:c.cid}):n.createElement(W,null,a)}))},771762:function(e,t,a){"use strict";a.d(t,{l:function(){return n}});const n="str-chat__channel"},910157:function(e,t,a){"use strict";a.d(t,{y:function(){return l}});var n=a(667294);const s=e=>{const t=Object.values(e.state.members);if(t.length<=2)return;const a=[];for(let e=0;e<t.length;e++){const{user:n}=t[e];if((n?.name||n?.image)&&(a.push({image:n.image,name:n.name}),4===a.length))break}return a},r=(e,t,a)=>{if(t.data?.[e])return t.data[e];const n=Object.values(t.state.members);if(2!==n.length)return;const s=n.find((e=>e.user?.id!==a?.id));return s?.user?.[e]},i=(e,t)=>r("name",e,t),o=(e,t)=>r("image",e,t);var c=a(983156);const l=e=>{const{channel:t,overrideImage:a,overrideTitle:r}=e,{client:l}=(0,c.mx)("useChannelPreviewInfo"),[d,u]=(0,n.useState)((()=>r||i(t,l.user))),[m,g]=(0,n.useState)((()=>a||o(t,l.user))),[h,p]=(0,n.useState)((()=>s(t)));return(0,n.useEffect)((()=>{if(r&&a)return;const e=()=>{r||u(i(t,l.user)),a||(g(o(t,l.user)),p(s(t)))};return e(),l.on("user.updated",e),()=>{l.off("user.updated",e)}}),[t,t.data,l,a,r]),{displayImage:a||m,displayTitle:r||d,groupChannelDisplayInfo:h}}},616274:function(e,t,a){"use strict";a.d(t,{e:function(){return l}});var n=a(667294),s=a(766722),r=a(396451),i=a(475801);var o=a(983156),c=a(21681);const l=e=>{const{children:t,client:a,customClasses:l,defaultLanguage:d,i18nInstance:u,initialNavOpen:m=!0,theme:g="messaging light",useImageFlagEmojisOnWindows:h=!1}=e,{channel:p,closeMobileNav:f,getAppSettings:_,latestMessageDatesByChannels:v,mutes:y,navOpen:E,openMobileNav:w,setActiveChannel:b,translators:M}=(({client:e,defaultLanguage:t="en",i18nInstance:a,initialNavOpen:o})=>{const[c,l]=(0,n.useState)({t:e=>e,tDateTimeParser:s.u9,userLanguage:"en"}),[d,u]=(0,n.useState)(),[m,g]=(0,n.useState)([]),[h,p]=(0,n.useState)(o),[f,_]=(0,n.useState)({}),v=e.user?.mutes||[],y=()=>p(!1),E=(0,n.useRef)(null);(0,n.useEffect)((()=>{if(!e)return;const t=e.getUserAgent();return t.includes("stream-chat-react")||e.setUserAgent(`stream-chat-react-${i.i}-${t}`),e.threads.registerSubscriptions(),e.polls.registerSubscriptions(),()=>{e.threads.unregisterSubscriptions(),e.polls.unregisterSubscriptions()}}),[e]),(0,n.useEffect)((()=>{g(v);const t=e=>{g(e.me?.mutes||[])};return e.on("notification.mutes_updated",t),()=>e.off("notification.mutes_updated",t)}),[v?.length]),(0,n.useEffect)((()=>{let n=e.user?.language;if(!n){const e=window.navigator.language.slice(0,2);n=(0,s.Eb)(e)?e:t}const i=a||new r.V({language:n});i.registerSetLanguageCallback((e=>l((t=>({...t,t:e}))))),i.getTranslators().then((e=>{l({...e,userLanguage:n||t})}))}),[a]);const w=(0,n.useCallback)((async(e,t={},a)=>{a&&a.preventDefault&&a.preventDefault(),e&&Object.keys(t).length&&await e.query({watch:!0,watchers:t}),u(e),y()}),[]);return(0,n.useEffect)((()=>{_({})}),[e.user?.id]),{channel:d,closeMobileNav:y,getAppSettings:()=>(E.current||(E.current=e.getAppSettings()),E.current),latestMessageDatesByChannels:f,mutes:m,navOpen:h,openMobileNav:()=>setTimeout((()=>p(!0)),100),setActiveChannel:w,translators:c}})({client:a,defaultLanguage:d,i18nInstance:u,initialNavOpen:m}),C=(e=>{const{channel:t,channelsQueryState:a,client:s,closeMobileNav:r,customClasses:i,getAppSettings:o,latestMessageDatesByChannels:c,mutes:l,navOpen:d,openMobileNav:u,setActiveChannel:m,theme:g,useImageFlagEmojisOnWindows:h}=e,p=t?.cid,f=a.error,_=a.queryInProgress,v=`${s.clientID}${Object.keys(s.activeChannels).length}${Object.keys(s.listeners).length}${s.mutedChannels.length}\n  ${s.user?.id}`,y=l.length;return(0,n.useMemo)((()=>({channel:t,channelsQueryState:a,client:s,closeMobileNav:r,customClasses:i,getAppSettings:o,latestMessageDatesByChannels:c,mutes:l,navOpen:d,openMobileNav:u,setActiveChannel:m,theme:g,useImageFlagEmojisOnWindows:h})),[p,f,_,v,o,y,d])})({channel:p,channelsQueryState:(()=>{const[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)("uninitialized");return{error:e,queryInProgress:a,setError:t,setQueryInProgress:s}})(),client:a,closeMobileNav:f,customClasses:l,getAppSettings:_,latestMessageDatesByChannels:v,mutes:y,navOpen:E,openMobileNav:w,setActiveChannel:b,theme:g,useImageFlagEmojisOnWindows:h});return M.t?n.createElement(o.aM,{value:C},n.createElement(c.$j,{value:M},t)):null}},549867:function(e,t,a){"use strict";a.d(t,{T:function(){return l}});var n=a(667294),s=a(610602),r=a(944498),i=a(321707),o=a(21681),c=a(540239);const l=n.memo((e=>{const{AutocompleteSuggestionItem:t,AutocompleteSuggestionList:a}=(0,c.yM)("ChatAutoComplete"),{t:l}=(0,o.Ht)("ChatAutoComplete"),d=(0,i.Nc)("ChatAutoComplete"),{cooldownRemaining:u,disabled:m,emojiSearchIndex:g,textareaRef:h}=d,p=e.placeholder||l("Type your message"),f=e.wordReplace?t=>e.wordReplace?.(t,g):async e=>{const t=(await(g?.search(e))||[]).filter(Boolean).slice(0,10).find((({emoticons:t})=>!!t?.includes(e)));if(!t)return null;const[a]=t.skins??[];return t.native??a.native},_=(0,n.useCallback)((e=>{h&&(h.current=e)}),[h]);return n.createElement(s.K,{additionalTextareaProps:d.additionalTextareaProps,"aria-label":u?l("Slow Mode ON"):p,className:"str-chat__textarea__textarea str-chat__message-textarea",closeCommandsList:d.closeCommandsList,closeMentionsList:d.closeMentionsList,containerClassName:"str-chat__textarea str-chat__message-textarea-react-host",disabled:m||!!u,disableMentions:d.disableMentions,grow:d.grow,handleSubmit:e.handleSubmit||d.handleSubmit,innerRef:_,loadingComponent:r.T,maxRows:d.maxRows,minChar:0,minRows:d.minRows,onBlur:e.onBlur,onChange:e.onChange||d.handleChange,onFocus:e.onFocus,onPaste:e.onPaste||d.onPaste,placeholder:u?l("Slow Mode ON"):p,replaceWord:f,rows:e.rows||1,shouldSubmit:d.shouldSubmit,showCommandsList:d.showCommandsList,showMentionsList:d.showMentionsList,SuggestionItem:t,SuggestionList:a,trigger:d.autocompleteTriggers||{},value:e.value||d.text})}))},516164:function(e,t,a){"use strict";a.d(t,{d:function(){return s}});var n=a(667294);const s=n.memo((e=>{const{entity:t}=e;return n.createElement("div",{className:"str-chat__slash-command"},n.createElement("span",{className:"str-chat__slash-command-header"},n.createElement("strong",null,t.name)," ",t.args),n.createElement("br",null),n.createElement("span",{className:"str-chat__slash-command-description"},t.description))}))},696660:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(667294),s=a(21681),r=a(766722);const i=n.memo((e=>{const{calendar:t,date:a,formatDate:i,position:o="right",unread:c,...l}=e,{t:d,tDateTimeParser:u}=(0,s.Ht)("DateSeparator"),m=(0,r.fh)({calendar:t,...l,formatDate:i,messageCreatedAt:a,t:d,tDateTimeParser:u,timestampTranslationKey:"timestamp/DateSeparator"});return n.createElement("div",{className:"str-chat__date-separator","data-testid":"date-separator"},("right"===o||"center"===o)&&n.createElement("hr",{className:"str-chat__date-separator-line"}),n.createElement("div",{className:"str-chat__date-separator-date"},c?`${d("New")} - ${m}`:m),("left"===o||"center"===o)&&n.createElement("hr",{className:"str-chat__date-separator-line"}))}))},869725:function(e,t,a){"use strict";a.d(t,{l:function(){return l}});var n=a(770149),s=a(667294),r=a(337829),i=a(237894),o=a(960329),c=a(219025);const l=({children:e,className:t,focus:a=!0,id:l,placement:d="auto",referenceElement:u=null,trapFocus:m,...g})=>{const h=(0,c.Rh)({id:l}),p=(0,c.wB)(l),{attributes:f,setPopperElement:_,styles:v}=function({open:e,placement:t,referenceElement:a}){const[n,r]=(0,s.useState)(null),{attributes:o,styles:c,update:l}=(0,i.D)(a,n,{modifiers:[{name:"eventListeners",options:{resize:!1,scroll:!1}}],placement:t});return(0,s.useEffect)((()=>{e&&n&&l?.()}),[e,n,l]),n&&!e&&r(null),{attributes:o,setPopperElement:r,styles:c}}({open:p,placement:d,referenceElement:u});return(0,s.useEffect)((()=>{if(!p)return;const e=e=>{"Escape"===e.key&&h?.close()};return document.addEventListener("keyup",e),()=>{document.removeEventListener("keyup",e)}}),[h,p]),p?s.createElement(o.A,{dialogId:l},s.createElement(r.MT,{autoFocus:a,contain:m,restoreFocus:!0},s.createElement("div",{...g,...f.popper,className:(0,n.Z)("str-chat__dialog-contents",t),"data-testid":"str-chat__dialog-contents",ref:_,style:v.popper,tabIndex:0},e))):null}},397787:function(e,t,a){"use strict";a.d(t,{r:function(){return s}});var n=a(423274);class s{constructor({id:e}={}){this.state=new n.gj({dialogsById:{}}),this.id=e??(new Date).getTime().toString()}get openDialogCount(){return Object.values(this.state.getLatestValue().dialogsById).reduce(((e,t)=>t.isOpen?e+1:e),0)}getOrCreate({id:e}){let t=this.state.getLatestValue().dialogsById[e];return t||(t={close:()=>{this.close(e)},id:e,isOpen:!1,open:()=>{this.open({id:e})},remove:()=>{this.remove(e)},toggle:(t=!1)=>{this.toggle({id:e},t)}},this.state.next((a=>({...a,dialogsById:{...a.dialogsById,[e]:t}})))),t}open(e,t){const a=this.getOrCreate(e);a.isOpen||(t&&this.closeAll(),this.state.next((e=>({...e,dialogsById:{...e.dialogsById,[a.id]:{...a,isOpen:!0}}}))))}close(e){const t=this.state.getLatestValue().dialogsById[e];t?.isOpen&&this.state.next((e=>({...e,dialogsById:{...e.dialogsById,[t.id]:{...t,isOpen:!1}}})))}closeAll(){Object.values(this.state.getLatestValue().dialogsById).forEach((e=>e.close()))}toggle(e,t=!1){this.state.getLatestValue().dialogsById[e.id]?.isOpen?this.close(e.id):this.open(e,t)}remove(e){this.state.getLatestValue().dialogsById[e]&&this.state.next((t=>{const a={...t.dialogsById};return delete a[e],{...t,dialogsById:a}}))}}},520826:function(e,t,a){"use strict";a.d(t,{K:function(){return r}});var n=a(667294),s=a(770149);const r=({children:e,className:t,...a})=>n.createElement("button",{className:(0,s.Z)("str-chat__dialog-menu__button",t),...a},n.createElement("div",{className:"str-chat__dialog-menu__button-icon"}),n.createElement("div",{className:"str-chat__dialog-menu__button-text"},e))},960329:function(e,t,a){"use strict";a.d(t,{A:function(){return c},t:function(){return o}});var n=a(667294),s=a(219025),r=a(803897),i=a(193283);const o=()=>{const{dialogManager:e}=(0,i._)(),t=(0,s.xu)();return n.createElement("div",{className:"str-chat__dialog-overlay","data-str-chat__portal-id":e.id,"data-testid":"str-chat__dialog-overlay",onClick:()=>e.closeAll(),style:{"--str-chat__dialog-overlay-height":t>0?"100%":"0"}})},c=({children:e,dialogId:t})=>{const{dialogManager:a}=(0,i._)(),o=(0,s.wB)(t),c=(0,n.useCallback)((()=>document.querySelector(`div[data-str-chat__portal-id="${a.id}"]`)),[a.id]);return n.createElement(r.h,{getPortalDestination:c,isOpen:o},e)}},484833:function(e,t,a){"use strict";a.d(t,{D:function(){return o}});var n=a(667294),s=a(770149),r=a(569203),i=a(21681);const o=({className:e,close:t,fields:a,onSubmit:o,shouldDisableSubmitButton:c,title:l})=>{const{t:d}=(0,i.Ht)(),[u,m]=(0,n.useState)({}),[g,h]=(0,n.useState)((()=>{let e={};for(const[t,n]of Object.entries(a))e={...e,[t]:n.props.value};return e})),p=(0,n.useCallback)((e=>{const t=e.target.id,n=a[t];if(!n)return;const s=n.validator?.(e.target.value);m(s?e=>({[t]:s,...e}):e=>(delete e[t],e)),h((a=>({...a,[t]:e.target.value}))),n.props.onChange&&("input"===n.element||"textarea"===n.element)&&n.props.onChange(e)}),[a]);return n.createElement("div",{className:(0,s.Z)("str-chat__dialog str-chat__dialog--form",e)},n.createElement("div",{className:"str-chat__dialog__body"},l&&n.createElement("div",{className:"str-chat__dialog__title"},l),n.createElement("form",{autoComplete:"off"},Object.entries(a).map((([e,t])=>n.createElement("div",{className:"str-chat__dialog__field",key:`dialog-field-${e}`},t.label&&n.createElement("label",{className:(0,s.Z)(`str-chat__dialog__title str-chat__dialog__title--${e}`),htmlFor:e},t.label),n.createElement(t.element,{id:e,...t.props,onChange:p,value:g[e]}),n.createElement(r.c,{text:u[e]?.message})))))),n.createElement("div",{className:"str-chat__dialog__controls"},n.createElement("button",{className:"str-chat__dialog__controls-button str-chat__dialog__controls-button--cancel",onClick:t},d("Cancel")),n.createElement("button",{className:"str-chat__dialog__controls-button str-chat__dialog__controls-button--submit",disabled:Object.keys(u).length>0||c?.(g),onClick:async()=>{if(!Object.keys(g).length)return;const e={};for(const[t,n]of Object.entries(g)){const s=a[t].validator?.(n);s&&(e[t]=s)}Object.keys(e).length?m(e):(await o(g),t())},type:"submit"},d("Send"))))}},239256:function(e,t,a){"use strict";a.d(t,{m:function(){return r}});var n=a(667294),s=a(770149);const r=({actions:e,className:t,prompt:a,title:r})=>n.createElement("div",{className:(0,s.Z)("str-chat__dialog str-chat__dialog--prompt",t)},n.createElement("div",{className:"str-chat__dialog__body"},r&&n.createElement("div",{className:"str-chat__dialog__title"},r),n.createElement("div",{className:"str-chat__dialog__prompt"},a)),n.createElement("div",{className:"str-chat__dialog__controls"},e.map((({className:e,...t},a)=>n.createElement("button",{className:(0,s.Z)("str-chat__dialog__controls-button",e),key:`prompt-dialog__controls-button--${a}`,...t})))))},219025:function(e,t,a){"use strict";a.d(t,{Rh:function(){return i},wB:function(){return o},xu:function(){return l}});var n=a(667294),s=a(193283),r=a(159852);const i=({id:e})=>{const{dialogManager:t}=(0,s._)();return(0,n.useEffect)((()=>()=>{t.remove(e)}),[t,e]),t.getOrCreate({id:e})},o=e=>{const{dialogManager:t}=(0,s._)(),a=(0,n.useCallback)((({dialogsById:t})=>({isOpen:!!t[e]?.isOpen})),[e]);return(0,r.B)(t.state,a).isOpen},c=e=>({openedDialogCount:Object.values(e.dialogsById).reduce(((e,t)=>t.isOpen?e+1:e),0)}),l=()=>{const{dialogManager:e}=(0,s._)();return(0,r.B)(e.state,c).openedDialogCount}},99314:function(e,t,a){"use strict";a.d(t,{l:function(){return r}});var n=a(667294),s=a(770149);const r=({children:e,className:t,draggable:a,onSetNewOrder:r})=>{const[i,o]=(0,n.useState)([]),[c,l]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[m,g]=(0,n.useState)(null),h=null===c||null===d?void 0:c<=d?"down":"up",p=n.Children.toArray(e);return(0,n.useEffect)((()=>{o(n.Children.map(e,((e,t)=>t))||[])}),[e]),(0,n.useEffect)((()=>{if(!m)return;const e=e=>{const t=e.target.closest(".str-chat__drag-and-drop-container__item");if(e.dataTransfer&&(e.dataTransfer.effectAllowed="move"),t instanceof HTMLElement){const a=Array.from(t.parentElement?.children||[]).indexOf(t);l(a),e.dataTransfer?.setData("text/plain",a.toString()),t.style.opacity="0.3"}},t=e=>{e.preventDefault();const t=e.target.closest(".str-chat__drag-and-drop-container__item");if(t instanceof HTMLElement){const e=Array.from(t.parentElement?.children||[]).indexOf(t);u(e)}},a=()=>{u(null)},n=e=>{e.preventDefault();const t=parseInt(e.dataTransfer?.getData("text/plain")||"-1",10),a=e.target.closest(".str-chat__drag-and-drop-container__item");if(a instanceof HTMLElement){const e=Array.from(a.parentElement?.children||[]).indexOf(a);-1!==t&&t!==e&&o((a=>{const n=[...a],[s]=n.splice(t,1);return n.splice(e,0,s),r?.(n),n}))}l(null),u(null)},s=e=>{const t=e.target;t instanceof HTMLElement&&(t.style.opacity=""),l(null),u(null)};return m.addEventListener("dragstart",e),m.addEventListener("dragover",t),m.addEventListener("dragleave",a),m.addEventListener("drop",n),m.addEventListener("dragend",s),()=>{m.removeEventListener("dragstart",e),m.removeEventListener("dragover",t),m.removeEventListener("dragleave",a),m.removeEventListener("drop",n),m.removeEventListener("dragend",s)}}),[m,r]),n.createElement("div",{className:(0,s.Z)("str-chat__drag-and-drop-container",t),ref:g},i.map(((e,t)=>{const r=p[e];return n.createElement("div",{className:(0,s.Z)("str-chat__drag-and-drop-container__item",{"str-chat__drag-and-drop-container__item--dragged-over-from-bottom":"up"===h&&d===t,"str-chat__drag-and-drop-container__item--dragged-over-from-top":"down"===h&&d===t}),draggable:a,key:n.isValidElement(r)?r.key:`draggable-item-${e}`},r)})))}},648371:function(e,t,a){"use strict";a.d(t,{t:function(){return s}});var n=a(667294);const s=n.memo((e=>{const{entity:t}=e,a=Object.keys(t).length,s=t?.itemNameParts;return n.createElement("div",{className:"str-chat__emoji-item"},n.createElement("span",{className:"str-chat__emoji-item--entity"},t.native),n.createElement("span",{className:"str-chat__emoji-item--name"},a?a&&s.parts.map(((e,t)=>e.toLowerCase()===s.match.toLowerCase()?n.createElement("span",{className:"str-chat__emoji-item--highlight",key:`part-${t}`},e):n.createElement("span",{className:"str-chat__emoji-item--part",key:`part-${t}`},e))):null))}))},728237:function(e,t,a){"use strict";a.d(t,{D:function(){return i}});var n=a(667294),s=a(21681);const r=()=>n.createElement("svg",{"data-testid":"chat-bubble",fill:"none",height:"96",viewBox:"0 0 136 136",width:"96",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M106 24.5H30C24.775 24.5 20.5 28.775 20.5 34V119.5L39.5 100.5H106C111.225 100.5 115.5 96.225 115.5 91V34C115.5 28.775 111.225 24.5 106 24.5ZM106 91H39.5L30 100.5V34H106V91Z",fill:"#B4B7BB"})),i=n.memo((e=>{const{listType:t}=e,{t:a}=(0,s.Ht)("EmptyStateIndicator");if("thread"===t)return null;if("channel"===t){const e=a("You have no channels currently");return n.createElement(n.Fragment,null,n.createElement("div",{className:"str-chat__channel-list-empty"},n.createElement(r,null),n.createElement("p",{role:"listitem"},e)))}if("message"===t){const e=a("No chats here yet");return n.createElement("div",{className:"str-chat__empty-channel"},n.createElement(r,null),n.createElement("p",{className:"str-chat__empty-channel-text",role:"listitem"},e))}return n.createElement("p",null,"No items exist")}))},453207:function(e,t,a){"use strict";a.d(t,{B:function(){return o}});var n=a(667294),s=a(613943),r=a(21681),i=a(766722);const o=n.memo((e=>{const{calendar:t,calendarFormats:a,format:o,Avatar:c=s.q,message:l}=e,{t:d,tDateTimeParser:u}=(0,r.Ht)("EventComponent"),{created_at:m="",event:g,text:h,type:p}=l,f={messageCreatedAt:m.toString(),tDateTimeParser:u};if("system"===p)return n.createElement("div",{className:"str-chat__message--system","data-testid":"message-system"},n.createElement("div",{className:"str-chat__message--system__text"},n.createElement("div",{className:"str-chat__message--system__line"}),n.createElement("p",null,h),n.createElement("div",{className:"str-chat__message--system__line"})),n.createElement("div",{className:"str-chat__message--system__date"},n.createElement("strong",null,(0,i.fh)({...f,calendar:t,calendarFormats:a,format:o,t:d,timestampTranslationKey:"timestamp/SystemMessage"}))));if("member.removed"===g?.type||"member.added"===g?.type){const e=g.user?.name||g.user?.id,t=`${e} ${"member.added"===g.type?"has joined the chat":"was removed from the chat"}`;return n.createElement("div",{className:"str-chat__event-component__channel-event"},n.createElement(c,{image:g.user?.image,name:e,user:g.user}),n.createElement("div",{className:"str-chat__event-component__channel-event__content"},n.createElement("em",{className:"str-chat__event-component__channel-event__sentence"},t),n.createElement("div",{className:"str-chat__event-component__channel-event__date"},(0,i.fh)({...f,format:"LT"}))))}return null}))},569203:function(e,t,a){"use strict";a.d(t,{c:function(){return r}});var n=a(770149),s=a(667294);const r=({className:e,text:t,...a})=>s.createElement("div",{...a,className:(0,n.Z)("str-chat__form-field-error",e)},t)},166793:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var n=a(770149),s=a(667294);const r=({children:e,...t})=>{const a=(0,s.useRef)(null);return s.createElement("div",{className:"str-chat__form__field str-chat__form__switch-field"},s.createElement("label",null,s.createElement("div",{className:"str-chat__form__field str-chat__form__switch-field-content"},e),s.createElement("input",{type:"checkbox",...t,ref:a}),s.createElement("div",{className:(0,n.Z)("str-chat__form__switch-field__switch",{"str-chat__form__switch-field__switch--on":t.checked}),onKeyUp:e=>{[" ","Enter"].includes(e.key)&&a.current&&(e.preventDefault(),a.current.click())},tabIndex:0},s.createElement("div",{className:"str-chat__form__switch-field__switch-handle"}))))},i=({labelText:e,...t})=>s.createElement(r,{...t},s.createElement("div",{className:"str-chat__form__field str-chat__form__switch-field__text"},e))},606892:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(667294),s=a(770149),r=a(998250);const i=(0,n.forwardRef)((function({...e},t){const{className:a,onError:i}=e,[o,c]=(0,n.useState)(!1);return(0,n.useEffect)((()=>()=>{c(!1)}),[e.src]),n.createElement(n.Fragment,null,n.createElement("img",{"data-testid":"str-chat__base-image",...e,className:(0,s.Z)(a,"str-chat__base-image",{"str-chat__base-image--load-failed":o}),onError:e=>{c(!0),i?.(e)},ref:t}),o&&n.createElement(r.o,{assetUrl:e.src}))}))},219530:function(e,t,a){"use strict";a.d(t,{r:function(){return u}});var n=a(667294),s=a(117967),r=a(770149),i=a(606892),o=a(827666),c=a(249868),l=a(540239),d=a(21681);const u=n.memo((e=>{const{images:t,innerRefs:a}=e,[u,m]=(0,n.useState)(0),[g,h]=(0,n.useState)(!1),{BaseImage:p=i.Z,ModalGallery:f=c.R}=(0,l.yM)("Gallery"),{t:_}=(0,d.Ht)("Gallery"),v=_("User uploaded content"),y=e=>{g?h(!1):(m(e),h(!0))},E=t.slice(0,4).map(((e,r)=>3===r&&t.length>4?n.createElement("button",{className:"str-chat__gallery-placeholder","data-testid":"gallery-image-last",key:`gallery-image-${r}`,onClick:()=>y(r),style:{backgroundImage:`url(${t[3].previewUrl||t[3].image_url||t[3].thumb_url})`,...e.style},...a?.current&&{ref:e=>a.current[r]=e}},n.createElement("p",null,_("{{ imageCount }} more",{imageCount:t.length-4}))):n.createElement("button",{className:"str-chat__gallery-image","data-testid":"gallery-image",key:`gallery-image-${r}`,onClick:()=>y(r)},n.createElement(p,{alt:e?.fallback||v,src:(0,s.Nm)(e.previewUrl||e.image_url||e.thumb_url),style:e.style,title:e?.fallback||v,...a?.current&&{ref:e=>a.current[r]=e}})))),w=(0,r.Z)("str-chat__gallery",{"str-chat__gallery--square":t.length>3,"str-chat__gallery-two-rows":t.length>2});return n.createElement("div",{className:w},E,n.createElement(o.u,{className:"str-chat__gallery-modal",onClose:()=>h((e=>!e)),open:g},n.createElement(f,{images:t,index:u})))}))},249868:function(e,t,a){"use strict";a.d(t,{R:function(){return d}});var n=a(667294),s=a(366982),r=a.n(s),i=a(606892),o=a(21681);const c=e=>{e.target.alt=""},l=({original:e,originalAlt:t})=>n.createElement(i.Z,{alt:t,className:"image-gallery-image",onError:c,src:e}),d=e=>{const{images:t,index:a}=e,{t:s}=(0,o.Ht)("ModalGallery"),i=(0,n.useMemo)((()=>t.map((e=>{const t=e.image_url||e.thumb_url||"";return{original:t,originalAlt:s("User uploaded content"),source:t}}))),[t]);return n.createElement(r(),{items:i,renderItem:l,showIndex:!0,showPlayButton:!1,showThumbnails:!1,startIndex:a})}},779883:function(e,t,a){"use strict";a.d(t,{v:function(){return o}});var n=a(667294),s=a(891677),r=a(345853);const i=e=>{e instanceof WheelEvent&&1===e.deltaY&&e.preventDefault()},o=e=>{const{children:t,element:a="div",hasMore:o,hasMoreNewer:c,hasNextPage:l,hasPreviousPage:d,head:u,initialLoad:m=!0,isLoading:g,listenToScroll:h,loader:p,loadMore:f,loadMoreNewer:_,loadNextPage:v,loadPreviousPage:y,threshold:E=r.su,useCapture:w=!1,...b}=e,M=v||_,C=y||f,N=l||c,S=d||o,T=(0,n.useRef)(),x=(0,n.useRef)(),P=(0,n.useRef)(),k=(0,n.useRef)();k.current=()=>{const e=T.current;if(!e||null===e.offsetParent)return;const t=e.parentElement,a=e.scrollHeight-t.scrollTop-t.clientHeight,n=t.scrollTop;h&&h(a,n,E),g||x.current===a&&P.current===n||(x.current=a,P.current=n,n<Number(E)&&"function"==typeof C&&S&&C(),a<Number(E)&&"function"==typeof M&&N&&M())},(0,n.useEffect)((()=>{(0,s.b)([[{hasMoreNewer:c},{hasNextPage:l}],[{loadMoreNewer:_},{loadNextPage:v}],[{hasMore:o},{hasPreviousPage:d}],[{loadMore:f},{loadPreviousPage:y}]],"InfiniteScroll")}),[]),(0,n.useEffect)((()=>{const e=T.current?.parentNode;if(!e)return;const t=()=>k.current?.();return e.addEventListener("scroll",t,w),e.addEventListener("resize",t,w),t(),()=>{e.removeEventListener("scroll",t,w),e.removeEventListener("resize",t,w)}}),[m,w]),(0,n.useEffect)((()=>{const e=T.current?.parentNode;return e&&e.addEventListener("wheel",i,{passive:!1}),()=>{e&&e.removeEventListener("wheel",i,w)}}),[w]);const L={...b,ref:e=>{T.current=e}},R=[p,t];return u&&R.unshift(u),n.createElement(a,L,R)}},152027:function(e,t,a){"use strict";a.d(t,{P:function(){return l}});var n=a(770149),s=a(691296),r=a.n(s),i=a(667294),o=a(345853);const c=e=>{e instanceof WheelEvent&&1===e.deltaY&&e.preventDefault()},l=e=>{const{children:t,listenToScroll:a,loadNextOnScrollToBottom:s,loadNextOnScrollToTop:l,threshold:d=o.su,useCapture:u=!1,className:m,...g}=e,h=(0,i.useRef)(null),p=(0,i.useRef)(null),f=(0,i.useMemo)((()=>r()((()=>{const e=h.current,t=p.current;if(!e||null===e.offsetParent||!t)return;const n=t.scrollHeight-e.scrollTop-e.clientHeight,r=e.scrollTop;a&&a(n,r,d),r<Number(d)&&l?.(),n<Number(d)&&s?.()}),500)),[a,s,l,d]);return(0,i.useEffect)((()=>{const e=h.current;if(e)return e.addEventListener("scroll",f,u),()=>{e.removeEventListener("scroll",f,u)}}),[f,u]),(0,i.useEffect)((()=>{const e=h.current;if(!e||"undefined"==typeof ResizeObserver||!f)return;const t=new ResizeObserver(f);return t.observe(e),()=>{t.disconnect()}}),[f]),(0,i.useEffect)((()=>{const e=h.current;return e&&e.addEventListener("wheel",c,{passive:!1}),()=>{e&&e.removeEventListener("wheel",c,u)}}),[u]),i.createElement("div",{...g,className:(0,n.Z)("str-chat__infinite-scroll-paginator",m),ref:h},i.createElement("div",{className:"str-chat__infinite-scroll-paginator__content",ref:p},t))}},350986:function(e,t,a){"use strict";a.d(t,{l:function(){return o}});var n=a(18618),s=a.n(n),r=a(667294),i=a(423274);const o=(e,t)=>{const a=(0,r.useMemo)((()=>new i.gj({hasNextPage:!0,items:[],latestPageItems:[],loading:!1})),[]),n=(0,r.useCallback)((async()=>{const{loading:t,next:n}=a.getLatestValue();if(null!==n&&!t){a.partialNext({loading:!0});try{const{items:t,next:r}=await e(n);a.next((e=>({...e,hasNextPage:!!r,items:s()(e.items.concat(t),"id"),latestPageItems:t,next:r||null})))}catch(e){a.partialNext({error:e})}a.partialNext({loading:!1})}}),[a,e]);return(0,r.useEffect)((()=>{const{items:e}=a.getLatestValue();t&&!e.length&&n()}),[a,t,n]),{cursorPaginatorState:a,loadMore:n}}},944498:function(e,t,a){"use strict";a.d(t,{T:function(){return s}});var n=a(667294);const s=n.memo((e=>{const{color:t="#006CFF",size:a=15}=e;return n.createElement("div",{className:"str-chat__loading-indicator","data-testid":"loading-indicator-wrapper",style:{height:a,width:a}},n.createElement("svg",{height:a,viewBox:"0 0 30 30",width:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("defs",null,n.createElement("linearGradient",{id:"a",x1:"50%",x2:"50%",y1:"0%",y2:"100%"},n.createElement("stop",{offset:"0%",stopColor:"#FFF",stopOpacity:"0"}),n.createElement("stop",{"data-testid":"loading-indicator-circle",offset:"100%",stopColor:t,stopOpacity:"1",style:{stopColor:t}}))),n.createElement("path",{d:"M2.518 23.321l1.664-1.11A12.988 12.988 0 0 0 15 28c7.18 0 13-5.82 13-13S22.18 2 15 2V0c8.284 0 15 6.716 15 15 0 8.284-6.716 15-15 15-5.206 0-9.792-2.652-12.482-6.679z",fill:"url(#a)",fillRule:"evenodd"})))}),((e,t)=>e.color===t.color&&e.size===t.size))},650342:function(e,t,a){"use strict";function n(e){return e.join(" ").trim()}a.d(t,{P:function(){return n}})},477628:function(e,t,a){"use strict";function n(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor===Object}function s(e={},t={}){Object.keys(t).forEach((a=>{void 0===e[a]?e[a]=t[a]:n(t[a])&&n(e[a])&&Object.keys(t[a]).length>0&&s(e[a],t[a])}))}a.d(t,{Jj:function(){return c},Me:function(){return i}});const r={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function i(){const e="undefined"!=typeof document?document:{};return s(e,r),e}const o={document:r,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(e){return"undefined"==typeof setTimeout?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){"undefined"!=typeof setTimeout&&clearTimeout(e)}};function c(){const e="undefined"!=typeof window?window:{};return s(e,o),e}}}]);
//# sourceMappingURL=vendors-3510cdec-39e42f088df7e673.bundle.js.map